(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    360198,       9140]
NotebookOptionsPosition[    339161,       8821]
NotebookOutlinePosition[    339705,       8840]
CellTagsIndexPosition[    339662,       8837]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fs", "=", "FullSimplify"}], ";", 
  RowBox[{"po", "=", "PowerExpand"}], ";", 
  RowBox[{"mx", "=", "MatrixForm"}], ";", 
  RowBox[{"ft", "=", "Flatten"}], ";", 
  RowBox[{"ex", "=", "Expand"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8640915084084463`*^9, 3.8640915248877363`*^9}, {
  3.8640924628623285`*^9, 3.8640924691498737`*^9}, {3.864522621615816*^9, 
  3.8645226787126937`*^9}, {3.864528681571737*^9, 3.8645286850203047`*^9}, {
  3.8645479339494767`*^9, 3.864547950478345*^9}, {3.8740355935922766`*^9, 
  3.874035593732619*^9}, {3.8818185696503353`*^9, 3.88181857651457*^9}},
 CellLabel->
  "In[497]:=",ExpressionUUID->"536ea6ac-b5fa-40e3-be49-c9b6c7a5ed33"],

Cell[CellGroupData[{

Cell["\<\
multiple infection types model and transmission phenotype landscape\
\>", "Subsection",
 CellChangeTimes->{{3.70358331490076*^9, 3.703583316962878*^9}, {
  3.864129970306693*^9, 3.8641299760118895`*^9}, {3.864130011237754*^9, 
  3.8641300177320013`*^9}},ExpressionUUID->"e6c306eb-91d2-48f1-96eb-\
7d19a49beeb7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "we", " ", "are", " ", "in", " ", "a", " ", "1", " ", "D", " ", "model", 
    " ", 
    RowBox[{"(", 
     RowBox[{
     "only", " ", "transmission", " ", "evolves", " ", "we", " ", "ignore", 
      " ", "virulence", " ", "evolution"}], ")"}]}], ",", " ", 
   RowBox[{
    RowBox[{"with", " ", "genotypic", " ", "size", " ", 
     RowBox[{"dynamics", ":", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["\[PartialD]", "t"], 
       RowBox[{
        SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "i"], 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", "\[Alpha]", ")"}], " ", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"this", " ", "means", " ", "a", " ", "malthusian", " ", 
    RowBox[{"fitness", ":", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["m", "i"], "[", "t", "]"}]}]}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"Log", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], "]"}]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "i"], 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], " ", "-", 
     RowBox[{"(", "\[Alpha]", ")"}]}]}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "The", " ", "total", " ", "infected", " ", "population", " ", "size", " ", 
    RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}], "=", 
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      SubscriptBox["K", "t"]], 
     RowBox[{
      RowBox[{
       SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], " ", "has", 
      " ", "dynamics", " ", "is", " ", "given", " ", 
      RowBox[{"by", " ", ":", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[PartialD]", "t"], 
        RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       OverscriptBox["\[Beta]", "_"], "[", "t", "]"}], 
      RowBox[{"S", "[", "t", "]"}], " ", 
      RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}], "-", 
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"where", " ", 
    OverscriptBox["\[Beta]", "_"]}], "\[Congruent]", 
   FractionBox[
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      SubscriptBox["K", "t"]], 
     RowBox[{
      SubscriptBox["\[Beta]", "i"], 
      RowBox[{
       SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]}], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      SubscriptBox["K", "t"]], 
     RowBox[{
      SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "The", " ", "uninfected", " ", "population", " ", "size", " ", "dynamics", 
    " ", "is", " ", "given", " ", 
    RowBox[{"by", " ", ":", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}]}], "=", 
   RowBox[{"b", "-", " ", 
    RowBox[{"d", " ", 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "-", 
    RowBox[{
     RowBox[{
      OverscriptBox["\[Beta]", "_"], "[", "t", "]"}], 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"The", " ", "quadratic", " ", "fitness", " ", "landscape", "  ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "as", " ", "a", " ", "function", " ", "of", " ", "breeding", " ", 
      "value", " ", 
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "i"]}], "\[Element]", " ", 
     RowBox[{
      SuperscriptBox["\[DoubleStruckCapitalR]", "n"], " ", "for", " ", "n", 
      " ", "dimensional", " ", "phenotype", " ", "in", " ", "lineage", " ", 
      "i"}]}], ")"}], " ", "is", " ", "defined", " ", "by", " ", "the", " ", 
   "transmission", " ", "rate"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["\[Beta]", "i"], "=", 
  RowBox[{
   RowBox[{"\[Beta]", "[", 
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "i"], "]"}], "=", 
   RowBox[{
    SubscriptBox["\[Beta]", "max"], "-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", "Vs"}]], 
     RowBox[{
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "i"], ".", 
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "i"]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mutations", " ", "affect", " ", "the", " ", "phenotype", " ", 
   StyleBox["g",
    FontWeight->"Bold"], " ", "by", " ", "an", " ", "isotropic", " ", 
   "gaussian", " ", "kernel", " ", 
   StyleBox["dg",
    FontWeight->"Bold"]}], "\[Distributed]", 
  RowBox[{"\[ScriptCapitalN]", 
   RowBox[{"(", 
    RowBox[{"0", ",", 
     RowBox[{"\[Lambda]", " ", 
      SubscriptBox[
       StyleBox["\[DoubleStruckCapitalI]",
        FontWeight->"Bold"], "n"]}]}], ")"}]}]}]}], "Text",
 CellChangeTimes->{{3.7035828241726923`*^9, 3.703583110498069*^9}, {
  3.7035861633606825`*^9, 3.703586196099555*^9}, {3.7039032204929647`*^9, 
  3.7039032500486546`*^9}, {3.8641294607733803`*^9, 3.8641294876013355`*^9}, {
  3.8641299925203013`*^9, 3.8641300259086614`*^9}, {3.864134283061204*^9, 
  3.8641343391656227`*^9}, {3.864135433558226*^9, 3.864135433913074*^9}, {
  3.8740356392202563`*^9, 3.8740356685446186`*^9}, {3.878631167932415*^9, 
  3.878631168348341*^9}, {3.878631213541716*^9, 3.878631213543805*^9}, {
  3.878701460562724*^9, 3.878701482346137*^9}, {3.8787024179054956`*^9, 
  3.87870241988806*^9}, {3.878702721063449*^9, 3.878702721856064*^9}, {
  3.8787056795192337`*^9, 
  3.8787056824159603`*^9}},ExpressionUUID->"6f97f211-e51e-4d6a-8212-\
2770fc533b87"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Building the PDE for density MGF", "Subsection",
 CellChangeTimes->{{3.8740357348533583`*^9, 
  3.8740357439466257`*^9}},ExpressionUUID->"f49fa25a-a2f4-409e-b6b0-\
e77ea8b4f653"],

Cell[CellGroupData[{

Cell["selection and demography", "Subsubsection",
 CellChangeTimes->{{3.8740367456632853`*^9, 
  3.874036749104305*^9}},ExpressionUUID->"d48b8467-67b1-4902-9a04-\
3e7a93029334"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "define", " ", "the", " ", "genotype", " ", "specific", " ", "term", " ", 
   RowBox[{
    SubscriptBox["M", "i"], "[", 
    RowBox[{"z", ",", "t"}], "]"}]}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     SubscriptBox["\[Beta]", "i"], "z"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"define", " ", "the", " ", "density", " ", "MGF", " ", "for", " ", 
   RowBox[{"K", "[", "t", "]"}], " ", "cosegregating", " ", 
   RowBox[{"genotypes", ":", 
    RowBox[{"M", "[", 
     RowBox[{"z", ",", "t"}], "]"}]}]}], "=", " ", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"i", "=", "1"}], 
    RowBox[{"K", "[", "t", "]"}]], 
   RowBox[{
    SubscriptBox["M", "i"], "[", 
    RowBox[{"z", ",", "t"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time", " ", "derivative", " ", "of", " ", 
   RowBox[{
    SubscriptBox["M", "i"], ":", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{
      SubscriptBox["M", "i"], "[", 
      RowBox[{"z", ",", "t"}], "]"}]}]}]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], 
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], 
     SubscriptBox["M", "i"]}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Alpha]", " ", "+", " ", "Uf"}], ")"}], "  ", 
    SubscriptBox["M", "i"]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "by", " ", "linearity", " ", "of", " ", "derivation", " ", "it", " ", 
   "applies", " ", "to", " ", "the", " ", 
   RowBox[{"sum", ":", "\[IndentingNewLine]", 
    StyleBox[
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], 
      RowBox[{"M", "[", 
       RowBox[{"z", ",", "t"}], "]"}]}],
     FontWeight->"Bold"]}]}], 
  StyleBox["=",
   FontWeight->"Bold"], 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], "M"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Alpha]", " ", "+", " ", "Uf"}], ")"}], "  ", "M"}]}],
   FontWeight->"Bold"]}]}], "Text",
 CellChangeTimes->{{3.8740358325601635`*^9, 3.8740359168157473`*^9}, {
  3.8740359902540617`*^9, 3.8740360188623753`*^9}, {3.8740360837816114`*^9, 
  3.8740361000598793`*^9}, {3.8740361384255953`*^9, 3.8740362150874596`*^9}, {
  3.878631213545088*^9, 3.878631213546084*^9}, {3.878701503026505*^9, 
  3.878701504997386*^9}, {3.87870273590736*^9, 
  3.8787027375318813`*^9}},ExpressionUUID->"8d503361-fe4c-4b04-ad17-\
d67f3fb80dcd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["M", "i"], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      SubscriptBox["\[Beta]", "i"], "z"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "t"], 
   SubscriptBox["M", "i"]}], "/.", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[ScriptCapitalI]", "i"], "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], "->", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Beta]", "i"], 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}], "-", 
    RowBox[{"\[Alpha]", "   ", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", 
      "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "==", 
   RowBox[{
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], 
      SubscriptBox["M", "i"]}]}], "-", 
    RowBox[{"\[Alpha]", "   ", 
     SubscriptBox["M", "i"]}]}]}], "//", "fs"}]}], "Input",
 CellChangeTimes->{{3.874035922542308*^9, 3.874035985484413*^9}, {
  3.874036022308508*^9, 3.8740360795285645`*^9}, {3.878631213548394*^9, 
  3.878631213549212*^9}, {3.87870151162475*^9, 3.878701515067829*^9}, {
  3.8787027384682703`*^9, 3.878702739430573*^9}, {3.878705689281163*^9, 
  3.878705693751944*^9}},
 CellLabel->
  "In[499]:=",ExpressionUUID->"db52e037-633c-4d8f-8b1c-2aa53d3f0716"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"z", " ", 
    SubscriptBox["\[Beta]", "i"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Alpha]"}], " ", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[Beta]", "i"], " ", 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.874035931151376*^9, 3.8740359648164363`*^9}, {
   3.874036023334611*^9, 3.8740360802912145`*^9}, 3.874038681781473*^9, 
   3.8740387264220505`*^9, 3.874061866105178*^9, 3.8756038721583014`*^9, 
   3.875846256855728*^9, 3.876797283131028*^9, 3.878359320806422*^9, 
   3.878630665562541*^9, 3.878634698845274*^9, 3.8787015165946283`*^9, 
   3.878702430851053*^9, 3.878702745859893*^9, 3.878705217471179*^9, 
   3.878705728732945*^9, 3.8787141598382397`*^9, 3.878714499199078*^9, 
   3.878722475339328*^9, 3.879493345219119*^9, 3.8794934126617317`*^9, 
   3.879493546973381*^9, 3.879494175748198*^9, 3.879504463715526*^9, 
   3.88060623957379*^9, 3.880606408994749*^9, 3.880686974615396*^9, 
   3.8806871254624166`*^9, 3.880687299109947*^9, 3.881818579669626*^9, 
   3.881989548603343*^9, 3.8819903749672318`*^9, 3.881991663441058*^9, 
   3.883479939998046*^9, 3.8836264670182247`*^9, 3.88372553454639*^9, 
   3.884076188412798*^9, 3.8840762658121243`*^9, 3.8840763837999887`*^9, 
   3.8840924415664883`*^9, 3.884145479405986*^9, 3.885527775232579*^9, 
   3.891858965902217*^9, 3.892699258001687*^9},
 CellLabel->
  "Out[500]=",ExpressionUUID->"fa94bf7e-6b41-40d1-820a-915e524189e4"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.874035931151376*^9, 3.8740359648164363`*^9}, {
   3.874036023334611*^9, 3.8740360802912145`*^9}, 3.874038681781473*^9, 
   3.8740387264220505`*^9, 3.874061866105178*^9, 3.8756038721583014`*^9, 
   3.875846256855728*^9, 3.876797283131028*^9, 3.878359320806422*^9, 
   3.878630665562541*^9, 3.878634698845274*^9, 3.8787015165946283`*^9, 
   3.878702430851053*^9, 3.878702745859893*^9, 3.878705217471179*^9, 
   3.878705728732945*^9, 3.8787141598382397`*^9, 3.878714499199078*^9, 
   3.878722475339328*^9, 3.879493345219119*^9, 3.8794934126617317`*^9, 
   3.879493546973381*^9, 3.879494175748198*^9, 3.879504463715526*^9, 
   3.88060623957379*^9, 3.880606408994749*^9, 3.880686974615396*^9, 
   3.8806871254624166`*^9, 3.880687299109947*^9, 3.881818579669626*^9, 
   3.881989548603343*^9, 3.8819903749672318`*^9, 3.881991663441058*^9, 
   3.883479939998046*^9, 3.8836264670182247`*^9, 3.88372553454639*^9, 
   3.884076188412798*^9, 3.8840762658121243`*^9, 3.8840763837999887`*^9, 
   3.8840924415664883`*^9, 3.884145479405986*^9, 3.885527775232579*^9, 
   3.891858965902217*^9, 3.8926992580059*^9},
 CellLabel->
  "Out[501]=",ExpressionUUID->"cad3123a-4fe5-4519-9472-4bc1cad945ff"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"time", " ", "derivative", " ", "of", " ", 
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], ":", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], 
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], "=", 
  RowBox[{"\[Lambda]", "-", " ", 
   RowBox[{"\[Delta]", " ", 
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "-", 
   RowBox[{
    RowBox[{
     OverscriptBox["\[Beta]", "_"], "[", "t", "]"}], 
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
    RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"where", " ", 
   RowBox[{
    OverscriptBox["\[Beta]", "_"], "[", "t", "]"}], 
   RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}], "=", 
  RowBox[{
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], 
     SubscriptBox["K", "t"]], 
    RowBox[{
     SubscriptBox["\[Beta]", "i"], 
     RowBox[{
      SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]}], "=", 
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      SubscriptBox["K", "t"]], 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], 
      RowBox[{
       SubscriptBox["M", "i"], "[", 
       RowBox[{"0", ",", "t"}], "]"}]}]}], "=", 
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], 
     RowBox[{"M", "[", 
      RowBox[{"0", ",", "t"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], 
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "=", 
   RowBox[{"\[Lambda]", "-", " ", 
    RowBox[{"\[Delta]", " ", 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "-", 
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], 
      RowBox[{"M", "[", 
       RowBox[{"0", ",", "t"}], "]"}]}]}]}]}],
  FontWeight->"Bold"]}], "Text",
 CellChangeTimes->{
  3.8740362198688684`*^9, {3.874036308216262*^9, 
   3.87403635689603*^9}},ExpressionUUID->"6e767364-b88f-4d2b-80de-\
17af69a37b88"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "z"], 
   SubscriptBox["M", "i"]}], "/.", 
  RowBox[{"z", "->", "0"}]}]], "Input",
 CellChangeTimes->{{3.8740362904600363`*^9, 3.874036304148283*^9}},
 CellLabel->
  "In[502]:=",ExpressionUUID->"54917e69-a9a3-4c4c-ad69-90c3a68a6d02"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Beta]", "i"], " ", 
  RowBox[{
   SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{{3.874036300861764*^9, 3.8740363056126747`*^9}, 
   3.874038681892743*^9, 3.874038729442852*^9, 3.874061866152034*^9, 
   3.875603872210104*^9, 3.8758462568870792`*^9, 3.876797283157394*^9, 
   3.878359320865327*^9, 3.878630665612434*^9, 3.878634698895293*^9, 
   3.878701528080556*^9, 3.878702433757886*^9, 3.8787027458954763`*^9, 
   3.878705217506957*^9, 3.8787057287720327`*^9, 3.878714159880917*^9, 
   3.878714499233403*^9, 3.87872247537813*^9, 3.879493345252716*^9, 
   3.879493412698539*^9, 3.879493547001577*^9, 3.879494178756981*^9, 
   3.879504463808633*^9, 3.8806062396377068`*^9, 3.880606409047007*^9, 
   3.880686974674182*^9, 3.880687125533134*^9, 3.880687299164*^9, 
   3.881818579696968*^9, 3.8819895486303062`*^9, 3.881990374994637*^9, 
   3.8819916634809427`*^9, 3.883479940140044*^9, 3.8836264670774307`*^9, 
   3.883725534576531*^9, 3.884076188455531*^9, 3.884076265843751*^9, 
   3.884076383836739*^9, 3.884092441597068*^9, 3.884145479441328*^9, 
   3.885527775270913*^9, 3.89185896592003*^9, 3.892699258035*^9},
 CellLabel->
  "Out[502]=",ExpressionUUID->"e128fa5a-1d81-4455-9021-3537ea9d93d0"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Demography", " ", "generates", " ", "selection", " ", "on", " ", 
  "the", " ", "system", " ", "and", " ", "we", " ", "have", " ", "the", " ", 
  "coupled", " ", "PDE", " ", "ODE", " ", "system"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], "\[ScriptCapitalS]"}],
   FontWeight->"Bold"], 
  StyleBox["=",
   FontWeight->"Bold"], 
  RowBox[{
   StyleBox["\[Lambda]",
    FontWeight->"Bold"], 
   StyleBox["-",
    FontWeight->"Bold"], 
   StyleBox[" ",
    FontWeight->"Bold"], 
   StyleBox[
    RowBox[{"\[Delta]", " ", "\[ScriptCapitalS]"}],
    FontWeight->"Bold"], 
   StyleBox["-",
    FontWeight->"Bold"], 
   RowBox[{
    StyleBox[
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], 
      RowBox[{"M", "[", 
       RowBox[{"0", ",", "t"}], "]"}]}],
     FontWeight->"Bold"], "\[ScriptCapitalS]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], "M"}], "=", 
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "M"}]}], "-", 
     RowBox[{"\[Alpha]", " ", "M"}]}]}],
   FontWeight->"Bold"], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"NB", ":", " ", 
  RowBox[{
  "These", " ", "are", " ", "linear", " ", "operators", " ", "on", " ", 
   "M"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", " ", "ssume"}], " ", "that", " ", "\[ScriptCapitalS]", 
   " ", "is", " ", "deterministic"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"2", "/", " ", "define"}], " ", "the", " ", "expected", " ", 
   RowBox[{"M", ":", 
    RowBox[{"\[ScriptCapitalM]", "[", 
     RowBox[{"z", ",", "t"}], "]"}]}]}], "=", 
  RowBox[{
   RowBox[{"\[DoubleStruckCapitalE]", "[", 
    RowBox[{"M", "[", 
     RowBox[{"z", ",", "t"}], "]"}], "]"}], 
   StyleBox["=",
    FontWeight->"Bold"], 
   StyleBox[" ",
    FontWeight->"Bold"], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], 
     RowBox[{"K", "[", "t", "]"}]], 
    RowBox[{"\[DoubleStruckCapitalE]", "[", 
     RowBox[{
      SubscriptBox["M", "i"], "[", 
      RowBox[{"z", ",", "t"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "this", " ", "expectation", " ", "is", " ", "taken", " ", "over", " ", 
   "the", " ", "initial", " ", "condition"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"As", " ", "expectation"}], ",", " ", 
  RowBox[{
  "sum", " ", "and", " ", "derivation", " ", "are", " ", "linear", " ", 
   "operators"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "t"], "\[ScriptCapitalS]"}], "=", 
  RowBox[{"\[Lambda]", "-", " ", 
   RowBox[{"\[Delta]", " ", "\[ScriptCapitalS]"}], "-", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], 
     RowBox[{"\[ScriptCapitalM]", "[", 
      RowBox[{"0", ",", "t"}], "]"}]}], 
    "\[ScriptCapitalS]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "t"], "\[ScriptCapitalM]"}], "=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalS]", " ", 
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "\[ScriptCapitalM]"}]}], "-", 
   RowBox[{"\[Alpha]", " ", "\[ScriptCapitalM]"}]}]}]}], "Text",
 CellChangeTimes->{{3.8740363677147455`*^9, 3.8740366267844257`*^9}, 
   3.8740366967722325`*^9, 3.8740367616291823`*^9, {3.878631213555327*^9, 
   3.878631213556108*^9}},ExpressionUUID->"1c313396-4457-451f-8d68-\
183b4e5dea34"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mutation: general result", "Subsubsection",
 CellChangeTimes->{{3.874036752308796*^9, 3.8740367581335526`*^9}, {
  3.874041128256895*^9, 
  3.8740411299454374`*^9}},ExpressionUUID->"d0ea5377-63e4-4fee-970e-\
35f8a47d67e5"],

Cell[BoxData[{
 RowBox[{"Mutation", " ", "effect", " ", "on", " ", 
  "M"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "mutation", " ", "during", " ", "\[Delta]t", " ", "occurs", " ", "in", " ", 
   "type", " ", "i", " ", "with", " ", "proba", " ", 
   SubscriptBox["\[DoubleStruckCapitalP]", "i"]}], "=", 
  RowBox[{"U", " ", 
   RowBox[{
    SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], 
   "\[Delta]t"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "its", " ", "effect", " ", "conditional", " ", "on", " ", "being", " ", 
   "in", " ", "type", " ", "i", " ", 
   RowBox[{"is", " ", ":", " ", 
    SubscriptBox["\[Beta]", "i"]}]}], "->", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Beta]", "i"], "+", "s"}], "|", 
   RowBox[{
    SubscriptBox["\[Beta]", "i"], " ", "for", " ", "one", " ", "individual", 
    " ", "and", " ", "no", " ", "change", " ", "for", " ", "the", " ", 
    "rest"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"where", " ", 
   SubscriptBox["s", "ij"], " ", "has", " ", "DFE", " ", "that", " ", 
   "depends", " ", "on", " ", 
   SubscriptBox["\[Beta]", "i"]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      SubscriptBox["\[Beta]", "i"], "z"}]]}], "->", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], "-", "1"}], 
      ")"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       SubscriptBox["\[Beta]", "i"], "z"}]]}], "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Beta]", "i"], "+", "s"}], ")"}], "z"}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"the", " ", "expected", " ", "effect", " ", "on", " ", 
   SubscriptBox["M", "i"], "  ", "given", " ", "s", " ", "is", " ", 
   RowBox[{"\[DoubleStruckCapitalE]", "[", 
    RowBox[{
     SubscriptBox["\[Delta]M", "i"], "|", "s"}], "]"}]}], "=", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"z", " ", 
     SubscriptBox["\[Beta]", "i"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"s", " ", "z"}]], "-", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"the", " ", "expected", " ", "effect", " ", "on", " ", 
   SubscriptBox["M", "i"], " ", "over", " ", "the", " ", "DFE", " ", 
   RowBox[{"(", 
    RowBox[{"given", " ", "mutation", " ", "in", " ", "i"}], ")"}], " ", 
   RowBox[{"is", ":", "\[IndentingNewLine]", 
    RowBox[{"\[DoubleStruckCapitalE]", "[", 
     RowBox[{
      SubscriptBox["\[Delta]M", "i"], "|", "i"}], "]"}]}]}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
    RowBox[{
     RowBox[{"\[DoubleStruckCapitalE]", "[", 
      RowBox[{
       SubscriptBox["\[Delta]M", "i"], "|", "s"}], "]"}], "|", "i"}], "]"}], 
   "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"z", " ", 
         SubscriptBox["\[Beta]", "i"]}]], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"s", " ", "z"}]], "-", "1"}], ")"}]}], "|", "i"}], "]"}], 
    "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"z", " ", 
       SubscriptBox["\[Beta]", "i"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"s", " ", "z"}]], "|", "i"}], "]"}], "-", "1"}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"s", " ", "z"}]], "|", "i"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"s", " ", "z"}]], "|", 
     SubscriptBox["\[Beta]", "i"]}], "]"}], " ", "is", " ", "the", " ", "MGF",
    " ", "of", " ", "the", " ", "DFE", " ", "given", " ", 
   SubscriptBox["\[Beta]", "i"]}]}]}], "Text",
 CellChangeTimes->{{3.874036763714631*^9, 3.8740368843980536`*^9}, {
  3.8740369151859655`*^9, 3.8740369430153823`*^9}, {3.8740369957160397`*^9, 
  3.8740371853520827`*^9}, {3.8740372308641586`*^9, 3.874037333769415*^9}, {
  3.8740373909219875`*^9, 3.874037404812766*^9}, {3.8740376228190064`*^9, 
  3.87403769145586*^9}, {3.8740377244039974`*^9, 3.8740377478009157`*^9}, {
  3.874037853386586*^9, 3.8740378589100237`*^9}, {3.8786312070151978`*^9, 
  3.878631209565422*^9}},ExpressionUUID->"5b2097d6-ba07-438a-b538-\
69ec997190cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SubscriptBox["M", "i"], 
      RowBox[{
       SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]], "/.", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Beta]", "i"], "->", 
       RowBox[{
        SubscriptBox["\[Beta]", "i"], "+", "s"}]}], ")"}]}], ")"}], "-", 
   FractionBox[
    SubscriptBox["M", "i"], 
    RowBox[{
     SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]]}], "//", 
  "fs"}]], "Input",
 CellChangeTimes->{{3.8740369562497416`*^9, 3.8740369927901554`*^9}, {
  3.874037697277658*^9, 3.874037713529961*^9}},
 CellLabel->
  "In[503]:=",ExpressionUUID->"3b171f0b-2c6c-436e-9e38-e4510d808306"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"z", " ", 
    SubscriptBox["\[Beta]", "i"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"s", " ", "z"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8740369791494045`*^9, 3.8740369931140356`*^9}, {
   3.8740377024052963`*^9, 3.874037714135415*^9}, 3.874038733373687*^9, 
   3.8740618661741343`*^9, 3.8756038722484417`*^9, 3.8758462569241867`*^9, 
   3.876797283187706*^9, 3.878359320888506*^9, 3.878630665646352*^9, 
   3.878634698989278*^9, 3.878701534282731*^9, 3.878702441557221*^9, 
   3.878702745978949*^9, 3.878705217579279*^9, 3.8787057288742847`*^9, 
   3.878714159955894*^9, 3.87871449932895*^9, 3.878722475465885*^9, 
   3.8794933453339577`*^9, 3.879493412778142*^9, 3.8794935470772953`*^9, 
   3.8794941789628353`*^9, 3.8795044639332113`*^9, 3.880606239676015*^9, 
   3.8806064091831703`*^9, 3.880686974719063*^9, 3.880687125569129*^9, 
   3.880687299195045*^9, 3.881818579717882*^9, 3.8819895486583023`*^9, 
   3.881990375016962*^9, 3.8819916635102663`*^9, 3.88347994017496*^9, 
   3.883626467099835*^9, 3.88372553460147*^9, 3.8840761885007763`*^9, 
   3.88407626587685*^9, 3.884076383868609*^9, 3.884092441626638*^9, 
   3.8841454794824247`*^9, 3.885527775304492*^9, 3.891858965941371*^9, 
   3.8926992580618267`*^9},
 CellLabel->
  "Out[503]=",ExpressionUUID->"d5efc3da-d9e6-4c47-b72c-44d5b8e9f01d"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"the", " ", "expected", " ", "effect", " ", "on", " ", "M", " ", 
  RowBox[{"(", 
   RowBox[{"over", " ", "all", " ", "mutating", " ", "backgrounds"}], ")"}], 
  " ", "is"}], "\[IndentingNewLine]", 
 RowBox[{"the", " ", "expected", " ", "effect", " ", "on", " ", "M", " ", 
  "given", " ", "mutation", " ", "in", " ", 
  RowBox[{"i", " ", "\[Cross]", " ", "the"}], " ", "proba", " ", "of", " ", 
  "mutation", " ", "in", " ", "i"}], "\[IndentingNewLine]", 
 RowBox[{"                  ", 
  RowBox[{
   RowBox[{"\[DoubleStruckCapitalE]", "[", 
    RowBox[{
     SubscriptBox["\[Delta]M", "i"], "|", "i"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"z", " ", 
       SubscriptBox["\[Beta]", "i"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"s", " ", "z"}]], "|", 
         SubscriptBox["\[Beta]", "i"]}], "]"}], "-", "1"}], ")"}], "              ", 
     SubscriptBox["\[DoubleStruckCapitalP]", "i"]}], "=", 
    RowBox[{"U", " ", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], 
     "\[Delta]t"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"this", " ", "is", " ", "the", " ", "expectation", " ", "of", " ", 
  "change", " ", "in", " ", "M", " ", "given", " ", "current", " ", 
  "M"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckCapitalE]", "[", 
   RowBox[{"\[Delta]M", "|", "M"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    UnderscriptBox["\[Sum]", "i"], 
    RowBox[{
     SubscriptBox["\[DoubleStruckCapitalP]", "i"], 
     RowBox[{"\[DoubleStruckCapitalE]", "[", 
      RowBox[{
       SubscriptBox["\[Delta]M", "i"], "|", "i"}], "]"}]}]}], "=", 
   RowBox[{"U", " ", "\[Delta]t", 
    RowBox[{
     UnderscriptBox["\[Sum]", "i"], 
     RowBox[{
      SubscriptBox["M", "i"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"s", " ", "z"}]], "|", 
          SubscriptBox["\[Beta]", "i"]}], "]"}], "-", "1"}], 
       ")"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "the", " ", "per", " ", "unit", " ", "time", " ", "expected", " ", "change",
    " ", 
   RowBox[{"is", " ", ":", 
    FractionBox[
     RowBox[{"\[DoubleStruckCapitalE]", "[", 
      RowBox[{"\[Delta]M", "|", "M"}], "]"}], "\[Delta]t"]}]}], "=", 
  RowBox[{
   RowBox[{"U", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       UnderscriptBox["\[Sum]", "i"], 
       RowBox[{
        SubscriptBox["M", "i"], " ", 
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"s", " ", "z"}]], "|", 
          SubscriptBox["\[Beta]", "i"]}], "]"}]}]}], "-", " ", 
      RowBox[{
       UnderscriptBox["\[Sum]", "i"], 
       SubscriptBox["M", "i"]}]}], ")"}]}], "=", 
   RowBox[{"U", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       UnderscriptBox["\[Sum]", "i"], 
       RowBox[{
        SubscriptBox["M", "i"], " ", 
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"s", " ", "z"}]], "|", 
          SubscriptBox["\[Beta]", "i"]}], "]"}]}]}], "-", " ", "M"}], 
     ")"}]}]}]}]}], "Text",
 CellChangeTimes->{{3.8740373387118683`*^9, 3.874037428894347*^9}, {
   3.8740374696472635`*^9, 3.87403754830056*^9}, 3.874037755928015*^9, {
   3.8740377878746023`*^9, 
   3.8740379280202537`*^9}},ExpressionUUID->"ddfe2e3a-e2fb-4833-b8a1-\
3d290e32af46"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", " ", 
   RowBox[{
    SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], "\[Delta]t", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"z", " ", 
     SubscriptBox["\[Beta]", "i"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"s", " ", "z"}]], "|", 
       SubscriptBox["\[Beta]", "i"]}], "]"}], "-", "1"}], ")"}]}], "//", 
  "fs"}], "\[IndentingNewLine]", 
 FractionBox["%", 
  RowBox[{
   SubscriptBox["M", "i"], "\[Delta]t"}]]}], "Input",
 CellChangeTimes->{{3.874037559792367*^9, 3.8740375601834106`*^9}, {
  3.87403775862612*^9, 3.874037776135764*^9}, {3.874037874484297*^9, 
  3.8740378785722055`*^9}},
 CellLabel->
  "In[504]:=",ExpressionUUID->"715dfae2-de2c-4d8b-b340-0be761ea02d7"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"z", " ", 
    SubscriptBox["\[Beta]", "i"]}]], " ", "U", " ", "\[Delta]t", " ", 
  RowBox[{
   SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", "z"}]], "|", 
      SubscriptBox["\[Beta]", "i"]}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.874037766553241*^9, 3.8740377768014727`*^9}, {
   3.8740378820090246`*^9, 3.8740378929147167`*^9}, 3.874038736287262*^9, 
   3.8740618661897593`*^9, 3.875603872295918*^9, 3.8758462569513493`*^9, 
   3.876797283216195*^9, 3.878359320906344*^9, 3.878630665665794*^9, 
   3.878634699013351*^9, 3.878701537056265*^9, 3.8787024425816708`*^9, 
   3.878702746003909*^9, 3.878705217601553*^9, 3.878705728899665*^9, 
   3.8787141599803677`*^9, 3.878714499356539*^9, 3.87872247549634*^9, 
   3.879493345359191*^9, 3.879493412802498*^9, 3.8794935471023808`*^9, 
   3.879494178996517*^9, 3.879504463966007*^9, 3.880606239711423*^9, 
   3.880606409210843*^9, 3.880686974755391*^9, 3.880687125604244*^9, 
   3.8806872992182207`*^9, 3.881818579736766*^9, 3.881989548683735*^9, 
   3.881990375039444*^9, 3.8819916635399446`*^9, 3.883479940193274*^9, 
   3.883626467121007*^9, 3.883725534625222*^9, 3.8840761885484333`*^9, 
   3.88407626590899*^9, 3.884076383896051*^9, 3.884092441646159*^9, 
   3.884145479507127*^9, 3.885527775322145*^9, 3.8918589659630823`*^9, 
   3.892699258086878*^9},
 CellLabel->
  "Out[504]=",ExpressionUUID->"bb0e15d1-be8c-40a2-a72c-4c5215cc73b6"],

Cell[BoxData[
 RowBox[{"U", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", "z"}]], "|", 
      SubscriptBox["\[Beta]", "i"]}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.874037766553241*^9, 3.8740377768014727`*^9}, {
   3.8740378820090246`*^9, 3.8740378929147167`*^9}, 3.874038736287262*^9, 
   3.8740618661897593`*^9, 3.875603872295918*^9, 3.8758462569513493`*^9, 
   3.876797283216195*^9, 3.878359320906344*^9, 3.878630665665794*^9, 
   3.878634699013351*^9, 3.878701537056265*^9, 3.8787024425816708`*^9, 
   3.878702746003909*^9, 3.878705217601553*^9, 3.878705728899665*^9, 
   3.8787141599803677`*^9, 3.878714499356539*^9, 3.87872247549634*^9, 
   3.879493345359191*^9, 3.879493412802498*^9, 3.8794935471023808`*^9, 
   3.879494178996517*^9, 3.879504463966007*^9, 3.880606239711423*^9, 
   3.880606409210843*^9, 3.880686974755391*^9, 3.880687125604244*^9, 
   3.8806872992182207`*^9, 3.881818579736766*^9, 3.881989548683735*^9, 
   3.881990375039444*^9, 3.8819916635399446`*^9, 3.883479940193274*^9, 
   3.883626467121007*^9, 3.883725534625222*^9, 3.8840761885484333`*^9, 
   3.88407626590899*^9, 3.884076383896051*^9, 3.884092441646159*^9, 
   3.884145479507127*^9, 3.885527775322145*^9, 3.8918589659630823`*^9, 
   3.8926992580904016`*^9},
 CellLabel->
  "Out[505]=",ExpressionUUID->"73bd4ac4-7aa5-4d4b-a251-0dec24aa0ad9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Apply to FGM  in 1 dimension", "Subsubsection",
 CellChangeTimes->{{3.8740411334618983`*^9, 
  3.8740411596251154`*^9}},ExpressionUUID->"fd9ae574-5a78-4dbf-b729-\
34331b3d18b5"],

Cell["\<\
Now we introduce our particular mutational model 
option 1: compute it in n = 1 dimension then extend\
\>", "Text",
 CellChangeTimes->{{3.8740379376172867`*^9, 3.874037957787187*^9}, {
  3.8740390736577277`*^9, 
  3.8740390906460657`*^9}},ExpressionUUID->"91899259-e70b-400d-bec0-\
b4eab6949882"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]f", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"g", ",", 
     RowBox[{"\[Beta]max", "-", 
      FractionBox[
       SuperscriptBox["g", "2"], 
       RowBox[{"2", " ", "Vs"}]]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{
    RowBox[{"\[Beta]f", "[", 
     RowBox[{"g", "+", "dg"}], "]"}], "-", 
    RowBox[{"\[Beta]f", "[", "g", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Expectation", "[", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"s", " ", "z"}]], ",", 
   RowBox[{"dg", "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0", ",", 
      SqrtBox["\[Lambda]"]}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ft", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]f", "[", "g", "]"}], "==", 
     SubscriptBox["\[Beta]", "i"]}], ",", "g"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%%", "/.", "%"}], "//", "fs"}]}], "Input",
 CellChangeTimes->{{3.874038241488318*^9, 3.8740382579630303`*^9}, {
  3.8740384826602464`*^9, 3.874038558464551*^9}, {3.874038655166356*^9, 
  3.8740386597332516`*^9}, {3.874038739315524*^9, 3.8740387751556387`*^9}, {
  3.874039033795552*^9, 3.8740390340192256`*^9}, {3.876797513712647*^9, 
  3.8767975140324707`*^9}, {3.87679762661524*^9, 3.876797626951455*^9}, {
  3.87863126799259*^9, 3.878631268471541*^9}},
 CellLabel->
  "In[506]:=",ExpressionUUID->"73fdce5b-5d9d-40d2-b4df-73027ce10d95"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["g", "2"], " ", 
     SuperscriptBox["z", "2"], " ", "\[Lambda]"}], 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["Vs", "2"]}], "+", 
     RowBox[{"2", " ", "Vs", " ", "z", " ", "\[Lambda]"}]}]]], 
  SqrtBox[
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"z", " ", "\[Lambda]"}], "Vs"]}]]]], "Output",
 CellChangeTimes->{
  3.874038261031095*^9, 3.8740384103202534`*^9, 3.874038524508459*^9, {
   3.874038555546917*^9, 3.8740385595062823`*^9}, {3.8740387653179264`*^9, 
   3.8740387769850564`*^9}, 3.8740390356003923`*^9, 3.874061867720245*^9, 
   3.8755894622514133`*^9, 3.875603874682925*^9, 3.8758462585324593`*^9, 
   3.8767972860109787`*^9, 3.876797519016654*^9, 3.876797629751473*^9, 
   3.878359322548617*^9, 3.878630667329425*^9, 3.878631271417556*^9, 
   3.878634700545644*^9, 3.87870154083885*^9, 3.878702445638628*^9, 
   3.87870274689635*^9, 3.878705219190151*^9, 3.8787057298713713`*^9, 
   3.878714160936716*^9, 3.878714500319503*^9, 3.878722476391024*^9, 
   3.879493346147626*^9, 3.879493413585939*^9, 3.879493547899722*^9, 
   3.8794941807052317`*^9, 3.87950446476048*^9, 3.880606241852249*^9, 
   3.880606410849166*^9, 3.880686977470069*^9, 3.880687127332449*^9, 
   3.880687300904261*^9, 3.8818185804681597`*^9, 3.881989549550619*^9, 
   3.881990375770006*^9, 3.881991665149426*^9, 3.883479942109695*^9, 
   3.88362646930371*^9, 3.883725536294496*^9, 3.8840761901877337`*^9, 
   3.884076267547152*^9, 3.884076385573435*^9, 3.884092443463434*^9, 
   3.884145481464953*^9, 3.885527777143441*^9, 3.8918589677307262`*^9, 
   3.892699260132649*^9},
 CellLabel->
  "Out[508]=",ExpressionUUID->"aa7da20f-e8ba-4142-9a79-7c301c0d715c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"g", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      SqrtBox["2"]}], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"Vs", " ", "\[Beta]max"}], "-", 
       RowBox[{"Vs", " ", 
        SubscriptBox["\[Beta]", "i"]}]}]]}]}], ",", 
   RowBox[{"g", "\[Rule]", 
    RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"Vs", " ", "\[Beta]max"}], "-", 
       RowBox[{"Vs", " ", 
        SubscriptBox["\[Beta]", "i"]}]}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.874038261031095*^9, 3.8740384103202534`*^9, 3.874038524508459*^9, {
   3.874038555546917*^9, 3.8740385595062823`*^9}, {3.8740387653179264`*^9, 
   3.8740387769850564`*^9}, 3.8740390356003923`*^9, 3.874061867720245*^9, 
   3.8755894622514133`*^9, 3.875603874682925*^9, 3.8758462585324593`*^9, 
   3.8767972860109787`*^9, 3.876797519016654*^9, 3.876797629751473*^9, 
   3.878359322548617*^9, 3.878630667329425*^9, 3.878631271417556*^9, 
   3.878634700545644*^9, 3.87870154083885*^9, 3.878702445638628*^9, 
   3.87870274689635*^9, 3.878705219190151*^9, 3.8787057298713713`*^9, 
   3.878714160936716*^9, 3.878714500319503*^9, 3.878722476391024*^9, 
   3.879493346147626*^9, 3.879493413585939*^9, 3.879493547899722*^9, 
   3.8794941807052317`*^9, 3.87950446476048*^9, 3.880606241852249*^9, 
   3.880606410849166*^9, 3.880686977470069*^9, 3.880687127332449*^9, 
   3.880687300904261*^9, 3.8818185804681597`*^9, 3.881989549550619*^9, 
   3.881990375770006*^9, 3.881991665149426*^9, 3.883479942109695*^9, 
   3.88362646930371*^9, 3.883725536294496*^9, 3.8840761901877337`*^9, 
   3.884076267547152*^9, 3.884076385573435*^9, 3.884092443463434*^9, 
   3.884145481464953*^9, 3.885527777143441*^9, 3.8918589677307262`*^9, 
   3.892699260138185*^9},
 CellLabel->
  "Out[509]=",ExpressionUUID->"bd4951cb-8323-4f35-88be-c6b62e546af6"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{"\[Beta]max", "-", 
       SubscriptBox["\[Beta]", "i"]}], ")"}]}], 
    RowBox[{"Vs", "+", 
     RowBox[{"z", " ", "\[Lambda]"}]}]]], 
  SqrtBox[
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"z", " ", "\[Lambda]"}], "Vs"]}]]]], "Output",
 CellChangeTimes->{
  3.874038261031095*^9, 3.8740384103202534`*^9, 3.874038524508459*^9, {
   3.874038555546917*^9, 3.8740385595062823`*^9}, {3.8740387653179264`*^9, 
   3.8740387769850564`*^9}, 3.8740390356003923`*^9, 3.874061867720245*^9, 
   3.8755894622514133`*^9, 3.875603874682925*^9, 3.8758462585324593`*^9, 
   3.8767972860109787`*^9, 3.876797519016654*^9, 3.876797629751473*^9, 
   3.878359322548617*^9, 3.878630667329425*^9, 3.878631271417556*^9, 
   3.878634700545644*^9, 3.87870154083885*^9, 3.878702445638628*^9, 
   3.87870274689635*^9, 3.878705219190151*^9, 3.8787057298713713`*^9, 
   3.878714160936716*^9, 3.878714500319503*^9, 3.878722476391024*^9, 
   3.879493346147626*^9, 3.879493413585939*^9, 3.879493547899722*^9, 
   3.8794941807052317`*^9, 3.87950446476048*^9, 3.880606241852249*^9, 
   3.880606410849166*^9, 3.880686977470069*^9, 3.880687127332449*^9, 
   3.880687300904261*^9, 3.8818185804681597`*^9, 3.881989549550619*^9, 
   3.881990375770006*^9, 3.881991665149426*^9, 3.883479942109695*^9, 
   3.88362646930371*^9, 3.883725536294496*^9, 3.8840761901877337`*^9, 
   3.884076267547152*^9, 3.884076385573435*^9, 3.884092443463434*^9, 
   3.884145481464953*^9, 3.885527777143441*^9, 3.8918589677307262`*^9, 
   3.892699260194351*^9},
 CellLabel->
  "Out[510]=",ExpressionUUID->"98655dc0-b08d-4f46-a52f-63bb2d674e8c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Apply to FGM  in n dimensions via polar coordinates", "Subsubsection",
 CellChangeTimes->{{3.8740411334618983`*^9, 3.8740411596251154`*^9}, {
  3.8740492200487633`*^9, 
  3.8740492242556186`*^9}},ExpressionUUID->"6fc2e172-134a-4c52-9fb0-\
f7b4ba1ec051"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"option", " ", "2"}], ":", " ", 
  RowBox[{"use", " ", "polar", " ", "coordinates", " ", 
   RowBox[{"{", 
    RowBox[{"\[ScriptR]", ",", "\[Theta]"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"let", " ", "|", "g", "|", 
   RowBox[{"\[Congruent]", 
    RowBox[{
    "\[ScriptG]", " ", "and", " ", "take", " ", "origin", " ", "of", " ", 
     "angles", " ", "at", " ", "the", " ", "direction", " ", "of", " ", "g", 
     " ", "so", " ", "that", " ", "\[Theta]"}]}]}], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"{", 
      RowBox[{"dg", ",", "g"}], "}"}], "^"], " ", "and", " ", "\[ScriptR]"}], 
   "=", 
   RowBox[{"|", "dg", "|"}]}]}]}], "Text",
 CellChangeTimes->{{3.8740390943709126`*^9, 3.8740391094925795`*^9}, {
  3.874039153078472*^9, 3.8740392927861567`*^9}, {3.8740393267382355`*^9, 
  3.874039374734476*^9}},ExpressionUUID->"5cef803c-5010-474b-a148-\
f42ed6931ccc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dg", ".", "dg"}], "=", 
   SuperscriptBox["\[ScriptR]", "2"]}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dg", ".", "g"}], "=", 
  RowBox[{"\[ScriptR]", " ", "\[ScriptG]", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"because", " ", "of", " ", "isotropy", " ", "\[ScriptR]", " ", "and",
   " ", "\[Theta]", " ", "have", " ", "independent", " ", 
  "distributions"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"because", " ", "of", " ", "normality", " ", "\[ScriptR]"}], 
   "\[Distributed]", " ", 
   RowBox[{"\[Lambda]", " ", 
    SubsuperscriptBox["\[Chi]", "n", "2"]}]}], "=", 
  RowBox[{"\[CapitalGamma]", "[", 
   RowBox[{
    FractionBox["n", "2"], ",", 
    RowBox[{"2", "\[Lambda]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"because", " ", "of", " ", "isotropy", " ", "\[Theta]", " ", "is", 
  " ", "the", " ", "distribution", " ", "of", " ", "the", " ", "angle", " ", 
  "on", " ", "the", " ", "n", " ", "sphere"}]}], "Text",
 CellChangeTimes->{
  3.874039377018252*^9, {3.874039630764928*^9, 3.8740396420493917`*^9}, 
   3.874039677574069*^9},ExpressionUUID->"7dd6d6a3-f409-4e00-bd43-\
aa1923be202f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TransformedDistribution", "[", 
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], "n"], 
     SubsuperscriptBox["dg", "i", "2"]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["dg", "i"], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", 
         SqrtBox["\[Lambda]"]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], "]"}], "==", 
  RowBox[{"TransformedDistribution", "[", 
   RowBox[{
    RowBox[{"\[Lambda]", " ", "\[Chi]"}], ",", 
    RowBox[{"\[Chi]", "\[Distributed]", 
     RowBox[{"ChiSquareDistribution", "[", "n", "]"}]}]}], "]"}], "==", 
  RowBox[{"GammaDistribution", "[", 
   RowBox[{
    FractionBox["n", "2"], ",", 
    RowBox[{"2", "\[Lambda]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=."}], ";"}]}], "Input",
 CellChangeTimes->{{3.874039382476076*^9, 3.8740396086253376`*^9}, {
  3.874039645389532*^9, 3.874039674007145*^9}, {3.874039785568992*^9, 
  3.8740397867769346`*^9}},
 CellLabel->
  "In[511]:=",ExpressionUUID->"c6d8c6d3-7b2b-472c-bb5d-1df6aa227b48"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8740395937661552`*^9, 3.8740396090273075`*^9}, {
   3.874039655307043*^9, 3.8740396746336718`*^9}, 3.8740397874271297`*^9, 
   3.874061867839004*^9, 3.8756038748144617`*^9, 3.87584625873275*^9, 
   3.876797286217189*^9, 3.878359322876794*^9, 3.87863066767597*^9, 
   3.8786313559322643`*^9, 3.878634700629447*^9, 3.878701554179043*^9, 
   3.878702446588663*^9, 3.878702747020495*^9, 3.878705219279517*^9, 
   3.878705729963586*^9, 3.87871416102922*^9, 3.878714500376604*^9, 
   3.878722476487739*^9, 3.8794933463312597`*^9, 3.879493413669239*^9, 
   3.87949354797859*^9, 3.879494180878149*^9, 3.8795044650076637`*^9, 
   3.8806062422461147`*^9, 3.880606411018031*^9, 3.880686977654257*^9, 
   3.880687127520483*^9, 3.880687301083659*^9, 3.881818580534337*^9, 
   3.88198954966181*^9, 3.881990375834478*^9, 3.881991665246766*^9, 
   3.883479942392421*^9, 3.883626469398777*^9, 3.8837255363377953`*^9, 
   3.8840761903066483`*^9, 3.8840762676486263`*^9, 3.884076385709097*^9, 
   3.884092443622203*^9, 3.884145481604653*^9, 3.885527777460909*^9, 
   3.891858967837254*^9, 3.892699260413312*^9},
 CellLabel->
  "Out[512]=",ExpressionUUID->"36e1887f-e910-4d5d-b246-5fab24a35bcd"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"we", " ", "can", " ", 
   RowBox[{"write", ":", " ", 
    RowBox[{"\[DoubleStruckCapitalE]", "[", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"s", " ", "z"}]], "]"}]}]}], "=", 
  RowBox[{
   SubscriptBox["\[DoubleStruckCapitalE]", 
    RowBox[{"\[ScriptR]", ",", "\[ScriptU]"}]], "[", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["\[ScriptR]", "2"], "2"]}], "-", 
       RowBox[{"\[ScriptG]", " ", "\[ScriptR]", " ", "\[ScriptU]"}]}], 
      ")"}]}]], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"take", " ", "expectation", " ", "on", " ", "\[ScriptU]", " ", 
  "then", " ", "on", " ", "\[ScriptR]"}]}], "Text",
 CellChangeTimes->{{3.874040358218154*^9, 3.8740404250990195`*^9}, {
  3.87404050479224*^9, 
  3.8740405137372627`*^9}},ExpressionUUID->"ce997b99-090d-4551-bbb5-\
6046ebedacc1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"s", "//", "Expand"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox["dg", "2"], "->", 
     SuperscriptBox["\[ScriptR]", "2"]}], ",", 
    RowBox[{
     RowBox[{"dg", " ", "g"}], "->", 
     RowBox[{"\[ScriptR]", " ", "\[ScriptG]", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{
   RowBox[{"Cos", "[", "\[Theta]", "]"}], "->", 
   "\[ScriptU]"}]}], "\[IndentingNewLine]", 
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{"%", " ", "z"}]]}], "Input",
 CellChangeTimes->{{3.8740390637610254`*^9, 3.8740390675756445`*^9}, {
  3.8740391196843348`*^9, 3.874039149715667*^9}, {3.874039191546886*^9, 
  3.874039228987769*^9}, {3.8740397137299023`*^9, 3.8740398494191465`*^9}, {
  3.874040509213917*^9, 3.874040509343295*^9}},
 CellLabel->
  "In[514]:=",ExpressionUUID->"c401161e-0aff-45cc-8505-07db468e71c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["dg", "2"], 
    RowBox[{"2", " ", "Vs"}]]}], "-", 
  FractionBox[
   RowBox[{"dg", " ", "g"}], "Vs"]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAuJf2YfCVe++cWTqrz6qD6Qr3KO3KDx44zjBIIJvOpC2
/3Q8J/3RG8fjRTHKSU/fOPpPKlv4DEjn8v7+DqKnvJwy8wWQjn7jZsf57I3j
sdef14Loh/mJl0E006NMDm4gPWOtvQeInvZGMY0fSKu87pkAomPWTigVBtLy
67zvdD9/43jOftsTEN2t1vAVRIepz3XpAdKH0pS8JgLpoyc8XVa/fOO4pi4x
EkQz7TDdcAlIS2z5eAhE+1QtvgGiv82daPX79RtHwf9bt/q9eeN4L+q3jD+Q
jviksQ9E83w8W6D2/o1j/qq1f3KBdNsN7ph5QDoi8/Rkzw9vHG9vLp0LoiWb
zNeA6DurSpoDgXQDr0lmNpAutdaP4fv8xvFF+u9Div+B7ovs49/D8NYRACKe
wQ8=
  "],
 CellLabel->
  "Out[514]=",ExpressionUUID->"7b9e5a63-576f-4137-950d-6a7855f88780"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["\[ScriptR]", "2"], 
    RowBox[{"2", " ", "Vs"}]]}], "-", 
  FractionBox[
   RowBox[{"\[ScriptG]", " ", "\[ScriptR]", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "Vs"]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAuJf2YfCVe++cWTqrz6qD6Qr3KO3KDx44zjBIIJvOpC2
/3Q8J/3RG8fjRTHKSU/fOPpPKlv4DEjn8v7+DqKnvJwy8wWQjn7jZsf57I3j
sdef14Loh/mJl0E006NMDm4gPWOtvQeInvZGMY0fSKu87pkAomPWTigVBtLy
67zvdD9/43jOftsTEN2t1vAVRIepz3XpAdKH0pS8JgLpoyc8XVa/fOO4pi4x
EkQz7TDdcAlIS2z5eAhE+1QtvgGiv82daPX79RtHwf9bt/q9eeN4L+q3jD+Q
jviksQ9E83w8W6D2/o1j/qq1f3KBdNsN7ph5QDoi8/Rkzw9vHG9vLp0LoiWb
zNeA6DurSpoDgXQDr0lmNpAutdaP4fv8xvFF+u9Div+B9rf08e9heOsIAB57
wJA=
  "],
 CellLabel->
  "Out[515]=",ExpressionUUID->"e577c1cf-1686-4537-9045-f14b74ffeae5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["\[ScriptR]", "2"], 
    RowBox[{"2", " ", "Vs"}]]}], "-", 
  FractionBox[
   RowBox[{"\[ScriptG]", " ", "\[ScriptR]", " ", "\[ScriptU]"}], 
   "Vs"]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAuJf2YfCVe++cWTqrz6qD6Qr3KO3KDx44zjBIIJvOpC2
/3Q8J/3RG8fjRTHKSU/fOPpPKlv4DEjn8v7+DqKnvJwy8wWQjn7jZsf57I3j
sdef14Loh/mJl0E006NMDm4gPWOtvQeInvZGMY0fSKu87pkAomPWTigVBtLy
67zvdD9/43jOftsTEN2t1vAVRIepz3XpAdKH0pS8JgLpoyc8XVa/fOO4pi4x
EkQz7TDdcAlIS2z5eAhE+1QtvgGiv82daPX79RtHwf9bt/q9eeN4L+q3jD+Q
jviksQ9E83w8W6D2/o1j/qq1f3KBdNsN7ph5QDoi8/Rkzw9vHG9vLp0LoiWb
zNeA6DurSpoDgXQDr0lmNpAutdaP4fv8xvFF+u9Div/fOJ5a1se/h+GtIwAk
+cFk
  "],
 CellLabel->
  "Out[516]=",ExpressionUUID->"b2e5f0fb-93fb-4242-a06f-454f3b24fa47"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[ScriptR]", "2"], 
       RowBox[{"2", " ", "Vs"}]]}], "-", 
     FractionBox[
      RowBox[{"\[ScriptG]", " ", "\[ScriptR]", " ", "\[ScriptU]"}], "Vs"]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAuJf2YfCVe++cWTqrz6qD6Qr3KO3KDx44zjBIIJvOpC2
/3Q8J/3RG8fjRTHKSU/fOPpPKlv4DEjn8v7+DqKnvJwy8wWQjn7jZsf57I3j
sdef14Loh/mJl0E006NMDm4gPWOtvQeInvZGMY0fSKu87pkAomPWTigVBtLy
67zvdD9/43jOftsTEN2t1vAVRIepz3XpAdKH0pS8JgLpoyc8XVa/fOO4pi4x
EkQz7TDdcAlIS2z5eAhE+1QtvgGiv82daPX79RtHwf9bt/q9eeN4L+q3jD+Q
jviksQ9E83w8W6D2/o1j/qq1f3KBdNsN7ph5QDoi8/Rkzw9vHG9vLp0LoiWb
zNeA6DurSpoDgXQDr0lmNpAutdaP4fv8xvFF+u9Div/fOD443se/h+GtIwAm
kMGb
  "],
 CellLabel->
  "Out[517]=",ExpressionUUID->"8513d635-aae8-4568-8c96-064020407e2e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"we", " ", "have", " ", "the", " ", "MGF", " ", "of", " ", 
   RowBox[{"\[ScriptU]", ":", " ", 
    RowBox[{
     SubscriptBox["\[DoubleStruckCapitalE]", "\[ScriptU]"], "[", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"z", " ", "\[ScriptU]"}]], "]"}]}]}], "=", 
  RowBox[{
   RowBox[{"Hypergeometric0F1", "[", 
    RowBox[{
     FractionBox["n", "2"], ",", 
     FractionBox[
      SuperscriptBox["z", "2"], "4"]}], "]"}], "\[Congruent]", 
   RowBox[{
    SubscriptBox["M", "\[ScriptU]"], "[", "z", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"(", 
  RowBox[{
  "eg", " ", "marginal", " ", "in", " ", "martin", " ", "lenormand", " ", 
   "2015", " ", "sup", " ", "info", " ", "A1", ".7", " ", "or", " ", 
   "recompute", " ", "it", " ", "from", " ", "PDF", " ", "of", " ", "u", " ", 
   RowBox[{"known", ":", " ", 
    RowBox[{
     RowBox[{"f", "[", "u", "]"}], "\[Proportional]", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"z", " ", "u"}]], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["u", "2"]}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "3"}], ")"}], "/", "2"}]]}]}]}]}]}]}], "Text",
 CellChangeTimes->{{3.874040526467435*^9, 3.8740405488884506`*^9}, {
  3.8740407656580935`*^9, 3.874040848826419*^9}, {3.8740410315803375`*^9, 
  3.8740410545177174`*^9}, {3.8740413825195055`*^9, 
  3.8740413901421227`*^9}},ExpressionUUID->"34eb4cfb-4963-4b7d-9cf2-\
fb68f28e8d56"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"\[CapitalKappa]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"z", " ", "u"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["u", "2"]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "3"}], ")"}], "/", "2"}]]}], ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{"\[Eta]", ">=", 
     RowBox[{"1", "/", "2"}]}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  FractionBox["%", 
   RowBox[{"%", "/.", 
    RowBox[{"z", "->", "0"}]}]], "//", "fs"}]}], "Input",
 CellChangeTimes->{{3.874040865350342*^9, 3.8740409497863774`*^9}, {
  3.874040985226901*^9, 3.8740410061736813`*^9}},
 CellLabel->
  "In[518]:=",ExpressionUUID->"f2c5e82b-1cff-489c-aabe-86ec205d5720"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{
     SqrtBox["\[Pi]"], " ", "\[CapitalKappa]", " ", 
     RowBox[{"Gamma", "[", 
       RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
           RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "]"}], " ", 
     RowBox[{"Hypergeometric0F1Regularized", "[", 
       RowBox[{
         FractionBox["n", "2"], ",", 
         FractionBox[
          SuperscriptBox["z", "2"], "4"]}], "]"}]}], 
   RowBox[{
     RowBox[{"Re", "[", "n", "]"}], ">", "1"}]},
  "ConditionalExpression"]], "Output",
 CellChangeTimes->{{3.874040916405886*^9, 3.8740409436271744`*^9}, {
   3.8740409899489303`*^9, 3.8740410161886344`*^9}, 3.8740618755034676`*^9, 
   3.875603883666667*^9, 3.8758462666533213`*^9, 3.876797295368823*^9, 
   3.878359330559403*^9, 3.878630675543767*^9, 3.878634708220883*^9, 
   3.878701561785932*^9, 3.8787024565755243`*^9, 3.8787027546525717`*^9, 
   3.878705226883354*^9, 3.878705737591591*^9, 3.878714168690995*^9, 
   3.878714508012837*^9, 3.8787224841406193`*^9, 3.879493353980741*^9, 
   3.879493421276289*^9, 3.879493555697019*^9, 3.8794941883720627`*^9, 
   3.879504472784009*^9, 3.880606251081346*^9, 3.88060641938076*^9, 
   3.880686985567595*^9, 3.880687135436482*^9, 3.880687308992283*^9, 
   3.881818588203165*^9, 3.8819895575713263`*^9, 3.8819903834943247`*^9, 
   3.881991672892942*^9, 3.8834799501989393`*^9, 3.883626477528051*^9, 
   3.883725543962514*^9, 3.8840761979944277`*^9, 3.8840762753186893`*^9, 
   3.8840763933949127`*^9, 3.8840924515563383`*^9, 3.884145489258601*^9, 
   3.885527785241502*^9, 3.891858975531163*^9, 3.892699268382744*^9},
 CellLabel->
  "Out[518]=",ExpressionUUID->"db6c7723-fd20-4f8a-bda5-5203e63008e7"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"Hypergeometric0F1", "[", 
     RowBox[{
       FractionBox["n", "2"], ",", 
       FractionBox[
        SuperscriptBox["z", "2"], "4"]}], "]"}], 
   RowBox[{
     RowBox[{"Re", "[", "n", "]"}], ">", "1"}]},
  "ConditionalExpression"]], "Output",
 CellChangeTimes->{{3.874040916405886*^9, 3.8740409436271744`*^9}, {
   3.8740409899489303`*^9, 3.8740410161886344`*^9}, 3.8740618755034676`*^9, 
   3.875603883666667*^9, 3.8758462666533213`*^9, 3.876797295368823*^9, 
   3.878359330559403*^9, 3.878630675543767*^9, 3.878634708220883*^9, 
   3.878701561785932*^9, 3.8787024565755243`*^9, 3.8787027546525717`*^9, 
   3.878705226883354*^9, 3.878705737591591*^9, 3.878714168690995*^9, 
   3.878714508012837*^9, 3.8787224841406193`*^9, 3.879493353980741*^9, 
   3.879493421276289*^9, 3.879493555697019*^9, 3.8794941883720627`*^9, 
   3.879504472784009*^9, 3.880606251081346*^9, 3.88060641938076*^9, 
   3.880686985567595*^9, 3.880687135436482*^9, 3.880687308992283*^9, 
   3.881818588203165*^9, 3.8819895575713263`*^9, 3.8819903834943247`*^9, 
   3.881991672892942*^9, 3.8834799501989393`*^9, 3.883626477528051*^9, 
   3.883725543962514*^9, 3.8840761979944277`*^9, 3.8840762753186893`*^9, 
   3.8840763933949127`*^9, 3.8840924515563383`*^9, 3.884145489258601*^9, 
   3.885527785241502*^9, 3.891858975531163*^9, 3.8926992684065638`*^9},
 CellLabel->
  "Out[519]=",ExpressionUUID->"df205a76-a9e6-42c6-b922-9c2176593169"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MGF", " ", "of", " ", "the", " ", 
   RowBox[{"DFE", ":", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "s"], "[", "z", "]"}], "\[Congruent]", 
     RowBox[{
      SubscriptBox["\[DoubleStruckCapitalE]", "\[ScriptS]"], "[", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", "z"}]], "]"}]}]}]}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalE]", 
     RowBox[{"\[ScriptR]", ",", "\[ScriptU]"}]], "[", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"z", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["\[ScriptR]", "2"], 
          RowBox[{"2", " ", "Vs"}]]}], "-", 
        FractionBox[
         RowBox[{"\[ScriptG]", " ", "\[ScriptR]", " ", "\[ScriptU]"}], 
         RowBox[{" ", "Vs"}]]}], ")"}]}]], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[DoubleStruckCapitalE]", "\[ScriptR]"], "[", 
      RowBox[{
       SubscriptBox["\[DoubleStruckCapitalE]", "\[ScriptU]"], "[", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox["\[ScriptR]", "2"], 
             RowBox[{"2", " ", "Vs"}]]}], "-", 
           FractionBox[
            RowBox[{"\[ScriptG]", " ", "\[ScriptR]", " ", "\[ScriptU]"}], 
            RowBox[{" ", "Vs"}]]}], ")"}]}]], "]"}], "]"}], " ", "isotropy"}],
     "\[Implies]", " ", 
    RowBox[{
    "\[ScriptU]", " ", "is", " ", "independent", " ", "of", " ", 
     "\[ScriptR]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[DoubleStruckCapitalE]", "\[ScriptU]"], "[", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["\[ScriptR]", "2"], 
         RowBox[{"2", " ", "Vs"}]]}], "-", 
       FractionBox[
        RowBox[{"\[ScriptG]", " ", "\[ScriptR]", " ", "\[ScriptU]"}], 
        RowBox[{" ", "Vs"}]]}], ")"}]}]], "]"}], "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["\[ScriptR]", "2"], 
        RowBox[{"2", " ", "Vs"}]]}], "z"}]], 
    RowBox[{
     SubscriptBox["\[DoubleStruckCapitalE]", "\[ScriptU]"], "[", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"z", " ", "\[ScriptG]", " ", "\[ScriptR]"}], 
          RowBox[{" ", "Vs"}]], ")"}]}], " ", "\[ScriptU]"}]], "]"}]}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["\[ScriptR]", "2"], 
         RowBox[{"2", " ", "Vs"}]]}], "z"}]], 
     RowBox[{
      SubscriptBox["M", "\[ScriptU]"], "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"z", " ", "\[ScriptG]", " ", "\[ScriptR]"}], 
        RowBox[{" ", "Vs"}]]}], "]"}]}], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"z", " ", 
         SuperscriptBox["\[ScriptR]", "2"]}], 
        RowBox[{"2", " ", "Vs"}]]}]], " ", 
     RowBox[{"Hypergeometric0F1", "[", 
      RowBox[{
       FractionBox["n", "2"], ",", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"4", "  ", 
          SuperscriptBox["Vs", "2"]}]], " ", 
        SuperscriptBox["z", "2"], " ", 
        SuperscriptBox["\[ScriptG]", "2"], " ", 
        SuperscriptBox["\[ScriptR]", "2"]}]}], "]"}]}]}]}]}]}], "Text",
 CellChangeTimes->{{3.874041267002939*^9, 3.8740413110297375`*^9}, {
  3.8740413751967545`*^9, 3.8740414132994547`*^9}, {3.874041496442569*^9, 
  3.8740415475169544`*^9}, {3.8740421183254614`*^9, 3.874042119656197*^9}, {
  3.878631933696208*^9, 3.878631962113463*^9}, {3.8786319999366693`*^9, 
  3.878632047024199*^9}},ExpressionUUID->"f1b40fcd-09ac-46d7-b968-\
e21eefc071ec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["\[ScriptR]", "2"], 
         RowBox[{"2", " ", "Vs"}]]}], "-", 
       FractionBox[
        RowBox[{"\[ScriptG]", " ", "\[ScriptR]", " ", "\[ScriptU]"}], 
        RowBox[{" ", "Vs"}]]}], ")"}]}]], "==", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["\[ScriptR]", "2"], 
        RowBox[{"2", " ", "Vs"}]]}], "z"}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"z", " ", "\[ScriptG]", " ", "\[ScriptR]"}], 
         RowBox[{" ", "Vs"}]], ")"}]}], " ", "\[ScriptU]"}]]}]}], "//", 
  "fs"}], "\[IndentingNewLine]", 
 RowBox[{"EuMGF", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["\[ScriptR]", "2"], 
         RowBox[{"2", " ", "Vs", " "}]]}], "z"}]], 
     RowBox[{
      SubscriptBox["M", "u"], "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"z", " ", "\[ScriptG]", " ", "\[ScriptR]"}], 
        RowBox[{" ", "Vs"}]]}], "]"}]}], "/.", 
    RowBox[{
     SubscriptBox["M", "u"], "->", 
     RowBox[{"Function", "[", 
      RowBox[{"z", ",", 
       RowBox[{"Hypergeometric0F1", "[", 
        RowBox[{
         FractionBox["n", "2"], ",", 
         FractionBox[
          SuperscriptBox["z", "2"], 
          RowBox[{"4", " "}]]}], "]"}]}], "]"}]}]}], "//", "fs"}]}]}], "Input",
 CellChangeTimes->{{3.874041326079771*^9, 3.8740413656004934`*^9}, {
  3.874041423775029*^9, 3.8740414918143873`*^9}, {3.8740415652876716`*^9, 
  3.8740415677889557`*^9}, {3.8786320548943577`*^9, 3.8786321133625717`*^9}, {
  3.891858989374772*^9, 3.891859010288879*^9}},
 CellLabel->
  "In[520]:=",ExpressionUUID->"5bb48c56-6c04-4f80-b4f8-8a3c0974b403"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8740413400626984`*^9, 3.8740413499762363`*^9}, 
   3.8740414173259354`*^9, {3.874041461663478*^9, 3.874041492663021*^9}, 
   3.8740415689040117`*^9, 3.8740618755815773`*^9, 3.875603883834701*^9, 
   3.875846266766362*^9, 3.87679729554305*^9, 3.878359330649642*^9, 
   3.878630675636969*^9, {3.8786321004445457`*^9, 3.878632113897089*^9}, 
   3.878634708278953*^9, 3.878701561846356*^9, 3.8787024566397543`*^9, 
   3.8787027547155867`*^9, 3.878705226945393*^9, 3.878705737656054*^9, 
   3.878714168758005*^9, 3.878714508080044*^9, 3.878722484212232*^9, 
   3.87949335416903*^9, 3.879493421332782*^9, 3.879493555753614*^9, 
   3.879494188464518*^9, 3.879504472846233*^9, 3.8806062512146387`*^9, 
   3.880606419500408*^9, 3.880686985667193*^9, 3.880687135558813*^9, 
   3.880687309095603*^9, 3.881818588290573*^9, 3.881989557645912*^9, 
   3.881990383568976*^9, 3.88199167295788*^9, 3.883479950296315*^9, 
   3.883626477591782*^9, 3.8837255440245657`*^9, 3.884076198082047*^9, 
   3.8840762753922377`*^9, 3.88407639346972*^9, 3.884092451651504*^9, 
   3.8841454894024353`*^9, 3.885527785364805*^9, {3.8918589756668253`*^9, 
   3.891859013280923*^9}, 3.892699268493701*^9},
 CellLabel->
  "Out[520]=",ExpressionUUID->"913c9b72-5a18-4c65-8c7c-3ce02da0c97e"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"z", " ", 
      SuperscriptBox["\[ScriptR]", "2"]}], 
     RowBox[{"2", " ", "Vs"}]]}]], " ", 
  RowBox[{"Hypergeometric0F1", "[", 
   RowBox[{
    FractionBox["n", "2"], ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["z", "2"], " ", 
      SuperscriptBox["\[ScriptG]", "2"], " ", 
      SuperscriptBox["\[ScriptR]", "2"]}], 
     RowBox[{"4", " ", 
      SuperscriptBox["Vs", "2"]}]]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.8740413400626984`*^9, 3.8740413499762363`*^9}, 
   3.8740414173259354`*^9, {3.874041461663478*^9, 3.874041492663021*^9}, 
   3.8740415689040117`*^9, 3.8740618755815773`*^9, 3.875603883834701*^9, 
   3.875846266766362*^9, 3.87679729554305*^9, 3.878359330649642*^9, 
   3.878630675636969*^9, {3.8786321004445457`*^9, 3.878632113897089*^9}, 
   3.878634708278953*^9, 3.878701561846356*^9, 3.8787024566397543`*^9, 
   3.8787027547155867`*^9, 3.878705226945393*^9, 3.878705737656054*^9, 
   3.878714168758005*^9, 3.878714508080044*^9, 3.878722484212232*^9, 
   3.87949335416903*^9, 3.879493421332782*^9, 3.879493555753614*^9, 
   3.879494188464518*^9, 3.879504472846233*^9, 3.8806062512146387`*^9, 
   3.880606419500408*^9, 3.880686985667193*^9, 3.880687135558813*^9, 
   3.880687309095603*^9, 3.881818588290573*^9, 3.881989557645912*^9, 
   3.881990383568976*^9, 3.88199167295788*^9, 3.883479950296315*^9, 
   3.883626477591782*^9, 3.8837255440245657`*^9, 3.884076198082047*^9, 
   3.8840762753922377`*^9, 3.88407639346972*^9, 3.884092451651504*^9, 
   3.8841454894024353`*^9, 3.885527785364805*^9, {3.8918589756668253`*^9, 
   3.891859013280923*^9}, 3.8926992687190943`*^9},
 CellLabel->
  "Out[521]=",ExpressionUUID->"c15f0c3e-be84-42be-982a-ef745cb27e7a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["M", "s"], "[", "z", "]"}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[DoubleStruckCapitalE]", "\[ScriptS]"], "[", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"s", " ", "z"}]], "]"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[DoubleStruckCapitalE]", "\[ScriptR]"], "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"z", " ", 
           SuperscriptBox["\[ScriptR]", "2"]}], 
          RowBox[{"2", "  ", "Vs"}]]}]], " ", 
       RowBox[{"Hypergeometric0F1", "[", 
        RowBox[{
         FractionBox["n", "2"], ",", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"4", "  ", "Vs\.b2"}]], " ", 
          SuperscriptBox["z", "2"], " ", 
          SuperscriptBox["\[ScriptG]", "2"], " ", 
          SuperscriptBox["\[ScriptR]", "2"]}]}], "]"}]}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         SuperscriptBox["z", "2"], " ", 
         SuperscriptBox["\[ScriptG]", "2"], " ", "\[Lambda]"}], 
        RowBox[{"2", "+", 
         RowBox[{"2", " ", "z", " ", "\[Lambda]"}]}]]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"z", " ", "\[Lambda]"}]}], ")"}], 
       RowBox[{
        RowBox[{"-", "n"}], "/", "2"}]]}]}]}]}], 
  "\[IndentingNewLine]"}]], "Text",
 CellChangeTimes->{{3.8740415786814404`*^9, 3.874041586387478*^9}, {
   3.8740416746887054`*^9, 3.874041718054323*^9}, {3.8740420314594145`*^9, 
   3.874042037982049*^9}, {3.8740421289129105`*^9, 3.8740421292779074`*^9}, {
   3.878632120880453*^9, 3.878632130097006*^9}, 3.883540794778771*^9, {
   3.88354084312993*^9, 
   3.8835408443983593`*^9}},ExpressionUUID->"b2337d32-6a12-4c75-a26e-\
d871940d7309"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Esz", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"EuMGF", "/.", 
       RowBox[{"\[ScriptR]", "->", 
        SqrtBox["\[Gamma]"]}]}], ",", 
      RowBox[{"\[Gamma]", "\[Distributed]", 
       RowBox[{"GammaDistribution", "[", 
        RowBox[{
         FractionBox["n", "2"], ",", 
         RowBox[{"2", "\[Lambda]"}]}], "]"}]}], ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{
        RowBox[{"n", ">=", "1"}], "&&", 
        RowBox[{"\[Lambda]", ">", "0"}]}]}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"n", ">=", "1"}], "&&", 
     RowBox[{"\[Lambda]", ">", "0"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", 
  RowBox[{"Esz", ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.883545329385796*^9, 3.883545406103078*^9}},
 CellLabel->
  "In[522]:=",ExpressionUUID->"1f6e3b6f-b878-4dd1-8939-30b57b091b3d"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     SuperscriptBox["\[ScriptG]", "2"], " ", "\[Lambda]"}], 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["Vs", "2"]}], "+", 
     RowBox[{"2", " ", "Vs", " ", "z", " ", "\[Lambda]"}]}]]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"z", " ", "\[Lambda]"}], "Vs"]}], ")"}], 
   RowBox[{
    RowBox[{"-", "n"}], "/", "2"}]]}]], "Output",
 CellChangeTimes->{
  3.8740420437105355`*^9, 3.874061884304702*^9, 3.875603892925782*^9, 
   3.87584627558139*^9, 3.8767973047548018`*^9, 3.8783593393914003`*^9, 
   3.878630684362089*^9, 3.878632145159812*^9, 3.878634717080369*^9, 
   3.8787015706403713`*^9, 3.878702465476984*^9, 3.8787027635278*^9, 
   3.878705235751165*^9, 3.878705746475729*^9, 3.878714177585726*^9, 
   3.878714516896435*^9, 3.878722493027782*^9, 3.8794933629809647`*^9, 
   3.879493430139103*^9, 3.8794935645721684`*^9, 3.8794941973253202`*^9, 
   3.879504481866645*^9, 3.8806062605759363`*^9, 3.880606428814373*^9, 
   3.880686994767992*^9, 3.8806871446824923`*^9, 3.880687318190628*^9, 
   3.88181859712164*^9, 3.881989566598764*^9, 3.881990392391869*^9, 
   3.8819916817885523`*^9, 3.883479959414559*^9, {3.8835453815510387`*^9, 
   3.883545414921773*^9}, 3.883626486608803*^9, 3.883725552948914*^9, 
   3.884076206901701*^9, 3.884076284208888*^9, 3.884076402310823*^9, 
   3.8840924607780733`*^9, 3.884145498454739*^9, 3.885527794485489*^9, {
   3.891858984636331*^9, 3.8918590238329287`*^9}, 3.892699277552422*^9},
 CellLabel->
  "Out[522]=",ExpressionUUID->"db2a12b4-2555-4ef2-8de3-5f0bbf3f57aa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "n"}], " ", "Vs", " ", "z"}], "+", 
       RowBox[{
        SuperscriptBox["z", "2"], " ", 
        SuperscriptBox["\[ScriptG]", "2"]}]}], ")"}], " ", "\[Lambda]"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["Vs", "2"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Lambda]", "]"}], "2"],
    SeriesData[$CellContext`\[Lambda], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Lambda], 0, {
   1, Rational[
     1, 2] $CellContext`Vs^(-2) (-$CellContext`n $CellContext`Vs \
$CellContext`z + $CellContext`z^2 $CellContext`\[ScriptG]^2)}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.8740420437105355`*^9, 3.874061884304702*^9, 3.875603892925782*^9, 
   3.87584627558139*^9, 3.8767973047548018`*^9, 3.8783593393914003`*^9, 
   3.878630684362089*^9, 3.878632145159812*^9, 3.878634717080369*^9, 
   3.8787015706403713`*^9, 3.878702465476984*^9, 3.8787027635278*^9, 
   3.878705235751165*^9, 3.878705746475729*^9, 3.878714177585726*^9, 
   3.878714516896435*^9, 3.878722493027782*^9, 3.8794933629809647`*^9, 
   3.879493430139103*^9, 3.8794935645721684`*^9, 3.8794941973253202`*^9, 
   3.879504481866645*^9, 3.8806062605759363`*^9, 3.880606428814373*^9, 
   3.880686994767992*^9, 3.8806871446824923`*^9, 3.880687318190628*^9, 
   3.88181859712164*^9, 3.881989566598764*^9, 3.881990392391869*^9, 
   3.8819916817885523`*^9, 3.883479959414559*^9, {3.8835453815510387`*^9, 
   3.883545414921773*^9}, 3.883626486608803*^9, 3.883725552948914*^9, 
   3.884076206901701*^9, 3.884076284208888*^9, 3.884076402310823*^9, 
   3.8840924607780733`*^9, 3.884145498454739*^9, 3.885527794485489*^9, {
   3.891858984636331*^9, 3.8918590238329287`*^9}, 3.892699277556012*^9},
 CellLabel->
  "Out[523]=",ExpressionUUID->"7cadcad4-8615-4e31-9b0b-823b16a1a868"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"This", " ", "expresses", " ", "the", " ", "MGF", " ", "odf", " ", 
  "the", " ", "DFE", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
  "the", " ", "squared", " ", "norm", " ", "of", " ", "g", " ", "not", " ", 
  "of", " ", "fitness"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"we", " ", 
   RowBox[{"use", " ", ":", " ", 
    RowBox[{"\[Beta]", "[", "g", "]"}]}]}], "=", 
  RowBox[{
   SubscriptBox["\[Beta]", "max"], "-", 
   RowBox[{
    FractionBox[
     SuperscriptBox["\[ScriptG]", "2"], 
     RowBox[{"2", " ", "Vs"}]], " ", "and", " ", "finally", " ", "we", " ", 
    "get"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["M", "s"], "[", "z", "]"}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["M", "*"], "[", "z", "]"}], 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Omega]", "[", "z", "]"}]}], 
     SubscriptBox["\[Beta]", "i"]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["M", "*"], "[", "z", "]"}], "=", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
      SubscriptBox["\[Beta]", "max"]}], 
     RowBox[{" ", 
      RowBox[{"Vs", "+", 
       RowBox[{"z", " ", "\[Lambda]"}]}]}]]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"z", " ", "\[Lambda]"}], 
       RowBox[{" ", "Vs"}]]}], ")"}], 
    RowBox[{
     RowBox[{"-", "n"}], "/", "2"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]", "[", "z", "]"}], "=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", "\[Lambda]", " "}], 
   RowBox[{" ", 
    RowBox[{"Vs", "+", 
     RowBox[{"\[Lambda]", " ", "z"}]}]}]]}]}], "Text",
 CellChangeTimes->{{3.874042100837308*^9, 3.8740421417255754`*^9}, {
  3.8740421963386383`*^9, 3.874042223688758*^9}, {3.878632253274414*^9, 
  3.878632257594159*^9}, {3.8786323107381268`*^9, 
  3.878632322986389*^9}},ExpressionUUID->"5d6601bc-890b-46fd-9ba4-\
7c40952a5ff0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Beta]", "i"], "==", 
    RowBox[{
     SubscriptBox["\[Beta]", "max"], "-", 
     FractionBox[
      SuperscriptBox["\[ScriptG]", "2"], 
      RowBox[{"2", " ", "Vs"}]]}]}], ",", "\[ScriptG]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Esz", "/.", 
    RowBox[{"%", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ",", 
   RowBox[{
    SubscriptBox["\[Beta]", "max"], ">=", "\[Beta]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "==", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "*"], "[", "z", "]"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Omega]", "[", "z", "]"}]}], 
       SubscriptBox["\[Beta]", "i"]}]]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "*"], "->", 
      RowBox[{"Function", "[", 
       RowBox[{"z", ",", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
            SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
            SubscriptBox["\[Beta]", "max"]}], 
           RowBox[{"Vs", "+", 
            RowBox[{"z", " ", "\[Lambda]"}]}]]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox[
             RowBox[{"z", " ", "\[Lambda]"}], "Vs"]}], ")"}], 
          RowBox[{
           RowBox[{"-", "n"}], "/", "2"}]]}]}], "]"}]}], ",", 
     RowBox[{"\[Omega]", "->", 
      RowBox[{"Function", "[", 
       RowBox[{"z", ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["z", "2"], " ", "\[Lambda]", " "}], 
         RowBox[{"Vs", "+", 
          RowBox[{"\[Lambda]", " ", "z"}]}]]}], "]"}]}]}], "}"}]}], "//", 
  "fs"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8740415893714485`*^9, 3.874041661254971*^9}, {
   3.8740417223577943`*^9, 3.8740420161925955`*^9}, {3.8740420497403307`*^9, 
   3.874042091146572*^9}, {3.874042144438742*^9, 3.8740421471449313`*^9}, {
   3.8767973119976053`*^9, 3.8767973154410667`*^9}, 3.876797345458674*^9, {
   3.8786322768886747`*^9, 3.8786323049737473`*^9}},
 CellLabel->
  "In[524]:=",ExpressionUUID->"54d69a67-7029-4474-bfaf-a79393ed32e2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[ScriptG]", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       SqrtBox["2"]}], " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "Vs"}], " ", 
         SubscriptBox["\[Beta]", "i"]}], "+", 
        RowBox[{"Vs", " ", 
         SubscriptBox["\[Beta]", "max"]}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[ScriptG]", "\[Rule]", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "Vs"}], " ", 
         SubscriptBox["\[Beta]", "i"]}], "+", 
        RowBox[{"Vs", " ", 
         SubscriptBox["\[Beta]", "max"]}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8740416348407927`*^9, 3.8740416704005814`*^9}, 
   3.8740417598355827`*^9, {3.8740417968520756`*^9, 3.8740418217122574`*^9}, {
   3.8740419554754295`*^9, 3.8740419825517673`*^9}, {3.8740420256379333`*^9, 
   3.874042054124844*^9}, {3.8740420877201033`*^9, 3.874042091696065*^9}, 
   3.874042147978153*^9, 3.874061884358075*^9, 3.8756038930960627`*^9, 
   3.875846275664328*^9, 3.87679726869448*^9, {3.876797304880128*^9, 
   3.87679731607344*^9}, 3.876797824969533*^9, 3.878359339463999*^9, 
   3.878630684437854*^9, {3.878632279724431*^9, 3.8786323053459883`*^9}, 
   3.878634717114296*^9, 3.878701570675233*^9, 3.878702465511612*^9, 
   3.878702763588542*^9, 3.8787052357877417`*^9, 3.8787057465146027`*^9, 
   3.878714177625448*^9, 3.8787145169342833`*^9, 3.8787224930773582`*^9, 
   3.879493363012566*^9, 3.8794934301688137`*^9, 3.87949356460922*^9, 
   3.879494197416965*^9, 3.879504481900159*^9, 3.880606260663766*^9, 
   3.880606428904739*^9, 3.880686994856142*^9, 3.8806871447701178`*^9, 
   3.88068731827579*^9, 3.881818597157855*^9, 3.8819895666419573`*^9, 
   3.881990392427762*^9, 3.881991681832527*^9, 3.883479959498116*^9, 
   3.8836264867302103`*^9, 3.883725552987198*^9, 3.88407620696376*^9, 
   3.884076284260067*^9, 3.8840764025221157`*^9, 3.88409246088029*^9, 
   3.8841454985470943`*^9, 3.88552779458424*^9, 3.892699277665195*^9},
 CellLabel->
  "Out[524]=",ExpressionUUID->"449eb925-2f60-487a-accd-d308a377ff91"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["\[Beta]", "i"]}], "+", 
       SubscriptBox["\[Beta]", "max"]}], ")"}]}], 
    RowBox[{"Vs", "+", 
     RowBox[{"z", " ", "\[Lambda]"}]}]]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"z", " ", "\[Lambda]"}], "Vs"]}], ")"}], 
   RowBox[{
    RowBox[{"-", "n"}], "/", "2"}]]}]], "Output",
 CellChangeTimes->{{3.8740416348407927`*^9, 3.8740416704005814`*^9}, 
   3.8740417598355827`*^9, {3.8740417968520756`*^9, 3.8740418217122574`*^9}, {
   3.8740419554754295`*^9, 3.8740419825517673`*^9}, {3.8740420256379333`*^9, 
   3.874042054124844*^9}, {3.8740420877201033`*^9, 3.874042091696065*^9}, 
   3.874042147978153*^9, 3.874061884358075*^9, 3.8756038930960627`*^9, 
   3.875846275664328*^9, 3.87679726869448*^9, {3.876797304880128*^9, 
   3.87679731607344*^9}, 3.876797824969533*^9, 3.878359339463999*^9, 
   3.878630684437854*^9, {3.878632279724431*^9, 3.8786323053459883`*^9}, 
   3.878634717114296*^9, 3.878701570675233*^9, 3.878702465511612*^9, 
   3.878702763588542*^9, 3.8787052357877417`*^9, 3.8787057465146027`*^9, 
   3.878714177625448*^9, 3.8787145169342833`*^9, 3.8787224930773582`*^9, 
   3.879493363012566*^9, 3.8794934301688137`*^9, 3.87949356460922*^9, 
   3.879494197416965*^9, 3.879504481900159*^9, 3.880606260663766*^9, 
   3.880606428904739*^9, 3.880686994856142*^9, 3.8806871447701178`*^9, 
   3.88068731827579*^9, 3.881818597157855*^9, 3.8819895666419573`*^9, 
   3.881990392427762*^9, 3.881991681832527*^9, 3.883479959498116*^9, 
   3.8836264867302103`*^9, 3.883725552987198*^9, 3.88407620696376*^9, 
   3.884076284260067*^9, 3.8840764025221157`*^9, 3.88409246088029*^9, 
   3.8841454985470943`*^9, 3.88552779458424*^9, 3.892699277742056*^9},
 CellLabel->
  "Out[525]=",ExpressionUUID->"e7c50a00-2460-46c6-8d79-5976ff892d48"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8740416348407927`*^9, 3.8740416704005814`*^9}, 
   3.8740417598355827`*^9, {3.8740417968520756`*^9, 3.8740418217122574`*^9}, {
   3.8740419554754295`*^9, 3.8740419825517673`*^9}, {3.8740420256379333`*^9, 
   3.874042054124844*^9}, {3.8740420877201033`*^9, 3.874042091696065*^9}, 
   3.874042147978153*^9, 3.874061884358075*^9, 3.8756038930960627`*^9, 
   3.875846275664328*^9, 3.87679726869448*^9, {3.876797304880128*^9, 
   3.87679731607344*^9}, 3.876797824969533*^9, 3.878359339463999*^9, 
   3.878630684437854*^9, {3.878632279724431*^9, 3.8786323053459883`*^9}, 
   3.878634717114296*^9, 3.878701570675233*^9, 3.878702465511612*^9, 
   3.878702763588542*^9, 3.8787052357877417`*^9, 3.8787057465146027`*^9, 
   3.878714177625448*^9, 3.8787145169342833`*^9, 3.8787224930773582`*^9, 
   3.879493363012566*^9, 3.8794934301688137`*^9, 3.87949356460922*^9, 
   3.879494197416965*^9, 3.879504481900159*^9, 3.880606260663766*^9, 
   3.880606428904739*^9, 3.880686994856142*^9, 3.8806871447701178`*^9, 
   3.88068731827579*^9, 3.881818597157855*^9, 3.8819895666419573`*^9, 
   3.881990392427762*^9, 3.881991681832527*^9, 3.883479959498116*^9, 
   3.8836264867302103`*^9, 3.883725552987198*^9, 3.88407620696376*^9, 
   3.884076284260067*^9, 3.8840764025221157`*^9, 3.88409246088029*^9, 
   3.8841454985470943`*^9, 3.88552779458424*^9, 3.892699277763229*^9},
 CellLabel->
  "Out[526]=",ExpressionUUID->"98b6eacc-40e1-4aa5-9b89-2eef8e8cf79c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Close the PDE", "Subsubsection",
 CellChangeTimes->{{3.8740422844340754`*^9, 
  3.8740422879637527`*^9}},ExpressionUUID->"7f3e28f0-3598-4adb-8918-\
9661b54a1d84"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"we", " ", "know", " ", "that", " ", 
   FractionBox[
    RowBox[{"\[DoubleStruckCapitalE]", "[", 
     RowBox[{"\[Delta]M", "|", "M"}], "]"}], "\[Delta]t"]}], "=", 
  RowBox[{"U", 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{
      UnderscriptBox["\[Sum]", "i"], 
      RowBox[{
       RowBox[{
        SubscriptBox["M", "i"], " ", "[", "z", "]"}], 
       RowBox[{
        SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"s", " ", "z"}]], "|", 
         SubscriptBox["\[Beta]", "i"]}], "]"}]}]}], "-", " ", 
     RowBox[{"M", "[", "z", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"and", " ", "that", "  ", 
    RowBox[{
     SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", "z"}]], "|", 
      SubscriptBox["\[Beta]", "i"]}], "]"}]}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["M", "*"], "[", "z", "]"}], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[Omega]", "[", "z", "]"}]}], 
      SubscriptBox["\[Beta]", "i"]}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"we", " ", 
   RowBox[{"have", ":", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "i"], "[", "z", "]"}], " ", 
     RowBox[{
      SubscriptBox["\[DoubleStruckCapitalE]", "s"], "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"s", " ", "z"}]], "|", 
       SubscriptBox["\[Beta]", "i"]}], "]"}]}]}]}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["M", "i"], "[", 
    RowBox[{"z", "-", 
     RowBox[{"\[Omega]", "[", "z", "]"}]}], "]"}], " ", 
   RowBox[{
    SubscriptBox["M", "*"], "[", "z", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"so", " ", 
   RowBox[{"that", " ", ":", "\[IndentingNewLine]", 
    FractionBox[
     RowBox[{"\[DoubleStruckCapitalE]", "[", 
      RowBox[{"\[Delta]M", "|", "M"}], "]"}], "\[Delta]t"]}]}], "=", 
  RowBox[{
   RowBox[{"U", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       UnderscriptBox["\[Sum]", "i"], 
       RowBox[{
        RowBox[{
         SubscriptBox["M", "i"], "[", 
         RowBox[{"z", "-", 
          RowBox[{"\[Omega]", "[", "z", "]"}]}], "]"}], " ", 
        RowBox[{
         SubscriptBox["M", "*"], "[", "z", "]"}]}]}], "-", " ", 
      RowBox[{"M", "[", "z", "]"}]}], ")"}]}], "=", 
   RowBox[{"U", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"M", "[", 
        RowBox[{"z", "-", 
         RowBox[{"\[Omega]", "[", "z", "]"}]}], "]"}], " ", 
       RowBox[{
        SubscriptBox["M", "*"], "[", "z", "]"}]}], "-", " ", 
      RowBox[{"M", "[", "z", "]"}]}], ")"}]}]}]}]}], "Text",
 CellChangeTimes->{{3.8740423199327517`*^9, 3.874042343681743*^9}, {
  3.8740424104482613`*^9, 
  3.8740424857820873`*^9}},ExpressionUUID->"7c501d11-3e6d-4628-b4d1-\
40173e2bd85a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["M", "i"], " ", 
   RowBox[{
    SubscriptBox["M", "*"], "[", "z", "]"}], 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Omega]", "[", "z", "]"}]}], 
     SubscriptBox["\[Beta]", "i"]}]]}], "//", "fs"}], "\[IndentingNewLine]", 
 FractionBox["%", 
  RowBox[{
   SubscriptBox["M", "i"], "/.", 
   RowBox[{"z", "->", 
    RowBox[{"z", "-", 
     RowBox[{
     "\[Omega]", "[", "z", "]"}]}]}]}]], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8740423628027687`*^9, 3.874042399383336*^9}, 
   3.878632366746217*^9},
 CellLabel->
  "In[527]:=",ExpressionUUID->"2873ac7b-b804-4518-8dd3-cdf3ac8079cb"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    SubscriptBox["\[Beta]", "i"], " ", 
    RowBox[{"(", 
     RowBox[{"z", "-", 
      RowBox[{"\[Omega]", "[", "z", "]"}]}], ")"}]}]], " ", 
  RowBox[{
   SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], " ", 
  RowBox[{
   SubscriptBox["M", "*"], "[", "z", "]"}]}]], "Output",
 CellChangeTimes->{{3.8740423712810826`*^9, 3.8740424004021425`*^9}, 
   3.8740618844426885`*^9, 3.875603893213234*^9, 3.875846275754863*^9, 
   3.8783593395613947`*^9, 3.8786306845182877`*^9, 3.8786323677527742`*^9, 
   3.878634717213953*^9, 3.878701570806782*^9, 3.878702465647462*^9, 
   3.878702763693202*^9, 3.878705235925284*^9, 3.8787057466293907`*^9, 
   3.8787141777430487`*^9, 3.87871451705529*^9, 3.878722493194161*^9, 
   3.879493363127734*^9, 3.879493430280766*^9, 3.8794935647283697`*^9, 
   3.879494197547965*^9, 3.879504482007008*^9, 3.880606260803076*^9, 
   3.880606429054811*^9, 3.880686995010406*^9, 3.880687144924362*^9, 
   3.880687318400023*^9, 3.881818597269732*^9, 3.881989566775589*^9, 
   3.881990392539791*^9, 3.881991681949923*^9, 3.883479959598981*^9, 
   3.8836264869759483`*^9, 3.88372555310283*^9, 3.8840762071060753`*^9, 
   3.884076284375432*^9, 3.88407640263485*^9, 3.8840924610941753`*^9, 
   3.884145498655733*^9, 3.885527794672913*^9, 3.8926992777935143`*^9},
 CellLabel->
  "Out[527]=",ExpressionUUID->"cdb90680-2122-46aa-a76f-da05f183a262"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["M", "*"], "[", "z", "]"}]], "Output",
 CellChangeTimes->{{3.8740423712810826`*^9, 3.8740424004021425`*^9}, 
   3.8740618844426885`*^9, 3.875603893213234*^9, 3.875846275754863*^9, 
   3.8783593395613947`*^9, 3.8786306845182877`*^9, 3.8786323677527742`*^9, 
   3.878634717213953*^9, 3.878701570806782*^9, 3.878702465647462*^9, 
   3.878702763693202*^9, 3.878705235925284*^9, 3.8787057466293907`*^9, 
   3.8787141777430487`*^9, 3.87871451705529*^9, 3.878722493194161*^9, 
   3.879493363127734*^9, 3.879493430280766*^9, 3.8794935647283697`*^9, 
   3.879494197547965*^9, 3.879504482007008*^9, 3.880606260803076*^9, 
   3.880606429054811*^9, 3.880686995010406*^9, 3.880687144924362*^9, 
   3.880687318400023*^9, 3.881818597269732*^9, 3.881989566775589*^9, 
   3.881990392539791*^9, 3.881991681949923*^9, 3.883479959598981*^9, 
   3.8836264869759483`*^9, 3.88372555310283*^9, 3.8840762071060753`*^9, 
   3.884076284375432*^9, 3.88407640263485*^9, 3.8840924610941753`*^9, 
   3.884145498655733*^9, 3.885527794672913*^9, 3.892699277801457*^9},
 CellLabel->
  "Out[528]=",ExpressionUUID->"433a90eb-b933-4f29-9b1a-9499e1469f1c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"we", " ", "add", " ", "the", " ", "mutational", " ", "term", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"let", " ", "\[Delta]t"}], "->", 
    RowBox[{"0", " ", 
     RowBox[{"etc", "."}]}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "and", " ", "use", " ", "the", " ", "fact", " ", "that", " ", "it", " ", 
   "is", " ", "also", " ", "a", " ", "linear", " ", "operator", " ", "to", 
   " ", "get", " ", "the", " ", "PDE", " ", "for", " ", "the", " ", 
   "expected", " ", "desntiy", " ", "MGF"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], "\[ScriptCapitalM]"}], "=", 
   RowBox[{
    RowBox[{"\[ScriptCapitalS]", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], "\[ScriptCapitalM]"}]}], "-", 
    RowBox[{"\[Alpha]", " ", "\[ScriptCapitalM]"}], "+", 
    RowBox[{"U", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[ScriptCapitalM]", "[", 
         RowBox[{"z", "-", 
          RowBox[{"\[Omega]", "[", "z", "]"}]}], "]"}], " ", 
        RowBox[{
         SubscriptBox["M", "*"], "[", "z", "]"}]}], "-", " ", 
       RowBox[{"\[ScriptCapitalM]", "[", "z", "]"}]}], ")"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], "\[ScriptCapitalS]"}], "=", 
   RowBox[{"\[Lambda]", "-", " ", 
    RowBox[{"\[Delta]", " ", "\[ScriptCapitalS]"}], "-", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], 
      RowBox[{"\[ScriptCapitalM]", "[", 
       RowBox[{"0", ",", "t"}], "]"}]}], "\[ScriptCapitalS]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"NB", ":", " ", 
  RowBox[{
  "any", " ", "model", " ", "with", " ", "loglinear", " ", "background", " ", 
   "dependence", " ", "in", " ", "mutation", " ", "kernel", " ", "will", " ", 
   "follow", " ", "this", " ", "pde"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NB", ":", " ", 
    RowBox[{
    "non", " ", "epistatic", " ", "models", " ", "simply", " ", "have", " ", 
     RowBox[{"\[Omega]", "[", "z", "]"}]}]}], "=", 
   RowBox[{"0", " ", 
    RowBox[{"(", 
     RowBox[{
     "no", " ", "dependence", " ", "of", " ", "DFE", " ", "on", " ", 
      "background", " ", "fitness"}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"with", " ", 
   RowBox[{"FGM", ":", " ", 
    RowBox[{"\[Omega]", "[", "z", "]"}]}]}], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["z", "2"], " ", "\[Lambda]", " "}], 
     RowBox[{"Vs", "+", 
      RowBox[{"\[Lambda]", " ", "z"}]}]], "\[Implies]", " ", 
    RowBox[{"z", "-", 
     RowBox[{"\[Omega]", "[", "z", "]"}]}]}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"Vs", " ", "z"}], 
     RowBox[{"Vs", "+", 
      RowBox[{"z", " ", "\[Lambda]"}]}]], "\[Element]", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"0", ",", "z"}], "]"}], " ", "for", " ", "z"}], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     "+"]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"so", " ", "we", " ", "can", " ", "always", " ", "compute", " ", 
  "the", " ", "non", " ", "local", " ", "term", " ", "from", " ", "a", " ", 
  "current", " ", "solution", " ", "over", " ", "a", " ", 
  RowBox[{"compact", " ", "[", 
   RowBox[{"0", ",", 
    SubscriptBox["z", "max"]}], "]"}]}], "\[IndentingNewLine]"}], "Text",
 CellChangeTimes->{{3.87404250290195*^9, 3.874042557436186*^9}, {
   3.8740426675664067`*^9, 3.874042689386916*^9}, {3.874042802061654*^9, 
   3.8740428406527762`*^9}, {3.8740493358191414`*^9, 3.87404937231329*^9}, {
   3.8740494264273195`*^9, 3.874049459118342*^9}, 3.8786312135581093`*^9, {
   3.8786323927219763`*^9, 
   3.878632406513811*^9}},ExpressionUUID->"686c335d-c494-4fc9-bda8-\
e99188393c32"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"z", "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", "\[Lambda]", " "}], 
    RowBox[{"Vs", "+", 
     RowBox[{"\[Lambda]", " ", "z"}]}]]}], "//", "fs"}]], "Input",
 CellChangeTimes->{{3.874049364765193*^9, 3.874049367604545*^9}, {
  3.878632380411882*^9, 3.878632381073793*^9}},
 CellLabel->
  "In[529]:=",ExpressionUUID->"c5e8eafd-9767-43b5-9d47-adec388325c8"],

Cell[BoxData[
 FractionBox[
  RowBox[{"Vs", " ", "z"}], 
  RowBox[{"Vs", "+", 
   RowBox[{"z", " ", "\[Lambda]"}]}]]], "Output",
 CellChangeTimes->{{3.874049365454543*^9, 3.874049368109341*^9}, 
   3.874061884473962*^9, 3.875603893262686*^9, 3.875846275787361*^9, 
   3.878359339581614*^9, 3.878630684538624*^9, 3.878632381571665*^9, 
   3.87863471723347*^9, 3.878701570851459*^9, 3.878702465694619*^9, 
   3.878702763717595*^9, 3.878705235956594*^9, 3.878705746655837*^9, 
   3.8787141777754803`*^9, 3.878714517086321*^9, 3.87872249323031*^9, 
   3.879493363153881*^9, 3.879493430302525*^9, 3.879493564751086*^9, 
   3.8794941975777273`*^9, 3.879504482031989*^9, 3.880606260832327*^9, 
   3.880606429089567*^9, 3.8806869950433283`*^9, 3.880687144959597*^9, 
   3.8806873184274263`*^9, 3.881818597291936*^9, 3.881989566806549*^9, 
   3.881990392564341*^9, 3.881991681978147*^9, 3.883479959617276*^9, 
   3.8836264870081587`*^9, 3.8837255531289253`*^9, 3.884076207157525*^9, 
   3.884076284407851*^9, 3.884076402661105*^9, 3.884092461115666*^9, 
   3.88414549867349*^9, 3.8855277946898212`*^9, 3.892699277833647*^9},
 CellLabel->
  "Out[529]=",ExpressionUUID->"9d19de6a-0672-4914-bee0-325afc91e540"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approximate solution of PDE WSSM", "Subsection",
 CellChangeTimes->{{3.8740480294951353`*^9, 
  3.874048037937149*^9}},ExpressionUUID->"9264a52a-716e-4a80-85f2-\
4a29d39ef90d"],

Cell[BoxData[
 RowBox[{"notation", " ", ":", " ", 
  RowBox[{
   RowBox[{"M", "'"}], " ", "for", " ", "derivative", " ", "with", " ", 
   "respect", " ", "to", " ", "z", " ", "and", " ", 
   OverscriptBox["M", "."], " ", "for", " ", "derivative", " ", "with", " ", 
   "respect", " ", "to", " ", "time"}]}]], "Text",
 CellChangeTimes->{{3.874048665980074*^9, 
  3.8740486949857616`*^9}},ExpressionUUID->"9717f3ac-3d74-47d6-9ba7-\
af39f442a23c"],

Cell[CellGroupData[{

Cell["Checks on PDE", "Subsubsection",
 CellChangeTimes->{{3.874048225590539*^9, 
  3.8740482303841815`*^9}},ExpressionUUID->"04289758-c634-4d4b-bf71-\
8b3563de3127"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PDEM", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"\[ScriptCapitalM]", "[", 
      RowBox[{"z", ",", "t"}], "]"}]}], "==", 
    RowBox[{
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], 
       RowBox[{"\[ScriptCapitalM]", "[", 
        RowBox[{"z", ",", "t"}], "]"}]}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Alpha]", "+", "d"}], ")"}], "  ", 
      RowBox[{"\[ScriptCapitalM]", "[", 
       RowBox[{"z", ",", "t"}], "]"}]}], "+", 
     RowBox[{"U", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[ScriptCapitalM]", "[", 
          RowBox[{
           RowBox[{"z", "-", 
            RowBox[{"\[Omega]", "[", "z", "]"}]}], ",", "t"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["M", "*"], "[", "z", "]"}]}], "-", " ", 
        RowBox[{"\[ScriptCapitalM]", "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], ")"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODES", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "==", 
    RowBox[{"b", " ", "-", " ", 
     RowBox[{"d", " ", 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], 
         RowBox[{"\[ScriptCapitalM]", "[", 
          RowBox[{"z", ",", "t"}], "]"}]}], "/.", 
        RowBox[{"z", "->", "0"}]}], ")"}]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.874048046261412*^9, 3.8740481572884827`*^9}, {
   3.8740482009742928`*^9, 3.874048220277453*^9}, 3.8740528745425577`*^9, 
   3.878631213560817*^9, {3.878701564400009*^9, 3.8787015688461943`*^9}, {
   3.878702462862837*^9, 3.878702468810131*^9}, 3.878702740696311*^9, {
   3.878705706242608*^9, 3.878705710489874*^9}, {3.8794934009229794`*^9, 
   3.879493407089534*^9}, 3.87949354543791*^9},
 CellLabel->
  "In[530]:=",ExpressionUUID->"9c0cb20f-7d9f-4cee-b277-f1962c525f37"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"We", " ", "can", " ", "see", " ", "that", " ", 
    RowBox[{"\[ScriptCapitalM]", "[", 
     RowBox[{"0", ",", "t"}], "]"}]}], "=", 
   RowBox[{
    RowBox[{"\[DoubleStruckCapitalE]", "[", 
     RowBox[{
      UnderscriptBox["\[Sum]", "i"], 
      RowBox[{
       SubscriptBox["M", "i"], "[", 
       RowBox[{"0", ",", "t"}], "]"}]}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[DoubleStruckCapitalE]", "[", 
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "]"}], " ", "and", "  ", 
      RowBox[{
       RowBox[{"\[ScriptCapitalM]", "'"}], "[", 
       RowBox[{"0", ",", "t"}], "]"}]}], "=", 
     RowBox[{
      RowBox[{"\[DoubleStruckCapitalE]", "[", 
       RowBox[{
        UnderscriptBox["\[Sum]", "i"], 
        RowBox[{
         RowBox[{
          SubscriptBox["M", "i"], "'"}], "[", 
         RowBox[{"0", ",", "t"}], "]"}]}], "]"}], "=", 
      RowBox[{"\[DoubleStruckCapitalE]", "[", 
       RowBox[{
        RowBox[{
         OverscriptBox["\[Beta]", "_"], "[", "t", "]"}], 
        RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}], "]"}]}]}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"apply", " ", "the", " ", "pde", " ", "at", " ", "z"}], "=", 
  RowBox[{"0", ":", "  ", "\[IndentingNewLine]", 
   RowBox[{
    OverscriptBox["\[ScriptCapitalI]", "."], "\[Equal]", 
    RowBox[{"\[ScriptCapitalI]", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        OverscriptBox["\[Beta]", "_"], " ", 
        RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "-", "\[Alpha]"}], 
      ")"}]}]}]}]}]}], "Text",
 CellChangeTimes->{{3.874048329873659*^9, 3.874048393673685*^9}, 
   3.8740485972080455`*^9, {3.874048654938264*^9, 3.8740486616875925`*^9}, {
   3.8740487042529554`*^9, 3.874048730094378*^9}, {3.8740488089454036`*^9, 
   3.874048820417161*^9}, 
   3.8786312135618763`*^9},ExpressionUUID->"6105d851-6fe3-4501-910b-\
b76a9b891a18"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  SubscriptBox["M", "i"], "/.", 
  RowBox[{"z", "->", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "z"], 
   SubscriptBox["M", "i"]}], "/.", 
  RowBox[{"z", "->", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{"ApplySides", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fs", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "/.", 
           RowBox[{"z", "->", "0"}]}], "/.", 
          RowBox[{
           RowBox[{
            SubscriptBox["M", "*"], "[", "0", "]"}], "->", "1"}]}], "/.", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "->", "0"}]}], "/.", 
        RowBox[{
         RowBox[{"\[ScriptCapitalM]", "[", 
          RowBox[{"0", ",", "t"}], "]"}], "->", "\[ScriptCapitalI]"}]}], "/.",
        " ", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ScriptCapitalM]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"0", ",", "t"}], "]"}], "->", 
        RowBox[{
         OverscriptBox["\[Beta]", "_"], " ", "\[ScriptCapitalI]"}]}]}], "/.", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ScriptCapitalM]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"0", ",", "t"}], "]"}], "->", 
       OverscriptBox["\[ScriptCapitalI]", "."]}]}], "]"}], "&"}], ",", 
   "PDEM"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "==", 
   RowBox[{"(", 
    RowBox[{
     OverscriptBox["\[ScriptCapitalI]", "."], "\[Equal]", 
     RowBox[{"\[ScriptCapitalI]", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         OverscriptBox["\[Beta]", "_"], " ", 
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "-", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", " ", "+", "d"}], ")"}]}], " ", ")"}]}]}], 
    ")"}]}], "//", "fs"}]}], "Input",
 CellChangeTimes->{{3.874048316770651*^9, 3.874048320663814*^9}, {
   3.874048445079824*^9, 3.8740485148337812`*^9}, {3.8740485890925865`*^9, 
   3.87404858927757*^9}, {3.8740486384932156`*^9, 3.8740486519393835`*^9}, {
   3.8740488533764796`*^9, 3.8740488536078005`*^9}, 3.8786312135645113`*^9, 
   3.8787015843522167`*^9, 3.8787027415825987`*^9, {3.879493586051756*^9, 
   3.879493586184198*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"434f2f11-e959-45c1-b7be-e9f30806a68e"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]], "Output",
 CellChangeTimes->{
  3.874048327069415*^9, 3.874048460116353*^9, {3.874048500258026*^9, 
   3.8740485168528333`*^9}, {3.87404858216156*^9, 3.87404859951722*^9}, {
   3.874048648111558*^9, 3.8740486520396585`*^9}, 3.874048853877609*^9, 
   3.8740618845207996`*^9, 3.875603893310162*^9, 3.875846275818228*^9, 
   3.8783593396062717`*^9, 3.8786306845644703`*^9, 3.878632415741366*^9, 
   3.878634717255631*^9, 3.878701591276156*^9, 3.878702474015999*^9, 
   3.878702763742284*^9, 3.8787052359885073`*^9, 3.878705746680588*^9, 
   3.878714177805481*^9, 3.8787145171126633`*^9, 3.8787224932645397`*^9, 
   3.8794933631825743`*^9, 3.879493430325821*^9, {3.8794935647885323`*^9, 
   3.879493587058116*^9}, 3.879494197609055*^9, 3.879504482057873*^9, 
   3.8806062608668633`*^9, 3.880606429132942*^9, 3.8806869951036386`*^9, 
   3.880687144998794*^9, 3.88068731845872*^9, 3.881818597320266*^9, 
   3.881989566840781*^9, 3.881990392590987*^9, 3.881991682004365*^9, 
   3.883479959637971*^9, 3.883626487041803*^9, 3.8837255531590223`*^9, 
   3.8840762072235613`*^9, 3.884076284438352*^9, 3.884076402690116*^9, 
   3.884092461145948*^9, 3.884145498701975*^9, 3.8855277947084837`*^9, 
   3.892699277868308*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"19ea3278-47dc-427c-b4d7-58b8719bd88e"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Beta]", "i"], " ", 
  RowBox[{
   SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{
  3.874048327069415*^9, 3.874048460116353*^9, {3.874048500258026*^9, 
   3.8740485168528333`*^9}, {3.87404858216156*^9, 3.87404859951722*^9}, {
   3.874048648111558*^9, 3.8740486520396585`*^9}, 3.874048853877609*^9, 
   3.8740618845207996`*^9, 3.875603893310162*^9, 3.875846275818228*^9, 
   3.8783593396062717`*^9, 3.8786306845644703`*^9, 3.878632415741366*^9, 
   3.878634717255631*^9, 3.878701591276156*^9, 3.878702474015999*^9, 
   3.878702763742284*^9, 3.8787052359885073`*^9, 3.878705746680588*^9, 
   3.878714177805481*^9, 3.8787145171126633`*^9, 3.8787224932645397`*^9, 
   3.8794933631825743`*^9, 3.879493430325821*^9, {3.8794935647885323`*^9, 
   3.879493587058116*^9}, 3.879494197609055*^9, 3.879504482057873*^9, 
   3.8806062608668633`*^9, 3.880606429132942*^9, 3.8806869951036386`*^9, 
   3.880687144998794*^9, 3.88068731845872*^9, 3.881818597320266*^9, 
   3.881989566840781*^9, 3.881990392590987*^9, 3.881991682004365*^9, 
   3.883479959637971*^9, 3.883626487041803*^9, 3.8837255531590223`*^9, 
   3.8840762072235613`*^9, 3.884076284438352*^9, 3.884076402690116*^9, 
   3.884092461145948*^9, 3.884145498701975*^9, 3.8855277947084837`*^9, 
   3.892699277872238*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"b82c2ae3-7914-4921-9e90-5f17ba4ca35e"],

Cell[BoxData[
 RowBox[{
  OverscriptBox["\[ScriptCapitalI]", "."], "\[Equal]", 
  RowBox[{
   RowBox[{"-", "\[ScriptCapitalI]"}], " ", 
   RowBox[{"(", 
    RowBox[{"d", "+", "\[Alpha]", "-", 
     RowBox[{
      OverscriptBox["\[Beta]", "_"], " ", 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.874048327069415*^9, 3.874048460116353*^9, {3.874048500258026*^9, 
   3.8740485168528333`*^9}, {3.87404858216156*^9, 3.87404859951722*^9}, {
   3.874048648111558*^9, 3.8740486520396585`*^9}, 3.874048853877609*^9, 
   3.8740618845207996`*^9, 3.875603893310162*^9, 3.875846275818228*^9, 
   3.8783593396062717`*^9, 3.8786306845644703`*^9, 3.878632415741366*^9, 
   3.878634717255631*^9, 3.878701591276156*^9, 3.878702474015999*^9, 
   3.878702763742284*^9, 3.8787052359885073`*^9, 3.878705746680588*^9, 
   3.878714177805481*^9, 3.8787145171126633`*^9, 3.8787224932645397`*^9, 
   3.8794933631825743`*^9, 3.879493430325821*^9, {3.8794935647885323`*^9, 
   3.879493587058116*^9}, 3.879494197609055*^9, 3.879504482057873*^9, 
   3.8806062608668633`*^9, 3.880606429132942*^9, 3.8806869951036386`*^9, 
   3.880687144998794*^9, 3.88068731845872*^9, 3.881818597320266*^9, 
   3.881989566840781*^9, 3.881990392590987*^9, 3.881991682004365*^9, 
   3.883479959637971*^9, 3.883626487041803*^9, 3.8837255531590223`*^9, 
   3.8840762072235613`*^9, 3.884076284438352*^9, 3.884076402690116*^9, 
   3.884092461145948*^9, 3.884145498701975*^9, 3.8855277947084837`*^9, 
   3.892699277876156*^9},
 CellLabel->
  "Out[534]=",ExpressionUUID->"51d4a19b-8fa0-4650-9215-0f85757f9b9a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.874048327069415*^9, 3.874048460116353*^9, {3.874048500258026*^9, 
   3.8740485168528333`*^9}, {3.87404858216156*^9, 3.87404859951722*^9}, {
   3.874048648111558*^9, 3.8740486520396585`*^9}, 3.874048853877609*^9, 
   3.8740618845207996`*^9, 3.875603893310162*^9, 3.875846275818228*^9, 
   3.8783593396062717`*^9, 3.8786306845644703`*^9, 3.878632415741366*^9, 
   3.878634717255631*^9, 3.878701591276156*^9, 3.878702474015999*^9, 
   3.878702763742284*^9, 3.8787052359885073`*^9, 3.878705746680588*^9, 
   3.878714177805481*^9, 3.8787145171126633`*^9, 3.8787224932645397`*^9, 
   3.8794933631825743`*^9, 3.879493430325821*^9, {3.8794935647885323`*^9, 
   3.879493587058116*^9}, 3.879494197609055*^9, 3.879504482057873*^9, 
   3.8806062608668633`*^9, 3.880606429132942*^9, 3.8806869951036386`*^9, 
   3.880687144998794*^9, 3.88068731845872*^9, 3.881818597320266*^9, 
   3.881989566840781*^9, 3.881990392590987*^9, 3.881991682004365*^9, 
   3.883479959637971*^9, 3.883626487041803*^9, 3.8837255531590223`*^9, 
   3.8840762072235613`*^9, 3.884076284438352*^9, 3.884076402690116*^9, 
   3.884092461145948*^9, 3.884145498701975*^9, 3.8855277947084837`*^9, 
   3.892699277880756*^9},
 CellLabel->
  "Out[535]=",ExpressionUUID->"ce6b3051-b8a4-4620-bd05-caacd14789e9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"z", ",", "t"}], "]"}], "\[Congruent]", 
   RowBox[{"Log", "[", 
    RowBox[{"\[ScriptCapitalM]", "[", 
     RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "=", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"\[DoubleStruckCapitalE]", "[", 
     RowBox[{"M", "[", 
      RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", "is", " ", "not", 
   " ", "the", " ", "expected", " ", "density", " ", 
   RowBox[{"CGF", ":", " ", 
    RowBox[{"\[DoubleStruckCapitalE]", "[", 
     RowBox[{"Log", "[", 
      RowBox[{"M", "[", 
       RowBox[{"z", ",", "t"}], "]"}], "]"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"in", " ", "the", " ", "deterministic", " ", "context", " ", 
    RowBox[{"(", 
     RowBox[{"\[ScriptCapitalM]", "=", "M"}], ")"}]}], ":", 
   "\[IndentingNewLine]", 
   RowBox[{"Log", " ", 
    FractionBox[
     RowBox[{"M", "[", 
      RowBox[{"z", ",", "t"}], "]"}], 
     RowBox[{"M", "[", 
      RowBox[{"0", ",", "t"}], "]"}]]}]}], "=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalC]", "[", 
    RowBox[{"z", ",", "t"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "K"], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"z", " ", 
         SubscriptBox["\[Beta]", "i"]}]], " ", 
       RowBox[{
        SubscriptBox["p", "i"], "[", "t", "]"}]}]}], "]"}], " ", "the", " ", 
    "true", " ", "cgf", " ", "of", " ", "the", " ", "transmission", " ", 
    "rate", " ", "distribution"}]}]}]}], "Text",
 CellChangeTimes->{{3.8740488722965765`*^9, 3.874048947460842*^9}, {
  3.8740490740587425`*^9, 
  3.874049128522069*^9}},ExpressionUUID->"8e1e90fa-211a-4b03-8934-\
eb0dd19209dc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Log", "[", 
  FractionBox[
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "K"], 
    SubscriptBox["M", "i"]}], 
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], "K"], 
     SubscriptBox["M", "i"]}], "/.", 
    RowBox[{"z", "->", "0"}]}]], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "K"], 
      RowBox[{
       SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}], "->", 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}]}], "/.", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}], "->", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "i"], "[", "t", "]"}], 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}]}]}], "//", 
  "fs"}]}], "Input",
 CellChangeTimes->{{3.8740489495287237`*^9, 3.8740490640737476`*^9}},
 CellLabel->
  "In[536]:=",ExpressionUUID->"9da1fb99-9b47-4b85-9fad-827ad3edf5f8"],

Cell[BoxData[
 RowBox[{"Log", "[", 
  FractionBox[
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "K"], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"z", " ", 
       SubscriptBox["\[Beta]", "i"]}]], " ", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]}], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "K"], 
    RowBox[{
     SubscriptBox["\[ScriptCapitalI]", "i"], "[", "t", "]"}]}]], 
  "]"}]], "Output",
 CellChangeTimes->{{3.874048972063075*^9, 3.8740490643744173`*^9}, 
   3.8740618846744394`*^9, 3.8756038934456663`*^9, 3.875846276022892*^9, 
   3.8783593398728437`*^9, 3.878630684821062*^9, 3.878632463235704*^9, 
   3.878634717279942*^9, 3.87870159506012*^9, 3.878702477034178*^9, 
   3.878702763775195*^9, 3.878705236032238*^9, 3.878705746774547*^9, 
   3.878714177906641*^9, 3.878714517211629*^9, 3.8787224933699703`*^9, 
   3.879493363278111*^9, 3.8794934304593267`*^9, {3.8794935648857927`*^9, 
   3.879493590025762*^9}, 3.879494197746744*^9, 3.8795044820913343`*^9, 
   3.880606261140092*^9, 3.880606429358886*^9, 3.880686995274088*^9, 
   3.880687145180444*^9, 3.8806873186378803`*^9, 3.8818185973615093`*^9, 
   3.881989566884014*^9, 3.881990392623104*^9, 3.881991682039493*^9, 
   3.88347995989085*^9, 3.883626487085394*^9, 3.883725553223353*^9, 
   3.884076207296677*^9, 3.884076284484861*^9, 3.884076402732032*^9, 
   3.884092461308776*^9, 3.884145498864633*^9, 3.885527794968033*^9, 
   3.8926992779887657`*^9},
 CellLabel->
  "Out[536]=",ExpressionUUID->"08d9de18-cd53-42bb-bf80-1cf21e933b77"],

Cell[BoxData[
 RowBox[{"Log", "[", 
  FractionBox[
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "K"], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"z", " ", 
       SubscriptBox["\[Beta]", "i"]}]], " ", 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
     RowBox[{
      SubscriptBox["p", "i"], "[", "t", "]"}]}]}], 
   RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]], "]"}]], "Output",
 CellChangeTimes->{{3.874048972063075*^9, 3.8740490643744173`*^9}, 
   3.8740618846744394`*^9, 3.8756038934456663`*^9, 3.875846276022892*^9, 
   3.8783593398728437`*^9, 3.878630684821062*^9, 3.878632463235704*^9, 
   3.878634717279942*^9, 3.87870159506012*^9, 3.878702477034178*^9, 
   3.878702763775195*^9, 3.878705236032238*^9, 3.878705746774547*^9, 
   3.878714177906641*^9, 3.878714517211629*^9, 3.8787224933699703`*^9, 
   3.879493363278111*^9, 3.8794934304593267`*^9, {3.8794935648857927`*^9, 
   3.879493590025762*^9}, 3.879494197746744*^9, 3.8795044820913343`*^9, 
   3.880606261140092*^9, 3.880606429358886*^9, 3.880686995274088*^9, 
   3.880687145180444*^9, 3.8806873186378803`*^9, 3.8818185973615093`*^9, 
   3.881989566884014*^9, 3.881990392623104*^9, 3.881991682039493*^9, 
   3.88347995989085*^9, 3.883626487085394*^9, 3.883725553223353*^9, 
   3.884076207296677*^9, 3.884076284484861*^9, 3.884076402732032*^9, 
   3.884092461308776*^9, 3.884145498864633*^9, 3.885527794968033*^9, 
   3.8926992781218233`*^9},
 CellLabel->
  "Out[537]=",ExpressionUUID->"f1bd32c3-cefd-4caa-a392-d2fd499207ba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linearization in small \[Lambda]", "Subsubsection",
 CellChangeTimes->{{3.87404917836981*^9, 
  3.8740491902037926`*^9}},ExpressionUUID->"7106f68b-bf17-4836-87cb-\
a72a63fb7df9"],

Cell[BoxData[{
 RowBox[{"Let", " ", "us", " ", "assume", " ", "a", " ", "small", " ", 
  "\[Lambda]", " ", "approximation", " ", 
  RowBox[{"(", 
   RowBox[{"weak", " ", "selection"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", " ", "0"}], ":", " ", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ScriptCapitalM]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"z", ",", "t"}], "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Alpha]"}], " ", 
     RowBox[{"\[ScriptCapitalM]", "[", 
      RowBox[{"z", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[ScriptCapitalM]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"z", ",", "t"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"This", " ", "is", " ", "the", " ", "response", " ", "from", " ", 
  "purely", " ", "standing", " ", "variance", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"same", " ", "result", " ", "by", " ", "setting", " ", "U"}], "=",
     "0"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"This", " ", "is", " ", "because", " ", "we", " ", "either", " ", 
  "set", " ", "not", " ", "mutations", " ", "or", " ", "mutations", " ", 
  "that", " ", "are", " ", "neutral", " ", "to", " ", "phenotype"}]}], "Text",
 CellChangeTimes->{{3.874049636655815*^9, 3.8740496939426727`*^9}, {
   3.8740497334487824`*^9, 3.874049753793585*^9}, 
   3.8786312135711927`*^9},ExpressionUUID->"b54f382e-6948-4e2c-8a8a-\
da3a8672593c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FGM", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "*"], "->", 
      RowBox[{"Function", "[", 
       RowBox[{"z", ",", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
            SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
            SubscriptBox["\[Beta]", "max"]}], 
           RowBox[{" ", 
            RowBox[{"Vs", "+", 
             RowBox[{"z", " ", "\[Lambda]"}]}]}]]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox[
             RowBox[{"z", " ", "\[Lambda]"}], "Vs"]}], ")"}], 
          RowBox[{
           RowBox[{"-", "n"}], "/", "2"}]]}]}], "]"}]}], ",", 
     RowBox[{"\[Omega]", "->", 
      RowBox[{"Function", "[", 
       RowBox[{"z", ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["z", "2"], " ", "\[Lambda]", " "}], 
         RowBox[{"Vs", "+", 
          RowBox[{"\[Lambda]", " ", "z"}]}]]}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PDEMFGM", "=", 
  RowBox[{"ApplySides", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fs", "[", 
      RowBox[{"#", "/.", "FGM"}], "]"}], "&"}], ",", "PDEM"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ApplySides", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], 
    "&"}], ",", "PDEMFGM"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplySides", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fs", "[", 
     RowBox[{"#", "/.", 
      RowBox[{"U", "->", "0"}]}], "]"}], "&"}], ",", "PDEMFGM"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.874049199432604*^9, 3.874049208715557*^9}, {
  3.8740492473757296`*^9, 3.8740493151300373`*^9}, {3.87404947062394*^9, 
  3.8740494856868296`*^9}, {3.8740495164783134`*^9, 3.8740495296068797`*^9}, {
  3.8740496045199413`*^9, 3.8740496328799686`*^9}, {3.8740496766928015`*^9, 
  3.8740497267979765`*^9}, {3.874049880646844*^9, 3.8740498904032354`*^9}, {
  3.8786324701920147`*^9, 3.8786324815855227`*^9}},
 CellLabel->
  "In[538]:=",ExpressionUUID->"5e30a1bd-9ff3-4b41-a4a1-83c051df2e0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ScriptCapitalM]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"z", ",", "t"}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "+", "U", "+", "\[Alpha]"}], ")"}], " ", 
      RowBox[{"\[ScriptCapitalM]", "[", 
       RowBox[{"z", ",", "t"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
       SubscriptBox["\[Beta]", "max"]}], 
      RowBox[{"Vs", "+", 
       RowBox[{"z", " ", "\[Lambda]"}]}]]], " ", "U", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"z", " ", "\[Lambda]"}], "Vs"]}], ")"}], 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], " ", 
    RowBox[{"\[ScriptCapitalM]", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"Vs", " ", "z"}], 
       RowBox[{"Vs", "+", 
        RowBox[{"z", " ", "\[Lambda]"}]}]], ",", "t"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[ScriptCapitalM]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"z", ",", "t"}], "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.878632509924858*^9, 3.878632710864932*^9, 3.878634717466975*^9, 
   3.8787015996347523`*^9, 3.87870247851283*^9, 3.8787027641162987`*^9, 
   3.878705236388134*^9, 3.878705746976445*^9, 3.8787141781164007`*^9, 
   3.8787145174229383`*^9, 3.878722493587173*^9, 3.879493363474635*^9, 
   3.879493430668819*^9, {3.879493565080289*^9, 3.879493592120591*^9}, 
   3.879494198075417*^9, 3.879504482287546*^9, 3.880606262199525*^9, 
   3.880606429822851*^9, 3.8806869956952143`*^9, 3.8806871455486526`*^9, 
   3.880687319017755*^9, 3.881818597553851*^9, 3.881989567126636*^9, 
   3.881990392833043*^9, 3.881991682254855*^9, 3.8834799602818813`*^9, 
   3.883626487286511*^9, 3.8837255534423447`*^9, 3.884076207618643*^9, 
   3.884076284706326*^9, 3.88407640295076*^9, 3.8840924617082253`*^9, 
   3.8841454992723017`*^9, 3.885527795276271*^9, 3.892699278329814*^9},
 CellLabel->
  "Out[539]=",ExpressionUUID->"052bd708-9fda-43c2-bc14-878fd8e0ccb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ScriptCapitalM]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"z", ",", "t"}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "d"}], " ", 
    RowBox[{"\[ScriptCapitalM]", "[", 
     RowBox[{"z", ",", "t"}], "]"}]}], "-", 
   RowBox[{"\[Alpha]", " ", 
    RowBox[{"\[ScriptCapitalM]", "[", 
     RowBox[{"z", ",", "t"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[ScriptCapitalM]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"z", ",", "t"}], "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.878632509924858*^9, 3.878632710864932*^9, 3.878634717466975*^9, 
   3.8787015996347523`*^9, 3.87870247851283*^9, 3.8787027641162987`*^9, 
   3.878705236388134*^9, 3.878705746976445*^9, 3.8787141781164007`*^9, 
   3.8787145174229383`*^9, 3.878722493587173*^9, 3.879493363474635*^9, 
   3.879493430668819*^9, {3.879493565080289*^9, 3.879493592120591*^9}, 
   3.879494198075417*^9, 3.879504482287546*^9, 3.880606262199525*^9, 
   3.880606429822851*^9, 3.8806869956952143`*^9, 3.8806871455486526`*^9, 
   3.880687319017755*^9, 3.881818597553851*^9, 3.881989567126636*^9, 
   3.881990392833043*^9, 3.881991682254855*^9, 3.8834799602818813`*^9, 
   3.883626487286511*^9, 3.8837255534423447`*^9, 3.884076207618643*^9, 
   3.884076284706326*^9, 3.88407640295076*^9, 3.8840924617082253`*^9, 
   3.8841454992723017`*^9, 3.885527795276271*^9, 3.892699278333879*^9},
 CellLabel->
  "Out[540]=",ExpressionUUID->"6d81ac95-0ed6-47b0-b0cf-3d7d5801663b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ScriptCapitalM]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"z", ",", "t"}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
      RowBox[{"\[ScriptCapitalM]", "[", 
       RowBox[{"z", ",", "t"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[ScriptCapitalM]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"z", ",", "t"}], "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.878632509924858*^9, 3.878632710864932*^9, 3.878634717466975*^9, 
   3.8787015996347523`*^9, 3.87870247851283*^9, 3.8787027641162987`*^9, 
   3.878705236388134*^9, 3.878705746976445*^9, 3.8787141781164007`*^9, 
   3.8787145174229383`*^9, 3.878722493587173*^9, 3.879493363474635*^9, 
   3.879493430668819*^9, {3.879493565080289*^9, 3.879493592120591*^9}, 
   3.879494198075417*^9, 3.879504482287546*^9, 3.880606262199525*^9, 
   3.880606429822851*^9, 3.8806869956952143`*^9, 3.8806871455486526`*^9, 
   3.880687319017755*^9, 3.881818597553851*^9, 3.881989567126636*^9, 
   3.881990392833043*^9, 3.881991682254855*^9, 3.8834799602818813`*^9, 
   3.883626487286511*^9, 3.8837255534423447`*^9, 3.884076207618643*^9, 
   3.884076284706326*^9, 3.88407640295076*^9, 3.8840924617082253`*^9, 
   3.8841454992723017`*^9, 3.885527795276271*^9, 3.892699278337607*^9},
 CellLabel->
  "Out[541]=",ExpressionUUID->"55ff6223-d9c8-442b-916c-31c18bcff4a0"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"order", " ", "1"}], ":", " ", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ScriptCapitalM]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"z", ",", "t"}], "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "z"}], " ", "\[Theta]", " ", 
        SuperscriptBox["\[Mu]", "2"]}], "-", "\[Alpha]", "+", 
       RowBox[{
        SuperscriptBox["z", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        SubscriptBox["\[Beta]", "max"]}]}], ")"}], " ", 
     RowBox[{"\[ScriptCapitalM]", "[", 
      RowBox[{"z", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["z", "2"]}], " ", 
        SuperscriptBox["\[Mu]", "2"]}], "+", 
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\[ScriptCapitalM]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"z", ",", "t"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"This", " ", "is", " ", "the", " ", "WSSM", " ", "approx", " ", "to",
   " ", "the", " ", "model"}]}], "Text",
 CellChangeTimes->{
  3.8740511527668066`*^9, {3.874051296019235*^9, 3.8740513045064907`*^9}, 
   3.8786312135902367`*^9},ExpressionUUID->"8a5ca272-f12f-4250-b3cf-\
4600a6d2c504"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ApplySides", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fs", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
     "]"}], "&"}], ",", "PDEMFGM"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ft", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Mu]", "==", 
       SqrtBox[
        RowBox[{"U", " ", "\[Lambda]"}]]}], ",", 
      RowBox[{"\[Theta]", "==", 
       FractionBox["n", "2"]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"U", ",", "n"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PDEMWSSM", "=", 
  RowBox[{"ApplySides", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fs", "[", 
      RowBox[{"#", "/.", "%"}], "]"}], "&"}], ",", "%%"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8740498983680973`*^9, 3.8740499721673403`*^9}, {
   3.874050015220191*^9, 3.8740501279692097`*^9}, {3.874051169915477*^9, 
   3.8740512108278866`*^9}, {3.8740513082562466`*^9, 
   3.8740513113480043`*^9}, {3.8787016278088923`*^9, 
   3.8787016288393393`*^9}, {3.878701743876384*^9, 3.8787017977289658`*^9}, {
   3.8787020487952023`*^9, 3.878702062241653*^9}, 3.878702788719492*^9, 
   3.878705723625609*^9},
 CellLabel->
  "In[542]:=",ExpressionUUID->"5d55e6b7-f2d5-42b2-9542-e894e3b2b71f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ScriptCapitalM]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"z", ",", "t"}], "]"}], "\[Equal]", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
         RowBox[{"n", " ", "U", " ", "z", " ", "\[Lambda]"}], "-", 
         RowBox[{"2", " ", "U", " ", 
          SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
          SubscriptBox["\[Beta]", "max"]}]}], ")"}], " ", 
       RowBox[{"\[ScriptCapitalM]", "[", 
        RowBox[{"z", ",", "t"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "U"}], " ", 
        SuperscriptBox["z", "2"], " ", "\[Lambda]"}], "+", 
       RowBox[{"Vs", " ", 
        RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\[ScriptCapitalM]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"z", ",", "t"}], "]"}]}]}], 
   RowBox[{"2", " ", "Vs"}]]}]], "Output",
 CellChangeTimes->{
  3.87863256150148*^9, 3.878634717554571*^9, 3.878701629681147*^9, {
   3.878701772280506*^9, 3.878701798327086*^9}, 3.878702063135312*^9, 
   3.878702479704672*^9, {3.8787027642915792`*^9, 3.8787027952151003`*^9}, 
   3.878705236570883*^9, 3.8787057470385427`*^9, 3.8787141781883593`*^9, 
   3.878714517496846*^9, 3.878722493664751*^9, 3.879493363532896*^9, 
   3.879493430776559*^9, 3.879493565174149*^9, 3.8794935953076077`*^9, 
   3.879494198161812*^9, 3.8795044824861383`*^9, 3.8806062624242373`*^9, 
   3.880606430033993*^9, 3.880686995815755*^9, 3.8806871456718273`*^9, 
   3.880687319135399*^9, 3.881818597644876*^9, 3.8819895672247066`*^9, 
   3.88199039291717*^9, 3.881991682349074*^9, 3.8834799603929873`*^9, 
   3.8836264873817387`*^9, 3.883725553531808*^9, 3.884076207746872*^9, 
   3.884076284802534*^9, 3.8840764030474653`*^9, 3.88409246182895*^9, 
   3.884145499416478*^9, 3.885527795351437*^9, 3.892699278414714*^9},
 CellLabel->
  "Out[542]=",ExpressionUUID->"40d9a3b9-2a43-400a-8c50-635e5d48b42c"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "nongen", 
   "\"Solutions may not be valid for all values of parameters.\"", 2, 543, 
   121, 33860057889096928252, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8786325615051823`*^9, 3.878634717558079*^9, 3.878701629684915*^9, {
   3.8787017722848787`*^9, 3.878701798343898*^9}, 3.878702063138888*^9, 
   3.8787024797088833`*^9, {3.878702764296009*^9, 3.878702795220233*^9}, 
   3.878705236575795*^9, 3.878705747043083*^9, 3.878714178194824*^9, 
   3.878714517503496*^9, 3.878722493672217*^9, 3.879493363537094*^9, 
   3.879493430779088*^9, 3.879493565177318*^9, 3.8794935953113623`*^9, 
   3.879494198206986*^9, 3.879504482491529*^9, 3.8806062626019373`*^9, 
   3.880606430102687*^9, 3.880686995884832*^9, 3.880687145731127*^9, 
   3.8806873191939707`*^9, 3.8818185976474733`*^9, 3.881989567229158*^9, 
   3.881990392921344*^9, 3.881991682354754*^9, 3.883479960445429*^9, 
   3.883626487473012*^9, 3.8837255535355263`*^9, 3.884076207753488*^9, 
   3.884076284809222*^9, 3.884076403053503*^9, 3.8840924618726597`*^9, 
   3.88414549946078*^9, 3.885527795513336*^9, 3.892699278461177*^9},
 CellLabel->
  "Lors de l\[CloseCurlyQuote]\[EAcute]valuation de \
In[542]:=",ExpressionUUID->"9a4b7c7b-7405-418d-bf0e-9f74f602c328"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"U", "\[Rule]", 
    FractionBox[
     SuperscriptBox["\[Mu]", "2"], "\[Lambda]"]}], ",", 
   RowBox[{"n", "\[Rule]", 
    RowBox[{"2", " ", "\[Theta]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.87863256150148*^9, 3.878634717554571*^9, 3.878701629681147*^9, {
   3.878701772280506*^9, 3.878701798327086*^9}, 3.878702063135312*^9, 
   3.878702479704672*^9, {3.8787027642915792`*^9, 3.8787027952151003`*^9}, 
   3.878705236570883*^9, 3.8787057470385427`*^9, 3.8787141781883593`*^9, 
   3.878714517496846*^9, 3.878722493664751*^9, 3.879493363532896*^9, 
   3.879493430776559*^9, 3.879493565174149*^9, 3.8794935953076077`*^9, 
   3.879494198161812*^9, 3.8795044824861383`*^9, 3.8806062624242373`*^9, 
   3.880606430033993*^9, 3.880686995815755*^9, 3.8806871456718273`*^9, 
   3.880687319135399*^9, 3.881818597644876*^9, 3.8819895672247066`*^9, 
   3.88199039291717*^9, 3.881991682349074*^9, 3.8834799603929873`*^9, 
   3.8836264873817387`*^9, 3.883725553531808*^9, 3.884076207746872*^9, 
   3.884076284802534*^9, 3.8840764030474653`*^9, 3.88409246182895*^9, 
   3.884145499416478*^9, 3.885527795351437*^9, 3.892699278469038*^9},
 CellLabel->
  "Out[543]=",ExpressionUUID->"eec2072c-b4d0-4d4d-9914-cc49e7ff4aaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ScriptCapitalM]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"z", ",", "t"}], "]"}], "\[Equal]", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
         RowBox[{"z", " ", "\[Theta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["z", "2"], " ", 
          SuperscriptBox["\[Mu]", "2"], " ", 
          SubscriptBox["\[Beta]", "max"]}]}], ")"}], " ", 
       RowBox[{"\[ScriptCapitalM]", "[", 
        RowBox[{"z", ",", "t"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["z", "2"]}], " ", 
        SuperscriptBox["\[Mu]", "2"]}], "+", 
       RowBox[{"Vs", " ", 
        RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\[ScriptCapitalM]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"z", ",", "t"}], "]"}]}]}], "Vs"]}]], "Output",
 CellChangeTimes->{
  3.87863256150148*^9, 3.878634717554571*^9, 3.878701629681147*^9, {
   3.878701772280506*^9, 3.878701798327086*^9}, 3.878702063135312*^9, 
   3.878702479704672*^9, {3.8787027642915792`*^9, 3.8787027952151003`*^9}, 
   3.878705236570883*^9, 3.8787057470385427`*^9, 3.8787141781883593`*^9, 
   3.878714517496846*^9, 3.878722493664751*^9, 3.879493363532896*^9, 
   3.879493430776559*^9, 3.879493565174149*^9, 3.8794935953076077`*^9, 
   3.879494198161812*^9, 3.8795044824861383`*^9, 3.8806062624242373`*^9, 
   3.880606430033993*^9, 3.880686995815755*^9, 3.8806871456718273`*^9, 
   3.880687319135399*^9, 3.881818597644876*^9, 3.8819895672247066`*^9, 
   3.88199039291717*^9, 3.881991682349074*^9, 3.8834799603929873`*^9, 
   3.8836264873817387`*^9, 3.883725553531808*^9, 3.884076207746872*^9, 
   3.884076284802534*^9, 3.8840764030474653`*^9, 3.88409246182895*^9, 
   3.884145499416478*^9, 3.885527795351437*^9, 3.892699278529972*^9},
 CellLabel->
  "Out[544]=",ExpressionUUID->"3cca5d3c-fe06-4866-a849-a0719c32829e"]
}, Open  ]],

Cell["We can directly solve the model with fixed \[ScriptCapitalS]", "Text",
 CellChangeTimes->{{3.8740515230594373`*^9, 3.8740515253154235`*^9}, {
  3.874051825568016*^9, 
  3.874051839506025*^9}},ExpressionUUID->"cd82113d-094c-4f4f-a842-\
6b4a957957c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PDEMWSSM", ",", 
       RowBox[{
        RowBox[{"\[ScriptCapitalM]", "[", 
         RowBox[{"z", ",", "0"}], "]"}], "==", 
        RowBox[{"\[ScriptCapitalM]o", "[", "z", "]"}]}]}], "}"}], "/.", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "->", 
      "\[ScriptCapitalS]"}]}], ",", "\[ScriptCapitalM]", ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "t"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.874051393137776*^9, 3.8740514575737157`*^9}, 
   3.8740515983456306`*^9, {3.874051834188122*^9, 3.8740518352468605`*^9}, 
   3.8786326989504147`*^9},
 CellLabel->
  "In[545]:=",ExpressionUUID->"46e02418-65a1-4405-898a-e719f60fcecb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derive the gaussian trait  ansatz", "Subsubsection",
 CellChangeTimes->{{3.8740518427223806`*^9, 3.8740518551658125`*^9}, {
  3.8740527910540857`*^9, 
  3.8740527985735693`*^9}},ExpressionUUID->"f2755017-3190-481d-aa45-\
b4872dd0772e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", 
    StyleBox["g",
     FontWeight->"Bold"], "]"}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Beta]", "max"], "-", 
     RowBox[{
      FractionBox[
       SuperscriptBox["\[ScriptG]", "2"], "2"], " ", "where", " ", 
      "\[ScriptG]"}]}], "=", 
    RowBox[{"|", 
     StyleBox["g",
      FontWeight->"Bold"], "|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"assume", " ", "that", " ", "g"}], "\[Distributed]", 
      RowBox[{"\[ScriptCapitalN]", "[", 
       RowBox[{
        RowBox[{
         StyleBox[
          OverscriptBox["g", "_"],
          FontWeight->"Bold"], "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", "t", "]"}], 
         SubscriptBox[
          StyleBox["\[DoubleStruckCapitalI]",
           FontWeight->"Bold"], "n"]}]}], "]"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "introduce", " ", "the", " ", "deviation", " ", "from", " ", "the", " ", 
    RowBox[{"mean", ":", "\[IndentingNewLine]", 
     StyleBox["g",
      FontWeight->"Bold"]}]}], "=", 
   RowBox[{
    RowBox[{
     StyleBox[
      OverscriptBox["g", "_"],
      FontWeight->"Bold"], "+", 
     RowBox[{
      StyleBox["dg",
       FontWeight->"Bold"], " ", "where", " ", 
      StyleBox["dg",
       FontWeight->"Bold"]}]}], "\[Distributed]", 
    RowBox[{"\[ScriptCapitalN]", "[", 
     RowBox[{
      StyleBox["0",
       FontWeight->"Bold"], ",", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], 
       SubscriptBox[
        StyleBox["\[DoubleStruckCapitalI]",
         FontWeight->"Bold"], "n"]}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"look", " ", "at", " ", "d\[Beta]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     StyleBox["g",
      FontWeight->"Bold"], "]"}], "-", 
    RowBox[{"\[Beta]", "[", 
     OverscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "_"], "]"}]}], ":", " ", 
   RowBox[{
   "fitness", " ", "difference", " ", "between", " ", "a", " ", "random", " ",
     "guy", " ", "and", " ", "the", " ", "mean", " ", 
    "guy"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Beta]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]", "[", 
      RowBox[{
       OverscriptBox["g", "_"], "+", "dg"}], "]"}], "-", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       OverscriptBox["g", "_"], "]"}], " ", "where", " ", 
      StyleBox["dg",
       FontWeight->"Bold"]}]}], "\[Distributed]", 
    RowBox[{"\[ScriptCapitalN]", "[", 
     RowBox[{
      StyleBox["0",
       FontWeight->"Bold"], ",", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], 
       SubscriptBox[
        StyleBox["\[DoubleStruckCapitalI]",
         FontWeight->"Bold"], "n"]}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
  "THIS", " ", "IS", " ", "EXACTLY", " ", "THE", " ", "SAME", " ", "AS", " ", 
   "THE", " ", "DFE", " ", "AROUND", " ", "A", " ", "BACKGROUND", " ", 
   RowBox[{
    OverscriptBox["g", "_"], "[", "t", "]"}], " ", "with", " ", "a", " ", 
   "pheno", " ", "varianc", " ", 
   RowBox[{"\[Sigma]", "[", "t", "]"}]}],
  FontWeight->"Bold",
  Background->RGBColor[1, 0.5, 0]]}], "Text",
 CellChangeTimes->{{3.874051862536924*^9, 3.8740520238851995`*^9}, {
  3.874052103115448*^9, 
  3.8740522364076886`*^9}},ExpressionUUID->"d8d8b9c7-f04d-4d03-a903-\
07973271ff6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Let", " ", "us", " ", "set", " ", 
   RowBox[{
    SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], "=", 
  RowBox[{
   RowBox[{"\[Beta]", "[", 
    OverscriptBox["g", "_"], "]"}], " ", "the", " ", "fitness", " ", "of", 
   " ", "the", " ", "mean", " ", "genotype"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "we", " ", "can", " ", "use", " ", "our", " ", "result", " ", "with", " ", 
   "DFE", " ", "replacing", " ", "\[Lambda]"}], "->", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]", "[", "t", "]"}], " ", "and", " ", 
    SubscriptBox["\[Beta]", "i"]}], "->", 
   RowBox[{
    SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"we", " ", "have"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CurlyPhi]", "[", 
   RowBox[{"z", ",", "t"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalE]", "d\[Beta]"], "[", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"d\[Beta]", " ", "z"}]], "]"}], "=", 
   RowBox[{
    SubscriptBox["M", 
     RowBox[{"\[Sigma]", "[", "t", "]"}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[Omega]", 
        RowBox[{"\[Sigma]", "[", "t", "]"}]]}], 
      RowBox[{
       SubscriptBox["\[Beta]", "m"], "[", "t", 
       "]"}]}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "with", " ", "the", " ", "same", " ", "functional", " ", "coefs", " ", 
    RowBox[{"(", 
     RowBox[{
     "set", " ", "by", " ", "a", " ", "given", " ", "gaussian", " ", 
      "variance", " ", "\[Lambda]"}], ")"}]}], ":", " ", 
   RowBox[{
    RowBox[{
     SubscriptBox["M", "\[Lambda]"], "[", "z", "]"}], "\[Congruent]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{
        SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
        SubscriptBox["\[Beta]", "max"]}], 
       RowBox[{" ", 
        RowBox[{"Vs", "+", 
         RowBox[{"z", " ", "\[Lambda]"}]}]}]]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"z", " ", "\[Lambda]"}], 
         RowBox[{" ", "Vs"}]]}], ")"}], 
      RowBox[{
       RowBox[{"-", "n"}], "/", "2"}]], "  ", "and", "  ", 
     RowBox[{
      SubscriptBox["\[Omega]", "\[Lambda]"], "[", "z", "]"}]}], 
    "\[Congruent]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["z", "2"], " ", "\[Lambda]", " "}], 
     RowBox[{"Vs", "+", 
      RowBox[{"\[Lambda]", " ", "z"}]}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"we", " ", 
    RowBox[{"get", ":", " ", 
     RowBox[{"\[CurlyPhi]", "[", 
      RowBox[{"z", ",", "t"}], "]"}]}]}], "=", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["z", "2"], " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Beta]", "max"], "-", 
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"z", " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"z", " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"we", " ", "want", " ", 
    RowBox[{"\[ScriptCapitalM]", "[", 
     RowBox[{"z", ",", "t"}], "]"}]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], 
     RowBox[{
      SubscriptBox["\[DoubleStruckCapitalE]", "\[Beta]"], "[", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[Beta]", " ", "z"}]], "]"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], 
      RowBox[{
       SubscriptBox["\[DoubleStruckCapitalE]", "d\[Beta]"], "[", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d\[Beta]", "+", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], " ", 
         "z"}]], "]"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], " ", "z"}]], 
       RowBox[{
        SubscriptBox["\[DoubleStruckCapitalE]", "d\[Beta]"], "[", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"d\[Beta]", " ", "z"}]], "]"}]}], "=", 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], " ", "z"}]], 
       RowBox[{"\[CurlyPhi]", "[", 
        RowBox[{"z", ",", "t"}], "]"}]}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"we", " ", "get", " ", "the", " ", 
   RowBox[{"ansatz", ":", "\[IndentingNewLine]", 
    RowBox[{"\[ScriptCapitalM]", "[", 
     RowBox[{"z", ",", "t"}], "]"}]}]}], "=", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"z", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"z", " ", 
         SubscriptBox["\[Beta]", "max"], " ", 
         RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], 
     RowBox[{"1", "+", 
      RowBox[{"z", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]], " ", 
   RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"z", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], 
    RowBox[{
     RowBox[{"-", "n"}], "/", "2"}]]}]}]}], "Text",
 CellChangeTimes->{{3.8740520551037474`*^9, 3.8740520709441833`*^9}, {
  3.8740522561388197`*^9, 3.8740523065408087`*^9}, {3.8740523446167126`*^9, 
  3.8740523914549274`*^9}, {3.8740524425057983`*^9, 3.8740525576355557`*^9}, {
  3.8740525978696184`*^9, 3.874052719379114*^9}, {3.878632607775758*^9, 
  3.878632617107283*^9}},ExpressionUUID->"fa5c246d-3628-4d59-8390-\
a554714346da"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["M", "*"], "[", "z", "]"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Omega]", "[", "z", "]"}]}], 
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]]}], "/.", "FGM"}], "/.", 
   RowBox[{"\[Lambda]", "->", 
    RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], "//", 
  "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], " ", "z"}]], "%"}], "//",
   "fs"}], "\[IndentingNewLine]", 
 RowBox[{"ansatz", "=", 
  RowBox[{"\[ScriptCapitalM]", "->", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", "t"}], "}"}], ",", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", " ", 
            SubscriptBox["\[Beta]", "max"], " ", 
            RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
           RowBox[{"Vs", " ", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
        RowBox[{"Vs", "+", 
         RowBox[{"z", " ", 
          RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]], " ", 
      RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"z", " ", 
           RowBox[{"\[Sigma]", "[", "t", "]"}]}], 
          RowBox[{" ", "Vs"}]]}], ")"}], 
       RowBox[{
        RowBox[{"-", "n"}], "/", "2"}]]}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.874052394638257*^9, 3.8740524245338945`*^9}, {
  3.8740526718613787`*^9, 3.8740526738662786`*^9}, {3.874052704597234*^9, 
  3.874052764252803*^9}, {3.878632668359911*^9, 3.878632675253858*^9}, {
  3.8786391872004967`*^9, 3.87863919277952*^9}},
 CellLabel->
  "In[546]:=",ExpressionUUID->"3059c2db-08ba-487d-9b39-f6f6379e55bf"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Beta]", "max"], "-", 
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], 
    RowBox[{"Vs", "+", 
     RowBox[{"z", " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"z", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], ")"}], 
   RowBox[{
    RowBox[{"-", "n"}], "/", "2"}]]}]], "Output",
 CellChangeTimes->{{3.874052396287775*^9, 3.8740524252412558`*^9}, 
   3.8740525230500836`*^9, {3.8740526741426315`*^9, 3.874052684119645*^9}, 
   3.874052715219659*^9, {3.874052762742599*^9, 3.8740527649112816`*^9}, 
   3.8740528867478304`*^9, 3.874061930522709*^9, 3.8756038944618464`*^9, 
   3.875846276903036*^9, 3.875939093865934*^9, 3.878359340658175*^9, 
   3.87863068560679*^9, {3.8786326537325573`*^9, 3.87863267587503*^9}, 
   3.8786327147501698`*^9, 3.878634717795642*^9, {3.878639179955866*^9, 
   3.8786391929979963`*^9}, 3.878701817994047*^9, 3.8787020714145737`*^9, 
   3.87870248730494*^9, 3.878702764876754*^9, 3.878702795525896*^9, 
   3.8787052369429092`*^9, 3.8787057473072157`*^9, 3.878714178456415*^9, 
   3.87871451776155*^9, 3.878722493936713*^9, 3.879493363804779*^9, 
   3.8794934312523518`*^9, 3.879493565472678*^9, 3.879493600454884*^9, 
   3.879494198617412*^9, 3.8795044829162188`*^9, 3.880606263204731*^9, 
   3.880606430579698*^9, 3.880686996511055*^9, 3.8806871461808567`*^9, 
   3.880687319644329*^9, 3.881818597932856*^9, 3.881989567584503*^9, 
   3.8819903932052383`*^9, 3.8819916826690617`*^9, 3.883479960929666*^9, 
   3.883626487847251*^9, 3.883725553825844*^9, 3.884076208088806*^9, 
   3.884076285093886*^9, 3.8840764033536787`*^9, 3.8840924623391743`*^9, 
   3.884145499908886*^9, 3.885527796028801*^9, 3.8926992789884987`*^9},
 CellLabel->
  "Out[546]=",ExpressionUUID->"de87f8ff-f105-4c06-89fe-fb511087bf5d"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{"z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", " ", 
        SubscriptBox["\[Beta]", "max"], " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
       RowBox[{"Vs", " ", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
    RowBox[{"Vs", "+", 
     RowBox[{"z", " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]], " ", 
  RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"z", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], ")"}], 
   RowBox[{
    RowBox[{"-", "n"}], "/", "2"}]]}]], "Output",
 CellChangeTimes->{{3.874052396287775*^9, 3.8740524252412558`*^9}, 
   3.8740525230500836`*^9, {3.8740526741426315`*^9, 3.874052684119645*^9}, 
   3.874052715219659*^9, {3.874052762742599*^9, 3.8740527649112816`*^9}, 
   3.8740528867478304`*^9, 3.874061930522709*^9, 3.8756038944618464`*^9, 
   3.875846276903036*^9, 3.875939093865934*^9, 3.878359340658175*^9, 
   3.87863068560679*^9, {3.8786326537325573`*^9, 3.87863267587503*^9}, 
   3.8786327147501698`*^9, 3.878634717795642*^9, {3.878639179955866*^9, 
   3.8786391929979963`*^9}, 3.878701817994047*^9, 3.8787020714145737`*^9, 
   3.87870248730494*^9, 3.878702764876754*^9, 3.878702795525896*^9, 
   3.8787052369429092`*^9, 3.8787057473072157`*^9, 3.878714178456415*^9, 
   3.87871451776155*^9, 3.878722493936713*^9, 3.879493363804779*^9, 
   3.8794934312523518`*^9, 3.879493565472678*^9, 3.879493600454884*^9, 
   3.879494198617412*^9, 3.8795044829162188`*^9, 3.880606263204731*^9, 
   3.880606430579698*^9, 3.880686996511055*^9, 3.8806871461808567`*^9, 
   3.880687319644329*^9, 3.881818597932856*^9, 3.881989567584503*^9, 
   3.8819903932052383`*^9, 3.8819916826690617`*^9, 3.883479960929666*^9, 
   3.883626487847251*^9, 3.883725553825844*^9, 3.884076208088806*^9, 
   3.884076285093886*^9, 3.8840764033536787`*^9, 3.8840924623391743`*^9, 
   3.884145499908886*^9, 3.885527796028801*^9, 3.892699279025915*^9},
 CellLabel->
  "Out[547]=",ExpressionUUID->"c01f5434-bb19-4fce-9a08-306e941b42da"],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalM]", "\[Rule]", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"z", ",", "t"}], "}"}], ",", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", " ", 
           SubscriptBox["\[Beta]", "max"], " ", 
           RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
          RowBox[{"Vs", " ", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
       RowBox[{"Vs", "+", 
        RowBox[{"z", " ", 
         RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]], " ", 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"z", " ", 
          RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], ")"}], 
      RowBox[{"-", 
       FractionBox["n", "2"]}]]}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.874052396287775*^9, 3.8740524252412558`*^9}, 
   3.8740525230500836`*^9, {3.8740526741426315`*^9, 3.874052684119645*^9}, 
   3.874052715219659*^9, {3.874052762742599*^9, 3.8740527649112816`*^9}, 
   3.8740528867478304`*^9, 3.874061930522709*^9, 3.8756038944618464`*^9, 
   3.875846276903036*^9, 3.875939093865934*^9, 3.878359340658175*^9, 
   3.87863068560679*^9, {3.8786326537325573`*^9, 3.87863267587503*^9}, 
   3.8786327147501698`*^9, 3.878634717795642*^9, {3.878639179955866*^9, 
   3.8786391929979963`*^9}, 3.878701817994047*^9, 3.8787020714145737`*^9, 
   3.87870248730494*^9, 3.878702764876754*^9, 3.878702795525896*^9, 
   3.8787052369429092`*^9, 3.8787057473072157`*^9, 3.878714178456415*^9, 
   3.87871451776155*^9, 3.878722493936713*^9, 3.879493363804779*^9, 
   3.8794934312523518`*^9, 3.879493565472678*^9, 3.879493600454884*^9, 
   3.879494198617412*^9, 3.8795044829162188`*^9, 3.880606263204731*^9, 
   3.880606430579698*^9, 3.880686996511055*^9, 3.8806871461808567`*^9, 
   3.880687319644329*^9, 3.881818597932856*^9, 3.881989567584503*^9, 
   3.8819903932052383`*^9, 3.8819916826690617`*^9, 3.883479960929666*^9, 
   3.883626487847251*^9, 3.883725553825844*^9, 3.884076208088806*^9, 
   3.884076285093886*^9, 3.8840764033536787`*^9, 3.8840924623391743`*^9, 
   3.884145499908886*^9, 3.885527796028801*^9, 3.89269927902956*^9},
 CellLabel->
  "Out[548]=",ExpressionUUID->"04e8563d-efe4-458f-8108-d64f5e7e98ec"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Input the ansatz into the linearized PDE + ODE system", "Subsubsection",
 CellChangeTimes->{{3.8740528020988054`*^9, 
  3.8740528166229153`*^9}},ExpressionUUID->"a4f88e61-8359-45e5-a41e-\
87d1acb10aa5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ansatz", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptCapitalM]", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"z", ",", "t"}], "}"}], ",", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", " ", 
               SubscriptBox["\[Beta]", "max"], " ", 
               RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
              RowBox[{"Vs", " ", 
               RowBox[{
                SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
           RowBox[{"Vs", "+", 
            RowBox[{"z", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]], " ", 
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox[
             RowBox[{"z", " ", 
              RowBox[{"\[Sigma]", "[", "t", "]"}]}], 
             RowBox[{" ", "Vs"}]]}], ")"}], 
          RowBox[{"-", "\[Theta]"}]]}]}], "]"}]}], ",", 
     RowBox[{"\[Kappa]", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"z", ",", "t"}], "}"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"\[ScriptCapitalM]", "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Kappa]", "[", 
     RowBox[{"z", ",", "t"}], "]"}], "//.", "ansatz"}], "//", "po"}], "//", 
  "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"\[Kappa]", "[", 
      RowBox[{"z", ",", "t"}], "]"}]}], "//.", "ansatz"}], "//", "po"}], "//",
   "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], 
      RowBox[{"\[Kappa]", "[", 
       RowBox[{"z", ",", "t"}], "]"}]}], "/.", 
     RowBox[{"z", "->", "0"}]}], "//.", "ansatz"}], "//", "po"}], "//", 
  "fs"}]}], "Input",
 CellChangeTimes->{{3.8740531504921865`*^9, 3.874053196540292*^9}, {
  3.8740542750076494`*^9, 3.8740542751356707`*^9}, {3.87560387458878*^9, 
  3.875603889989562*^9}, {3.8786327449727383`*^9, 3.878632750533947*^9}, {
  3.87863912458075*^9, 3.878639162121036*^9}, {3.878639203018008*^9, 
  3.8786392032983103`*^9}},
 CellLabel->
  "In[549]:=",ExpressionUUID->"56506afa-f659-4e1f-9ac2-48f11eae557e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Log", "[", 
   RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "]"}], "-", 
  RowBox[{"\[Theta]", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"z", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"z", " ", 
       SubscriptBox["\[Beta]", "max"], " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
      RowBox[{"Vs", " ", 
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
   RowBox[{"Vs", "+", 
    RowBox[{"z", " ", 
     RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.874053178826519*^9, 3.874053197231984*^9}, 
   3.8740542764401517`*^9, 3.874061944850876*^9, {3.875603894649205*^9, 
   3.875603899318486*^9}, 3.875846277044725*^9, 3.875939095925725*^9, 
   3.8783593407751503`*^9, 3.878630685720786*^9, 3.878633763942267*^9, 
   3.878634717947501*^9, {3.878639138632977*^9, 3.878639155457407*^9}, 
   3.8786392049808607`*^9, 3.878701822571849*^9, 3.8787020721333714`*^9, 
   3.8787024887952747`*^9, 3.878702765021482*^9, 3.878702795669465*^9, 
   3.878705237083621*^9, 3.878705747448024*^9, 3.878714178606607*^9, 
   3.878714517910659*^9, 3.878722494090754*^9, 3.879493363945015*^9, 
   3.879493431390922*^9, 3.8794935656264763`*^9, 3.8794936020693417`*^9, 
   3.879494198752982*^9, 3.8795044830847883`*^9, 3.8806062634988832`*^9, 
   3.880606430769682*^9, 3.8806869966860733`*^9, 3.88068714634785*^9, 
   3.880687319816093*^9, 3.8818185980795183`*^9, 3.881989567803998*^9, 
   3.8819903933570957`*^9, 3.881991682827263*^9, 3.883479961063332*^9, 
   3.883626488170293*^9, 3.883725553965106*^9, 3.884076208250523*^9, 
   3.884076285247615*^9, 3.8840764035533123`*^9, 3.88409246248969*^9, 
   3.8841455000592337`*^9, 3.885527796164699*^9, 3.892699279135954*^9},
 CellLabel->
  "Out[550]=",ExpressionUUID->"2d658c2d-50d2-4f9c-8ce9-f9266f4c6868"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ScriptCapitalI]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], 
   RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]], "+", 
  FractionBox[
   RowBox[{"z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Vs", " ", "\[Theta]"}], "-", 
           RowBox[{"Vs", " ", "z", " ", 
            SubscriptBox["\[Beta]", "max"]}], "+", 
           RowBox[{"z", " ", "\[Theta]", " ", 
            RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
           RowBox[{"Vs", " ", "z", " ", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"Vs", " ", 
       RowBox[{"(", 
        RowBox[{"Vs", "+", 
         RowBox[{"z", " ", 
          RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Beta]", "m"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"Vs", "+", 
      RowBox[{"z", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{{3.874053178826519*^9, 3.874053197231984*^9}, 
   3.8740542764401517`*^9, 3.874061944850876*^9, {3.875603894649205*^9, 
   3.875603899318486*^9}, 3.875846277044725*^9, 3.875939095925725*^9, 
   3.8783593407751503`*^9, 3.878630685720786*^9, 3.878633763942267*^9, 
   3.878634717947501*^9, {3.878639138632977*^9, 3.878639155457407*^9}, 
   3.8786392049808607`*^9, 3.878701822571849*^9, 3.8787020721333714`*^9, 
   3.8787024887952747`*^9, 3.878702765021482*^9, 3.878702795669465*^9, 
   3.878705237083621*^9, 3.878705747448024*^9, 3.878714178606607*^9, 
   3.878714517910659*^9, 3.878722494090754*^9, 3.879493363945015*^9, 
   3.879493431390922*^9, 3.8794935656264763`*^9, 3.8794936020693417`*^9, 
   3.879494198752982*^9, 3.8795044830847883`*^9, 3.8806062634988832`*^9, 
   3.880606430769682*^9, 3.8806869966860733`*^9, 3.88068714634785*^9, 
   3.880687319816093*^9, 3.8818185980795183`*^9, 3.881989567803998*^9, 
   3.8819903933570957`*^9, 3.881991682827263*^9, 3.883479961063332*^9, 
   3.883626488170293*^9, 3.883725553965106*^9, 3.884076208250523*^9, 
   3.884076285247615*^9, 3.8840764035533123`*^9, 3.88409246248969*^9, 
   3.8841455000592337`*^9, 3.885527796164699*^9, 3.892699279370201*^9},
 CellLabel->
  "Out[551]=",ExpressionUUID->"17a90759-4966-4aea-b013-55b19e7f4325"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[Theta]", " ", 
     RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], "+", 
  RowBox[{
   SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{{3.874053178826519*^9, 3.874053197231984*^9}, 
   3.8740542764401517`*^9, 3.874061944850876*^9, {3.875603894649205*^9, 
   3.875603899318486*^9}, 3.875846277044725*^9, 3.875939095925725*^9, 
   3.8783593407751503`*^9, 3.878630685720786*^9, 3.878633763942267*^9, 
   3.878634717947501*^9, {3.878639138632977*^9, 3.878639155457407*^9}, 
   3.8786392049808607`*^9, 3.878701822571849*^9, 3.8787020721333714`*^9, 
   3.8787024887952747`*^9, 3.878702765021482*^9, 3.878702795669465*^9, 
   3.878705237083621*^9, 3.878705747448024*^9, 3.878714178606607*^9, 
   3.878714517910659*^9, 3.878722494090754*^9, 3.879493363945015*^9, 
   3.879493431390922*^9, 3.8794935656264763`*^9, 3.8794936020693417`*^9, 
   3.879494198752982*^9, 3.8795044830847883`*^9, 3.8806062634988832`*^9, 
   3.880606430769682*^9, 3.8806869966860733`*^9, 3.88068714634785*^9, 
   3.880687319816093*^9, 3.8818185980795183`*^9, 3.881989567803998*^9, 
   3.8819903933570957`*^9, 3.881991682827263*^9, 3.883479961063332*^9, 
   3.883626488170293*^9, 3.883725553965106*^9, 3.884076208250523*^9, 
   3.884076285247615*^9, 3.8840764035533123`*^9, 3.88409246248969*^9, 
   3.8841455000592337`*^9, 3.885527796164699*^9, 3.892699279391427*^9},
 CellLabel->
  "Out[552]=",ExpressionUUID->"a07826ae-381c-4e34-b733-df889c7deb8b"]
}, Open  ]],

Cell["Set z = 0 in the ODE + PDE  gives two ODEs for \[ScriptCapitalI] and \
\[ScriptCapitalS]", "Text",
 CellChangeTimes->{{3.8740536546637187`*^9, 
  3.8740536861544957`*^9}},ExpressionUUID->"07613745-f280-4490-ad00-\
53cdad5741eb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"WSSM", "=", 
  RowBox[{"ft", "[", 
   RowBox[{"{", 
    RowBox[{"ODES", ",", "PDEMWSSM"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"WSSMansatz", "=", 
  RowBox[{"ApplySides", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fs", "[", 
      RowBox[{"#", "/.", "ansatz"}], "]"}], "&"}], ",", "WSSM"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SIode", "=", 
  RowBox[{"ApplySides", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fs", "[", 
      RowBox[{"#", "/.", 
       RowBox[{"z", "->", "0"}]}], "]"}], "&"}], ",", "WSSMansatz"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SIsol", "=", 
  RowBox[{
   RowBox[{"ft", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{"SIode", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ScriptCapitalS]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], ",", 
        RowBox[{
         SuperscriptBox["\[ScriptCapitalI]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "}"}]}], "]"}], "]"}], 
   "//", "fs"}]}]}], "Input",
 CellChangeTimes->{{3.874052820712846*^9, 3.874052854568411*^9}, {
  3.8740528985147123`*^9, 3.8740529891443853`*^9}, {3.8740538894294815`*^9, 
  3.874053922949*^9}, {3.875846306434952*^9, 3.875846327290327*^9}, {
  3.875846638222933*^9, 3.875846639737562*^9}},
 CellLabel->
  "In[553]:=",ExpressionUUID->"8d00c582-1016-45f1-8b8b-845aaaf742b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalS]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{"b", "-", 
     RowBox[{"d", " ", 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[ScriptCapitalM]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"0", ",", "t"}], "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalM]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"z", ",", "t"}], "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Vs", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
           RowBox[{"z", " ", "\[Theta]", " ", 
            SuperscriptBox["\[Mu]", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["z", "2"], " ", 
            SuperscriptBox["\[Mu]", "2"], " ", 
            SubscriptBox["\[Beta]", "max"]}]}], ")"}], " ", 
         RowBox[{"\[ScriptCapitalM]", "[", 
          RowBox[{"z", ",", "t"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["z", "2"]}], " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"Vs", " ", 
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[ScriptCapitalM]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"z", ",", "t"}], "]"}]}]}], "Vs"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.878633769336173*^9, 3.8786347182009163`*^9, 3.878639207436142*^9, 
   3.87870183087643*^9, 3.8787020733996687`*^9, 3.878702490043467*^9, 
   3.878702765268835*^9, 3.878702795941998*^9, {3.8787052125248137`*^9, 
   3.878705237348311*^9}, 3.878705747702895*^9, 3.8787141788685217`*^9, 
   3.878714518173224*^9, 3.878722494355248*^9, 3.87949336421427*^9, 
   3.879493431647655*^9, 3.879493565904417*^9, 3.879493604280189*^9, 
   3.879494199013473*^9, 3.8795044834236298`*^9, 3.880606263968985*^9, 
   3.880606431190576*^9, 3.8806869969738493`*^9, 3.8806871466572733`*^9, 
   3.8806873200901537`*^9, 3.881818598353828*^9, 3.8819895680940332`*^9, 
   3.8819903937209044`*^9, 3.881991683099926*^9, 3.883479961310637*^9, 
   3.8836264885578012`*^9, 3.883725554276649*^9, 3.8840762085151653`*^9, 
   3.884076285603516*^9, 3.8840764038131123`*^9, 3.884092462757184*^9, 
   3.8841455003521967`*^9, 3.885527796410431*^9, 3.892699279413904*^9},
 CellLabel->
  "Out[553]=",ExpressionUUID->"70177d91-a0f9-4eee-a96a-f31d9d25afc5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalS]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{"b", "+", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"], "-", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
       ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Vs", "+", 
         RowBox[{"z", " ", 
          RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], "2"]], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", " ", 
            SubscriptBox["\[Beta]", "max"], " ", 
            RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
           RowBox[{"Vs", " ", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
        RowBox[{"Vs", "+", 
         RowBox[{"z", " ", 
          RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"z", " ", 
           RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], ")"}], 
       RowBox[{"-", "\[Theta]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Vs", "+", 
            RowBox[{"z", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], "2"], " ", 
         RowBox[{
          SuperscriptBox["\[ScriptCapitalI]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"z", " ", 
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Vs", " ", "\[Theta]"}], "-", 
                RowBox[{"Vs", " ", "z", " ", 
                 SubscriptBox["\[Beta]", "max"]}], "+", 
                RowBox[{"z", " ", "\[Theta]", " ", 
                 RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
                RowBox[{"Vs", " ", "z", " ", 
                 RowBox[{
                  SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}], 
              " ", 
              RowBox[{
               SuperscriptBox["\[Sigma]", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
           RowBox[{"Vs", " ", 
            RowBox[{"(", 
             RowBox[{"Vs", "+", 
              RowBox[{"z", " ", 
               RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], " ", 
            RowBox[{
             SuperscriptBox[
              SubscriptBox["\[Beta]", "m"], "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], "\[Equal]", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Vs", "+", 
          RowBox[{"z", " ", 
           RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], "2"]], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"z", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"z", " ", 
             SubscriptBox["\[Beta]", "max"], " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
            RowBox[{"Vs", " ", 
             RowBox[{
              SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
         RowBox[{"Vs", "+", 
          RowBox[{"z", " ", 
           RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]]], " ", 
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"z", " ", 
            RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], ")"}], 
        RowBox[{"-", "\[Theta]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Vs", "+", 
            RowBox[{"z", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Vs", " ", 
             RowBox[{"(", 
              RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
            RowBox[{"z", " ", "\[Theta]", " ", 
             SuperscriptBox["\[Mu]", "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", " ", 
                RowBox[{"(", 
                 RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
               RowBox[{"\[Theta]", " ", 
                RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}]}], "-", 
         RowBox[{"z", " ", 
          SubscriptBox["\[Beta]", "max"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Vs", " ", "z", " ", 
             SuperscriptBox["\[Mu]", "2"]}], "+", 
            RowBox[{
             RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Vs"}], "+", 
               RowBox[{"z", " ", 
                RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"Vs", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["z", "2"], " ", 
             SuperscriptBox["\[Mu]", "2"]}], "-", 
            RowBox[{"Vs", " ", 
             RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
          RowBox[{
           SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}]}]}]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.878633769336173*^9, 3.8786347182009163`*^9, 3.878639207436142*^9, 
   3.87870183087643*^9, 3.8787020733996687`*^9, 3.878702490043467*^9, 
   3.878702765268835*^9, 3.878702795941998*^9, {3.8787052125248137`*^9, 
   3.878705237348311*^9}, 3.878705747702895*^9, 3.8787141788685217`*^9, 
   3.878714518173224*^9, 3.878722494355248*^9, 3.87949336421427*^9, 
   3.879493431647655*^9, 3.879493565904417*^9, 3.879493604280189*^9, 
   3.879494199013473*^9, 3.8795044834236298`*^9, 3.880606263968985*^9, 
   3.880606431190576*^9, 3.8806869969738493`*^9, 3.8806871466572733`*^9, 
   3.8806873200901537`*^9, 3.881818598353828*^9, 3.8819895680940332`*^9, 
   3.8819903937209044`*^9, 3.881991683099926*^9, 3.883479961310637*^9, 
   3.8836264885578012`*^9, 3.883725554276649*^9, 3.8840762085151653`*^9, 
   3.884076285603516*^9, 3.8840764038131123`*^9, 3.884092462757184*^9, 
   3.8841455003521967`*^9, 3.885527796410431*^9, 3.892699280162902*^9},
 CellLabel->
  "Out[554]=",ExpressionUUID->"c04093f0-3abc-49ef-8b22-06edad8d4a86"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalS]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{"b", "+", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"], "-", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
       ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalI]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
            RowBox[{"Vs", " ", 
             RowBox[{
              SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
        ")"}]}], "Vs"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.878633769336173*^9, 3.8786347182009163`*^9, 3.878639207436142*^9, 
   3.87870183087643*^9, 3.8787020733996687`*^9, 3.878702490043467*^9, 
   3.878702765268835*^9, 3.878702795941998*^9, {3.8787052125248137`*^9, 
   3.878705237348311*^9}, 3.878705747702895*^9, 3.8787141788685217`*^9, 
   3.878714518173224*^9, 3.878722494355248*^9, 3.87949336421427*^9, 
   3.879493431647655*^9, 3.879493565904417*^9, 3.879493604280189*^9, 
   3.879494199013473*^9, 3.8795044834236298`*^9, 3.880606263968985*^9, 
   3.880606431190576*^9, 3.8806869969738493`*^9, 3.8806871466572733`*^9, 
   3.8806873200901537`*^9, 3.881818598353828*^9, 3.8819895680940332`*^9, 
   3.8819903937209044`*^9, 3.881991683099926*^9, 3.883479961310637*^9, 
   3.8836264885578012`*^9, 3.883725554276649*^9, 3.8840762085151653`*^9, 
   3.884076285603516*^9, 3.8840764038131123`*^9, 3.884092462757184*^9, 
   3.8841455003521967`*^9, 3.885527796410431*^9, 3.8926992801927757`*^9},
 CellLabel->
  "Out[555]=",ExpressionUUID->"f0616d43-12eb-49eb-92b4-f4ac92f436da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalS]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{"b", "+", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"], "-", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
       ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalI]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
            RowBox[{"Vs", " ", 
             RowBox[{
              SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
        ")"}]}], "Vs"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.878633769336173*^9, 3.8786347182009163`*^9, 3.878639207436142*^9, 
   3.87870183087643*^9, 3.8787020733996687`*^9, 3.878702490043467*^9, 
   3.878702765268835*^9, 3.878702795941998*^9, {3.8787052125248137`*^9, 
   3.878705237348311*^9}, 3.878705747702895*^9, 3.8787141788685217`*^9, 
   3.878714518173224*^9, 3.878722494355248*^9, 3.87949336421427*^9, 
   3.879493431647655*^9, 3.879493565904417*^9, 3.879493604280189*^9, 
   3.879494199013473*^9, 3.8795044834236298`*^9, 3.880606263968985*^9, 
   3.880606431190576*^9, 3.8806869969738493`*^9, 3.8806871466572733`*^9, 
   3.8806873200901537`*^9, 3.881818598353828*^9, 3.8819895680940332`*^9, 
   3.8819903937209044`*^9, 3.881991683099926*^9, 3.883479961310637*^9, 
   3.8836264885578012`*^9, 3.883725554276649*^9, 3.8840762085151653`*^9, 
   3.884076285603516*^9, 3.8840764038131123`*^9, 3.884092462757184*^9, 
   3.8841455003521967`*^9, 3.885527796410431*^9, 3.8926992802126703`*^9},
 CellLabel->
  "Out[556]=",ExpressionUUID->"f692ef3e-d226-4911-8db9-4c77dc246c5b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "introduce", " ", "the", " ", "density", " ", "CGF", " ", "\[Kappa]"}], " ",
   "=", " ", 
  RowBox[{
  "log", " ", "\[ScriptCapitalM]", "  ", "and", " ", "compute", " ", "its", 
   " ", "PDE", " ", 
   RowBox[{"(", 
    RowBox[{"linearized", " ", "version"}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{
  "input", " ", "the", " ", "equivalent", " ", "ansatz", " ", "for", " ", 
   "\[Kappa]", " ", "into", " ", "that", " ", "pde"}], " ", "+", " ", 
  RowBox[{"replace", "  ", 
   FractionBox[
    RowBox[{
     RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}], 
    RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]], " ", "by", " ", "its", " ",
    "expression", " ", "from", " ", "above", " ", "ODE", " ", "for", " ", 
   RowBox[{
    RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}]}]}]}], "Text",
 CellChangeTimes->{{3.8740540239703407`*^9, 
  3.874054052276278*^9}},ExpressionUUID->"f80e0c04-f427-41a3-822c-\
5869d4ec17f1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", "t", "]"}], ">", "0"}], "&&", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "<", 
     SubscriptBox["\[Beta]", "max"]}], "&&", 
    RowBox[{"n", ">=", "1"}], "&&", 
    RowBox[{"\[Mu]", ">", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"PDE\[Kappa]", "=", 
  RowBox[{"ApplySides", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fs", "[", 
      RowBox[{
       FractionBox["#", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Kappa]", "[", 
          RowBox[{"z", ",", "t"}], "]"}]]], "/.", 
       RowBox[{"\[ScriptCapitalM]", "->", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "t"}], "}"}], ",", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[Kappa]", "[", 
            RowBox[{"z", ",", "t"}], "]"}]]}], "]"}]}]}], "]"}], "&"}], ",", 
    "PDEMWSSM"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eq", "=", 
  RowBox[{"ApplySides", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", "Vs", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Vs", "+", 
             RowBox[{"z", " ", 
              RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], "2"], "#"}], "//.",
          "ansatz"}], "/.", "SIsol"}], ",", "rules"}], "]"}], "&"}], ",", 
    "PDE\[Kappa]"}], "]"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "apply", " ", "the", " ", "ansatz", " ", "on", " ", "the", " ", 
    "linearized", " ", "density", " ", "CGF", " ", "equation"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.874053974903236*^9, 3.874053992394595*^9}, {
  3.8740541634471507`*^9, 3.8740541843887634`*^9}, {3.87863381773411*^9, 
  3.878633818995532*^9}, {3.878633899853756*^9, 3.8786339001004972`*^9}, {
  3.878639219008039*^9, 3.878639223128036*^9}},
 CellLabel->
  "In[557]:=",ExpressionUUID->"193554d6-c6aa-4692-ab58-c49f8dc578b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Kappa]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"z", ",", "t"}], "]"}], "\[Equal]", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "Vs"}], " ", 
     RowBox[{"(", 
      RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "-", 
    RowBox[{"z", " ", "\[Theta]", " ", 
     SuperscriptBox["\[Mu]", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     SuperscriptBox["\[Mu]", "2"], " ", 
     SubscriptBox["\[Beta]", "max"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["z", "2"]}], " ", 
        SuperscriptBox["\[Mu]", "2"]}], "+", 
       RowBox[{"Vs", " ", 
        RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\[Kappa]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"z", ",", "t"}], "]"}]}]}], "Vs"]}]], "Output",
 CellChangeTimes->{{3.878633802183279*^9, 3.878633819891265*^9}, 
   3.878633900734201*^9, 3.878634718719385*^9, {3.878639213179969*^9, 
   3.8786392236088543`*^9}, 3.878701838911536*^9, 3.87870207566255*^9, 
   3.878702493836285*^9, 3.8787027661236277`*^9, 3.878702796886846*^9, 
   3.878705238144298*^9, 3.878705748335492*^9, 3.878714179515635*^9, 
   3.878714518826778*^9, 3.878722495011623*^9, 3.879493364903565*^9, 
   3.879493432780786*^9, 3.879493566720771*^9, 3.879493615246635*^9, 
   3.879494199835146*^9, 3.879504484429091*^9, 3.880606265340754*^9, 
   3.8806064323770123`*^9, 3.880686997972905*^9, 3.880687147538946*^9, 
   3.8806873210354767`*^9, 3.8818185991413507`*^9, 3.8819895690959663`*^9, 
   3.88199039453837*^9, 3.881991683921921*^9, 3.883479962118649*^9, 
   3.8836264894752693`*^9, 3.883725555060904*^9, 3.884076209311729*^9, 
   3.884076286395091*^9, 3.884092463677106*^9, 3.8841455013192587`*^9, 
   3.885527797269989*^9, 3.892699280316997*^9},
 CellLabel->
  "Out[558]=",ExpressionUUID->"fa371533-3cfb-44e6-ba78-7287ed2fa5ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["z", "2"], " ", "\[Theta]", " ", 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "t", "]"}], "3"]}], "+", 
     RowBox[{"Vs", " ", "z", " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"z", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Theta]"}], "-", 
           RowBox[{"z", " ", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["Vs", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Vs"}], " ", 
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], "+", 
        RowBox[{"z", " ", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "-", 
           RowBox[{"z", " ", 
            SubscriptBox["\[Beta]", "max"]}], "+", 
           RowBox[{"z", " ", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"Vs", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "\[Alpha]", "-", 
           RowBox[{"z", " ", 
            RowBox[{
             SuperscriptBox[
              SubscriptBox["\[Beta]", "m"], "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{"Vs", " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Vs", " ", 
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "-", 
           RowBox[{"2", " ", "z", " ", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Vs", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
           RowBox[{"z", " ", "\[Theta]", " ", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "-", 
           RowBox[{"Vs", " ", "z", " ", 
            RowBox[{
             SuperscriptBox[
              SubscriptBox["\[Beta]", "m"], "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", "2"}], " ", "Vs", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Vs", "+", 
        RowBox[{"z", " ", 
         RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Vs", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
        RowBox[{"z", " ", "\[Theta]", " ", 
         SuperscriptBox["\[Mu]", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
           RowBox[{"\[Theta]", " ", 
            RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
         RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}]}], "-", 
     RowBox[{"z", " ", 
      SubscriptBox["\[Beta]", "max"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Vs", " ", "z", " ", 
         SuperscriptBox["\[Mu]", "2"]}], "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Vs"}], "+", 
           RowBox[{"z", " ", 
            RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"Vs", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["z", "2"], " ", 
         SuperscriptBox["\[Mu]", "2"]}], "-", 
        RowBox[{"Vs", " ", 
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.878633802183279*^9, 3.878633819891265*^9}, 
   3.878633900734201*^9, 3.878634718719385*^9, {3.878639213179969*^9, 
   3.8786392236088543`*^9}, 3.878701838911536*^9, 3.87870207566255*^9, 
   3.878702493836285*^9, 3.8787027661236277`*^9, 3.878702796886846*^9, 
   3.878705238144298*^9, 3.878705748335492*^9, 3.878714179515635*^9, 
   3.878714518826778*^9, 3.878722495011623*^9, 3.879493364903565*^9, 
   3.879493432780786*^9, 3.879493566720771*^9, 3.879493615246635*^9, 
   3.879494199835146*^9, 3.879504484429091*^9, 3.880606265340754*^9, 
   3.8806064323770123`*^9, 3.880686997972905*^9, 3.880687147538946*^9, 
   3.8806873210354767`*^9, 3.8818185991413507`*^9, 3.8819895690959663`*^9, 
   3.88199039453837*^9, 3.881991683921921*^9, 3.883479962118649*^9, 
   3.8836264894752693`*^9, 3.883725555060904*^9, 3.884076209311729*^9, 
   3.884076286395091*^9, 3.884092463677106*^9, 3.8841455013192587`*^9, 
   3.885527797269989*^9, 3.8926992810660973`*^9},
 CellLabel->
  "Out[559]=",ExpressionUUID->"78e689f1-2bc0-4a16-a75d-2d11a63e563a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "The", " ", "two", " ", "sides", " ", "are", " ", "both", " ", 
   "polynomials", " ", "in", " ", "z", "  ", "of", " ", "order", " ", "2"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"\[Implies]", 
  RowBox[{
  "we", " ", "need", " ", "to", " ", "equate", " ", "the", " ", "coefs", " ", 
   "and", " ", "the", " ", "ansatz", " ", "will", " ", "tbe", " ", "the", " ", 
   RowBox[{"(", "unique", ")"}], " ", "solution", " ", "of", " ", "the", " ", 
   "linearized", " ", "pde"}]}]}], "Text",
 CellChangeTimes->{{3.874054299956706*^9, 3.874054299959379*^9}, {
  3.8740544115144434`*^9, 
  3.8740544445239706`*^9}},ExpressionUUID->"7297e812-ea47-4941-8bc6-\
5a9b32dbcbb3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"PolynomialQ", "[", 
     RowBox[{
      RowBox[{"eq", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], ",", 
    RowBox[{"PolynomialQ", "[", 
     RowBox[{
      RowBox[{"eq", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}]}], "}"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "that", " ", "both", " ", "sides", " ", "are", " ", 
    "polynomials", " ", "in", " ", "z"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Exponent", "[", 
     RowBox[{
      RowBox[{"eq", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], ",", 
    RowBox[{"Exponent", "[", 
     RowBox[{
      RowBox[{"eq", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}]}], "}"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "that", " ", "both", " ", "sides", " ", "are", " ", 
    "polynomials", " ", "in", " ", "z"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.874054077516549*^9, 3.874054118787196*^9}, {
  3.878701990362721*^9, 3.878701996684683*^9}, {3.8787020800744677`*^9, 
  3.8787020803331327`*^9}},
 CellLabel->
  "In[560]:=",ExpressionUUID->"09d2a5dc-f3b5-496d-b24e-a7e8b946cd58"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8740540716972957`*^9, 3.874054119670977*^9, 3.8740542881409984`*^9, 
   3.8740544495467896`*^9, 3.8740619458276963`*^9, 3.875603896360104*^9, 
   3.875846278163229*^9, 3.8783593419376*^9, 3.878630686722567*^9, 
   3.878633911275567*^9, 3.878634719238448*^9, 3.878639226329318*^9, 
   3.8787018432106457`*^9, 3.878701996992264*^9, {3.878702076817239*^9, 
   3.878702082056168*^9}, 3.87870249603393*^9, 3.878702766908997*^9, 
   3.8787027976401987`*^9, 3.8787052388748417`*^9, 3.878705748835425*^9, 
   3.8787141800325727`*^9, 3.878714519340356*^9, 3.8787224955274076`*^9, 
   3.879493365427601*^9, 3.879493434026325*^9, 3.879493567469657*^9, 
   3.879493617906691*^9, 3.879494200571526*^9, 3.879504485126191*^9, 
   3.880606266550584*^9, 3.8806064334619703`*^9, 3.8806869988375387`*^9, 
   3.88068714832132*^9, 3.880687321828005*^9, 3.881818599860334*^9, 
   3.881989569954135*^9, 3.881990395320848*^9, 3.881991684656402*^9, 
   3.883479962811451*^9, 3.8836264903831472`*^9, 3.883725555785104*^9, 
   3.884076210041925*^9, 3.8840762871412573`*^9, 3.8840924644604073`*^9, 
   3.88414550220083*^9, 3.885527798001169*^9, 3.892699281095942*^9},
 CellLabel->
  "Out[560]=",ExpressionUUID->"a520917b-c8e1-4a30-8e85-9bfc05528f7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8740540716972957`*^9, 3.874054119670977*^9, 3.8740542881409984`*^9, 
   3.8740544495467896`*^9, 3.8740619458276963`*^9, 3.875603896360104*^9, 
   3.875846278163229*^9, 3.8783593419376*^9, 3.878630686722567*^9, 
   3.878633911275567*^9, 3.878634719238448*^9, 3.878639226329318*^9, 
   3.8787018432106457`*^9, 3.878701996992264*^9, {3.878702076817239*^9, 
   3.878702082056168*^9}, 3.87870249603393*^9, 3.878702766908997*^9, 
   3.8787027976401987`*^9, 3.8787052388748417`*^9, 3.878705748835425*^9, 
   3.8787141800325727`*^9, 3.878714519340356*^9, 3.8787224955274076`*^9, 
   3.879493365427601*^9, 3.879493434026325*^9, 3.879493567469657*^9, 
   3.879493617906691*^9, 3.879494200571526*^9, 3.879504485126191*^9, 
   3.880606266550584*^9, 3.8806064334619703`*^9, 3.8806869988375387`*^9, 
   3.88068714832132*^9, 3.880687321828005*^9, 3.881818599860334*^9, 
   3.881989569954135*^9, 3.881990395320848*^9, 3.881991684656402*^9, 
   3.883479962811451*^9, 3.8836264903831472`*^9, 3.883725555785104*^9, 
   3.884076210041925*^9, 3.8840762871412573`*^9, 3.8840924644604073`*^9, 
   3.88414550220083*^9, 3.885527798001169*^9, 3.8926992810992537`*^9},
 CellLabel->
  "Out[561]=",ExpressionUUID->"5b9ceb63-c04b-4c7c-aa28-e4628e300201"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"try", " ", "to", " ", "find", " ", "conditions", " ", "that", " ", 
  "ensure", " ", "the", " ", "ansatz", " ", "is", " ", "solution", " ", "of", 
  " ", "this", " ", "pde", " ", "by", " ", "setting", " ", "odes", " ", "for",
   " ", 
  RowBox[{
   SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], " ", "and", " ", 
  RowBox[{"\[Sigma]", "[", "t", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"the", " ", "zeroth", " ", "order", " ", "coef", " ", "is", " ", 
  "equal", " ", "both", " ", "sides"}], "\[IndentingNewLine]", 
 RowBox[{"the", " ", "first", " ", "and", " ", "second", " ", "order", " ", 
  "coefs", " ", "yield", " ", "two", " ", "ODEs", " ", "for", " ", "\[Sigma]",
   " ", "and", " ", 
  SubscriptBox["\[Beta]", "m"]}]}], "Text",
 CellChangeTimes->{{3.874053760685463*^9, 3.8740537872934074`*^9}, {
  3.874054577702879*^9, 
  3.874054606454483*^9}},ExpressionUUID->"302646ce-8cd4-4d60-b76e-\
f6321e362e2a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Thread", "[", 
  RowBox[{
   RowBox[{"fs", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{
       RowBox[{"eq", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], ",", "rules"}], 
    "]"}], "==", 
   RowBox[{"fs", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{
       RowBox[{"eq", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}], ",", "rules"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Beta]\[Sigma]sol", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Delete", "[", 
       RowBox[{"%", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Sigma]", "'"}], "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "'"}], "[", "t", "]"}]}], "}"}]}], 
     "]"}], "//", "fs"}], "//", "ft"}]}]}], "Input",
 CellChangeTimes->{{3.8740542278132505`*^9, 3.874054242024773*^9}, {
  3.8740544670929174`*^9, 3.8740545710870275`*^9}, {3.874061966452183*^9, 
  3.8740619824439487`*^9}},
 CellLabel->
  "In[562]:=",ExpressionUUID->"af2c00f1-6feb-4406-a8d1-d27a707e241c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{
    RowBox[{"2", " ", "Vs", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[Theta]", " ", 
        RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", "Vs", " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"d", "+", "\[Alpha]", "-", 
          RowBox[{
           RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"Vs", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Theta]"}], " ", 
           RowBox[{
            SuperscriptBox["\[Sigma]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "+", 
          RowBox[{"Vs", " ", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[Beta]", "m"], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}], "\[Equal]", 
    RowBox[{"2", " ", "Vs", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Vs"}], " ", "\[Theta]", " ", 
        SuperscriptBox["\[Mu]", "2"]}], "-", 
       RowBox[{"2", " ", "Vs", " ", 
        RowBox[{"(", 
         RowBox[{"d", "+", "\[Alpha]", "-", 
          RowBox[{
           SubscriptBox["\[Beta]", "max"], " ", 
           RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
       RowBox[{"\[Theta]", " ", 
        RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Theta]"}], " ", 
        RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "t", "]"}], "3"]}], "-", 
       RowBox[{"Vs", " ", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "t", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"d", "+", "\[Alpha]", "-", 
          RowBox[{
           RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["Vs", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Beta]", "max"], "-", 
          RowBox[{
           SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{"Vs", " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Theta]"}], " ", 
           RowBox[{
            SuperscriptBox["\[Sigma]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "+", 
          RowBox[{"Vs", " ", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[Beta]", "m"], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}], "\[Equal]", 
    RowBox[{"2", " ", "Vs", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Sigma]", "[", "t", "]"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", " ", 
           SuperscriptBox["\[Mu]", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
           RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["\[Beta]", "max"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Vs", " ", 
           SuperscriptBox["\[Mu]", "2"]}], "+", 
          RowBox[{
           RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}]}], ")"}]}], "-", 
       RowBox[{"Vs", " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8786339153015337`*^9, 3.878634719357169*^9, 
  3.8786392284931173`*^9, 3.878702083864396*^9, 3.878702497520884*^9, 
  3.8787027670757437`*^9, 3.8787027978227262`*^9, 3.8787051978468523`*^9, 
  3.8787052390330563`*^9, 3.878705748981696*^9, 3.878714180184526*^9, 
  3.878714519494487*^9, 3.878722495683894*^9, 3.879493365560845*^9, 
  3.879493434440835*^9, 3.879493567627227*^9, 3.879493619475719*^9, 
  3.879494200724832*^9, 3.879504485292555*^9, 3.880606266788013*^9, 
  3.880606433676733*^9, 3.8806869990349703`*^9, 3.8806871484929333`*^9, 
  3.880687322019062*^9, 3.881818600031993*^9, 3.88198957014904*^9, 
  3.881990395484963*^9, 3.881991684831242*^9, 3.883479962957919*^9, 
  3.88362649057023*^9, 3.88372555594753*^9, 3.884076210217465*^9, 
  3.884076287314904*^9, 3.884092464658288*^9, 3.8841455024555264`*^9, 
  3.885527798153098*^9, 3.892699281261098*^9},
 CellLabel->
  "Out[562]=",ExpressionUUID->"7e7e25a4-a2ca-4914-a2b0-2bfa01e0fdc7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Sigma]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[Mu]", "2"], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}], "Vs"]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Beta]", "m"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Beta]", "max"], "-", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], "Vs"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8786339153015337`*^9, 3.878634719357169*^9, 
  3.8786392284931173`*^9, 3.878702083864396*^9, 3.878702497520884*^9, 
  3.8787027670757437`*^9, 3.8787027978227262`*^9, 3.8787051978468523`*^9, 
  3.8787052390330563`*^9, 3.878705748981696*^9, 3.878714180184526*^9, 
  3.878714519494487*^9, 3.878722495683894*^9, 3.879493365560845*^9, 
  3.879493434440835*^9, 3.879493567627227*^9, 3.879493619475719*^9, 
  3.879494200724832*^9, 3.879504485292555*^9, 3.880606266788013*^9, 
  3.880606433676733*^9, 3.8806869990349703`*^9, 3.8806871484929333`*^9, 
  3.880687322019062*^9, 3.881818600031993*^9, 3.88198957014904*^9, 
  3.881990395484963*^9, 3.881991684831242*^9, 3.883479962957919*^9, 
  3.88362649057023*^9, 3.88372555594753*^9, 3.884076210217465*^9, 
  3.884076287314904*^9, 3.884092464658288*^9, 3.8841455024555264`*^9, 
  3.885527798153098*^9, 3.892699281283125*^9},
 CellLabel->
  "Out[563]=",ExpressionUUID->"1f84ca59-991e-4cfe-966b-757b43e734e5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final ODE system underthe WSSM", "Subsubsection",
 CellChangeTimes->{{3.8740547601325917`*^9, 3.8740547786827793`*^9}, 
   3.875503277704564*^9, 
   3.876399255874854*^9},ExpressionUUID->"27db3e15-0556-454d-8f42-\
56f6b49e5f6a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Conclusion", ":", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Under", " ", "the", " ", "1", "st", " ", "order", " ", "WSSM", " ", 
     RowBox[{"(", 
      RowBox[{"order", " ", "1", " ", "in", " ", "\[Lambda]"}], ")"}]}], " ", 
    "+", " ", 
    RowBox[{
    "with", " ", "an", " ", "initially", " ", "gaussian", " ", "trait", " ", 
     "distribution", " ", "we", " ", "get"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "\[Distributed]", 
   RowBox[{"\[ScriptCapitalN]", "[", 
    RowBox[{
     RowBox[{
      OverscriptBox["g", "_"], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", "t", "]"}], 
      SubscriptBox["\[DoubleStruckCapitalI]", "n"]}]}], "]"}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"where", " ", 
    OverscriptBox["g", "_"], " ", "is", " ", "such", " ", "that", " ", 
    RowBox[{"\[Beta]", "[", 
     RowBox[{
      OverscriptBox["g", "_"], "[", "t", "]"}], "]"}]}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Beta]", "max"], "-", 
     FractionBox[
      RowBox[{"|", 
       RowBox[{
        OverscriptBox["g", "_"], "[", "t", "]"}], 
       SuperscriptBox["|", "2"]}], 
      RowBox[{"2", " ", "Vs"}]]}], "=", 
    RowBox[{
     SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"and", " ", "\[ScriptCapitalI]"}], ",", "\[ScriptCapitalS]", ",", 
  RowBox[{
   SubscriptBox["\[Beta]", "m"], " ", "and", " ", "\[Sigma]", " ", "are", " ",
    "solutions", " ", "of", " ", "the", " ", "ODE", " ", 
   RowBox[{"system", ":", "\[IndentingNewLine]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {
          RowBox[{
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[Beta]", "m"], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Vs", " ", 
                SubscriptBox["\[Beta]", "max"]}], "-", 
               RowBox[{
                SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], 
            "Vs"]}]},
         {
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Sigma]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
           RowBox[{
            SuperscriptBox["\[Mu]", "2"], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
              SuperscriptBox[
               RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}], "Vs"]}]}]},
         {
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ScriptCapitalS]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
           RowBox[{"\[Lambda]", "-", 
            FractionBox[
             RowBox[{
              RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Vs", " ", "\[Delta]"}], "+", 
                RowBox[{
                 RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "\[Theta]"}], " ", 
                    RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
                   RowBox[{
                    SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], 
                  ")"}]}]}], ")"}]}], "Vs"]}]}]},
         {
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ScriptCapitalI]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Vs", " ", "\[Alpha]"}], "+", 
                RowBox[{
                 RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Theta]", " ", 
                    RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
                   RowBox[{
                    SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], 
                  ")"}]}]}], ")"}]}], "Vs"]}]}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}]}]}]}], "Text",
 CellChangeTimes->{{3.874054822415594*^9, 3.874054833428879*^9}, {
   3.8740552888131895`*^9, 3.8740554414244165`*^9}, {3.87405555294582*^9, 
   3.874055553201721*^9}, 3.878631213666135*^9, {3.878633938714542*^9, 
   3.8786339392734337`*^9}, 
   3.878634124193327*^9},ExpressionUUID->"836dab57-3d13-4354-b8f6-\
c76ad8333972"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], ",", 
     RowBox[{"\[Sigma]", "[", "t", "]"}], ",", 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], ",", 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODEansatz", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], "vars"}], "==", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "t"], "vars"}], "/.", "SIsol"}], "/.", 
       "\[Beta]\[Sigma]sol"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ODEansatz", "//", "mx"}]}], "Input",
 CellChangeTimes->{{3.874061998041623*^9, 3.8740620693212943`*^9}},
 CellLabel->
  "In[564]:=",ExpressionUUID->"97db0e0c-d9bc-44fd-8736-d43a90d1d3d8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[Beta]", "m"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
          RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Beta]", "max"], "-", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], 
         "Vs"]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Sigma]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         SuperscriptBox["\[Mu]", "2"], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}], "Vs"]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ScriptCapitalS]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{"b", "+", 
         RowBox[{
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d"}], "+", 
            RowBox[{
             RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"\[Theta]", " ", 
                 RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"], "-", 
               RowBox[{
                SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}]}]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ScriptCapitalI]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Vs", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Theta]", " ", 
                 RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
                RowBox[{"Vs", " ", 
                 RowBox[{
                  SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], 
               ")"}]}]}], ")"}]}], "Vs"]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.878633944306097*^9, 3.878634719387476*^9, 
  3.878639233715143*^9, 3.878702087216864*^9, 3.878702503404214*^9, 
  3.878702767125946*^9, 3.878702797884698*^9, 3.8787051862997847`*^9, 
  3.878705239073268*^9, 3.878705749017844*^9, 3.878714180231084*^9, 
  3.878714519533614*^9, 3.878722495731679*^9, 3.879493365607019*^9, 
  3.879493434482222*^9, 3.879493567666128*^9, 3.879493621220937*^9, 
  3.879494200799302*^9, 3.879504485339663*^9, 3.8806062668981743`*^9, 
  3.88060643374461*^9, 3.880686999096388*^9, 3.8806871485685062`*^9, 
  3.880687322080853*^9, 3.881818600076198*^9, 3.881989570218706*^9, 
  3.8819903955210047`*^9, 3.881991684864231*^9, 3.883479963067634*^9, 
  3.88362649072023*^9, 3.883725555994584*^9, 3.884076210294239*^9, 
  3.8840762873547287`*^9, 3.884092464703308*^9, 3.8841455025137672`*^9, 
  3.885527798284842*^9, 3.892699281317284*^9},
 CellLabel->
  "Out[566]//MatrixForm=",ExpressionUUID->"613e3067-8ed9-4e24-b640-\
be97a080c68e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"The", " ", "mean", " ", "transmission", " ", "rate", " ", 
   RowBox[{"is", " ", ":", "\[IndentingNewLine]", 
    RowBox[{
     OverscriptBox["\[Beta]", "_"], "[", "t", "]"}]}]}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "-", 
   RowBox[{"\[Theta]", " ", 
    RowBox[{"\[Sigma]", "[", "t", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"its", " ", "change", " ", "per", " ", "unit", " ", "time", " ", 
   RowBox[{"is", " ", ":", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{
      OverscriptBox["\[Beta]", "_"], "[", "t", "]"}]}]}]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Beta]", "max"], "-", 
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"\[Theta]", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], " ", ")"}]}], "-", 
   RowBox[{"\[Theta]", " ", 
    SuperscriptBox["\[Mu]", "2"]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"which", " ", "can", " ", "be", " ", 
   RowBox[{"written", ":", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{
      OverscriptBox["\[Beta]", "_"], "[", "t", "]"}]}]}]}], "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Beta]", "m"], "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], "-", 
   RowBox[{"\[Theta]", " ", 
    RowBox[{
     RowBox[{"\[Sigma]", "'"}], "[", "t", "]"}]}]}]}]}], "Text",
 CellChangeTimes->{{3.874056104199983*^9, 3.874056119114082*^9}, {
   3.874056190376882*^9, 3.8740562197323556`*^9}, {3.874056317588087*^9, 
   3.874056338541664*^9}, {3.8740565769390354`*^9, 3.8740565978254466`*^9}, {
   3.8740566643295884`*^9, 3.874056686211941*^9}, 
   3.8740567430482445`*^9},ExpressionUUID->"84f0ca4d-6aaf-4aad-a785-\
225fc72c8663"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], ",", 
     RowBox[{"\[Sigma]", "[", "t", "]"}], ",", 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], ",", 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"rates", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"ODEansatz", ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "t"], "#"}], "&"}], "/@", "vars"}]}], 
     "]"}], "//", "ft"}], "//", "fs"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], 
     RowBox[{"\[Kappa]", "[", 
      RowBox[{"z", ",", "t"}], "]"}]}], "/.", 
    RowBox[{"z", "->", "0"}]}], "//.", "ansatz"}], "//", 
  "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"%", ",", "t"}], "]"}], "/.", "rates"}], "//", 
  "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "==", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Beta]", "m"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "-", 
     FractionBox[
      RowBox[{"\[Theta]", " ", 
       RowBox[{
        RowBox[{"\[Sigma]", "'"}], "[", "t", "]"}]}], "Vs"]}]}], "/.", 
   "rates"}], "//", "fs"}]}], "Input",
 CellChangeTimes->{{3.8740562500676765`*^9, 3.8740563104049616`*^9}, {
   3.8740563485137577`*^9, 3.874056433945945*^9}, {3.8740566413556633`*^9, 
   3.874056658764544*^9}, {3.874056693441487*^9, 3.8740567093678617`*^9}, 
   3.878634805915196*^9, {3.878639322012892*^9, 3.8786393230878487`*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"67e38814-e2b4-42c9-ae3b-985b4f0c9bf7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Beta]", "m"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Beta]", "max"], "-", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], "Vs"]}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Sigma]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[Mu]", "2"], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}], "Vs"]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalS]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{"b", "+", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"], "-", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
       ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalI]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
            RowBox[{"Vs", " ", 
             RowBox[{
              SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
        ")"}]}], "Vs"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8740563112256927`*^9, {3.8740563515942173`*^9, 3.874056434357951*^9}, {
   3.8740565615341315`*^9, 3.8740565725189466`*^9}, {3.874056656455946*^9, 
   3.874056659066128*^9}, {3.874056697550155*^9, 3.8740567387362757`*^9}, 
   3.8740568732820415`*^9, 3.8740618483429794`*^9, 3.874062083514229*^9, 
   3.87560389663419*^9, 3.875846278348425*^9, 3.878359342110375*^9, 
   3.878630686998372*^9, 3.8786347194049463`*^9, 3.878634806579631*^9, 
   3.878639239519158*^9, 3.878639323476466*^9, 3.878702089141472*^9, 
   3.878702505291987*^9, 3.8787027671857357`*^9, 3.8787027979189167`*^9, 
   3.8787052391287823`*^9, 3.878705749041231*^9, 3.87870665730285*^9, 
   3.878714180260129*^9, 3.8787145195576057`*^9, 3.87872249576217*^9, 
   3.879493365631959*^9, 3.879493434512828*^9, 3.8794935676919613`*^9, 
   3.879493623468431*^9, 3.879494200830949*^9, 3.879504485383251*^9, 
   3.880606266934935*^9, 3.880606433790715*^9, 3.880686999126231*^9, 
   3.880687148604618*^9, 3.880687322110775*^9, 3.881818600099791*^9, 
   3.881989570254525*^9, 3.88199039554141*^9, 3.8819916848854*^9, 
   3.8834799631458817`*^9, 3.8836264907486763`*^9, 3.8837255560198803`*^9, 
   3.884076210335169*^9, 3.8840762873803377`*^9, 3.8840924647255287`*^9, 
   3.884145502541122*^9, 3.8855277983337317`*^9, 3.892699281377849*^9},
 CellLabel->
  "Out[568]=",ExpressionUUID->"01033ee4-b300-44c7-96cb-04424498effc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[Theta]", " ", 
     RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], "+", 
  RowBox[{
   SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{
  3.8740563112256927`*^9, {3.8740563515942173`*^9, 3.874056434357951*^9}, {
   3.8740565615341315`*^9, 3.8740565725189466`*^9}, {3.874056656455946*^9, 
   3.874056659066128*^9}, {3.874056697550155*^9, 3.8740567387362757`*^9}, 
   3.8740568732820415`*^9, 3.8740618483429794`*^9, 3.874062083514229*^9, 
   3.87560389663419*^9, 3.875846278348425*^9, 3.878359342110375*^9, 
   3.878630686998372*^9, 3.8786347194049463`*^9, 3.878634806579631*^9, 
   3.878639239519158*^9, 3.878639323476466*^9, 3.878702089141472*^9, 
   3.878702505291987*^9, 3.8787027671857357`*^9, 3.8787027979189167`*^9, 
   3.8787052391287823`*^9, 3.878705749041231*^9, 3.87870665730285*^9, 
   3.878714180260129*^9, 3.8787145195576057`*^9, 3.87872249576217*^9, 
   3.879493365631959*^9, 3.879493434512828*^9, 3.8794935676919613`*^9, 
   3.879493623468431*^9, 3.879494200830949*^9, 3.879504485383251*^9, 
   3.880606266934935*^9, 3.880606433790715*^9, 3.880686999126231*^9, 
   3.880687148604618*^9, 3.880687322110775*^9, 3.881818600099791*^9, 
   3.881989570254525*^9, 3.88199039554141*^9, 3.8819916848854*^9, 
   3.8834799631458817`*^9, 3.8836264907486763`*^9, 3.8837255560198803`*^9, 
   3.884076210335169*^9, 3.8840762873803377`*^9, 3.8840924647255287`*^9, 
   3.884145502541122*^9, 3.8855277983337317`*^9, 3.892699281382414*^9},
 CellLabel->
  "Out[569]=",ExpressionUUID->"c20e138b-6c0e-40c6-b489-f10f7e0e80a8"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "Vs"}], " ", "\[Theta]", " ", 
    SuperscriptBox["\[Mu]", "2"]}], "+", 
   RowBox[{
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Vs", " ", 
       SubscriptBox["\[Beta]", "max"]}], "+", 
      RowBox[{"\[Theta]", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
      RowBox[{"2", " ", "Vs", " ", 
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
  SuperscriptBox["Vs", "2"]]], "Output",
 CellChangeTimes->{
  3.8740563112256927`*^9, {3.8740563515942173`*^9, 3.874056434357951*^9}, {
   3.8740565615341315`*^9, 3.8740565725189466`*^9}, {3.874056656455946*^9, 
   3.874056659066128*^9}, {3.874056697550155*^9, 3.8740567387362757`*^9}, 
   3.8740568732820415`*^9, 3.8740618483429794`*^9, 3.874062083514229*^9, 
   3.87560389663419*^9, 3.875846278348425*^9, 3.878359342110375*^9, 
   3.878630686998372*^9, 3.8786347194049463`*^9, 3.878634806579631*^9, 
   3.878639239519158*^9, 3.878639323476466*^9, 3.878702089141472*^9, 
   3.878702505291987*^9, 3.8787027671857357`*^9, 3.8787027979189167`*^9, 
   3.8787052391287823`*^9, 3.878705749041231*^9, 3.87870665730285*^9, 
   3.878714180260129*^9, 3.8787145195576057`*^9, 3.87872249576217*^9, 
   3.879493365631959*^9, 3.879493434512828*^9, 3.8794935676919613`*^9, 
   3.879493623468431*^9, 3.879494200830949*^9, 3.879504485383251*^9, 
   3.880606266934935*^9, 3.880606433790715*^9, 3.880686999126231*^9, 
   3.880687148604618*^9, 3.880687322110775*^9, 3.881818600099791*^9, 
   3.881989570254525*^9, 3.88199039554141*^9, 3.8819916848854*^9, 
   3.8834799631458817`*^9, 3.8836264907486763`*^9, 3.8837255560198803`*^9, 
   3.884076210335169*^9, 3.8840762873803377`*^9, 3.8840924647255287`*^9, 
   3.884145502541122*^9, 3.8855277983337317`*^9, 3.892699281416153*^9},
 CellLabel->
  "Out[570]=",ExpressionUUID->"afe0d4bf-2895-4304-bf7b-f826cab66376"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.8740563112256927`*^9, {3.8740563515942173`*^9, 3.874056434357951*^9}, {
   3.8740565615341315`*^9, 3.8740565725189466`*^9}, {3.874056656455946*^9, 
   3.874056659066128*^9}, {3.874056697550155*^9, 3.8740567387362757`*^9}, 
   3.8740568732820415`*^9, 3.8740618483429794`*^9, 3.874062083514229*^9, 
   3.87560389663419*^9, 3.875846278348425*^9, 3.878359342110375*^9, 
   3.878630686998372*^9, 3.8786347194049463`*^9, 3.878634806579631*^9, 
   3.878639239519158*^9, 3.878639323476466*^9, 3.878702089141472*^9, 
   3.878702505291987*^9, 3.8787027671857357`*^9, 3.8787027979189167`*^9, 
   3.8787052391287823`*^9, 3.878705749041231*^9, 3.87870665730285*^9, 
   3.878714180260129*^9, 3.8787145195576057`*^9, 3.87872249576217*^9, 
   3.879493365631959*^9, 3.879493434512828*^9, 3.8794935676919613`*^9, 
   3.879493623468431*^9, 3.879494200830949*^9, 3.879504485383251*^9, 
   3.880606266934935*^9, 3.880606433790715*^9, 3.880686999126231*^9, 
   3.880687148604618*^9, 3.880687322110775*^9, 3.881818600099791*^9, 
   3.881989570254525*^9, 3.88199039554141*^9, 3.8819916848854*^9, 
   3.8834799631458817`*^9, 3.8836264907486763`*^9, 3.8837255560198803`*^9, 
   3.884076210335169*^9, 3.8840762873803377`*^9, 3.8840924647255287`*^9, 
   3.884145502541122*^9, 3.8855277983337317`*^9, 3.892699281419961*^9},
 CellLabel->
  "Out[571]=",ExpressionUUID->"7afcf2a0-d8f7-4cef-a1f1-10550d79dc99"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"dynamics", " ", "of", " ", "total", " ", 
  "size"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "t"], "\[ScriptCapitalN]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", "'"}], "[", "t", "]"}], "+", 
    RowBox[{
     RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}]}], "=", 
   RowBox[{"\[Lambda]", "-", 
    RowBox[{"\[Alpha]", " ", 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}], "-", 
    RowBox[{"\[Delta]", " ", 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}]}]}]}], "Text",
 CellChangeTimes->{{3.8740568969694033`*^9, 3.8740569294528246`*^9}, 
   3.878631213674192*^9},ExpressionUUID->"dea1b268-c1df-4d34-b746-\
29102f820941"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", "'"}], "[", "t", "]"}], "+", 
    RowBox[{
     RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}]}], "/.", "rates"}], "//",
   "fs"}]], "Input",
 CellChangeTimes->{{3.874056877545297*^9, 3.8740568918867626`*^9}},
 CellLabel->
  "In[572]:=",ExpressionUUID->"5a31e0fd-b064-4e29-821b-72a45b2abf38"],

Cell[BoxData[
 RowBox[{"b", "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
   RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]}], "-", 
  RowBox[{"d", " ", 
   RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{3.878634461678444*^9, 3.8786347195362587`*^9, 
  3.8786393350713387`*^9, 3.8787020916659193`*^9, 3.878702507636167*^9, 
  3.878702767255677*^9, 3.8787027979816313`*^9, 3.878705239194765*^9, 
  3.87870574910526*^9, 3.878714180335333*^9, 3.8787145196320257`*^9, 
  3.878722495837405*^9, 3.8794933656803303`*^9, 3.879493434605855*^9, 
  3.879493567743239*^9, 3.8794936263109283`*^9, 3.879494200891787*^9, 
  3.879504485451894*^9, 3.8806062670415287`*^9, 3.880606433906526*^9, 
  3.880686999215963*^9, 3.880687148672456*^9, 3.880687322182465*^9, 
  3.8818186001668158`*^9, 3.881989570330055*^9, 3.88199039559518*^9, 
  3.8819916849500217`*^9, 3.883479963207967*^9, 3.8836264907959538`*^9, 
  3.883725556075179*^9, 3.884076210414747*^9, 3.884076287445857*^9, 
  3.8840924647933493`*^9, 3.884145502656708*^9, 3.885527798387553*^9, 
  3.892699281448608*^9},
 CellLabel->
  "Out[572]=",ExpressionUUID->"2774dd8d-674b-44c4-96e5-c0c0017acdf5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Mean", " ", "malthusian", " ", "fitness", " ", "is", " ", "the", " ", 
   "growth", " ", "rate", " ", "of", " ", "the", " ", "infected", " ", 
   RowBox[{"pop", ":", "\[IndentingNewLine]", 
    OverscriptBox["m", "_"]}]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], 
     RowBox[{
      RowBox[{"\[Kappa]", "'"}], "[", 
      RowBox[{"0", ",", "t"}], "]"}]}], "-", "\[Alpha]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}], 
    RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]]}]}]], "Text",
 CellChangeTimes->{{3.874056943154787*^9, 3.8740569641369925`*^9}, {
   3.8740569955624485`*^9, 3.8740570889292135`*^9}, 
   3.878631213680202*^9},ExpressionUUID->"81ff8c69-628e-4dfd-93de-\
43e2f5cc5588"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], 
       RowBox[{"\[Kappa]", "[", 
        RowBox[{"z", ",", "t"}], "]"}]}]}], "-", 
     RowBox[{"(", 
      RowBox[{"\[Alpha]", "+", "d"}], ")"}]}], "/.", 
    RowBox[{"z", "->", "0"}]}], "//.", "ansatz"}], "//", 
  "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "==", 
    FractionBox[
     RowBox[{
      RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}], 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]]}], "/.", "rates"}], "//", 
  "fs"}]}], "Input",
 CellChangeTimes->{{3.8740569740230236`*^9, 3.8740569925075855`*^9}, {
   3.874057026289085*^9, 3.874057035614444*^9}, {3.874057093063939*^9, 
   3.8740570933375587`*^9}, 3.8786312136817083`*^9, {3.878702115462129*^9, 
   3.878702119084176*^9}, {3.879493475925892*^9, 3.879493476075632*^9}, 
   3.8794936360573883`*^9},
 CellLabel->
  "In[573]:=",ExpressionUUID->"febd8d7f-8b77-43d6-893d-416dbd4f587a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "d"}], "-", "\[Alpha]", "+", 
  RowBox[{
   RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[Theta]", " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], "+", 
     RowBox[{
      SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8786346521127987`*^9, 3.878634719571394*^9, 3.878639337475761*^9, {
   3.8787020932365303`*^9, 3.878702119620586*^9}, 3.878702509260347*^9, 
   3.8787027672917*^9, 3.878702798020089*^9, 3.878705239234426*^9, 
   3.8787057491442127`*^9, 3.878714180377776*^9, 3.878714519676284*^9, 
   3.878722495886973*^9, 3.879493365715333*^9, 3.8794934346397142`*^9, 
   3.879493476998921*^9, 3.87949356777075*^9, {3.8794936280220737`*^9, 
   3.879493636621419*^9}, 3.879494200925256*^9, 3.879504485484573*^9, 
   3.880606267088572*^9, 3.880606433951305*^9, 3.8806869992650433`*^9, 
   3.880687148713472*^9, 3.8806873222253723`*^9, 3.881818600271743*^9, 
   3.881989570370805*^9, 3.881990395628147*^9, 3.8819916849913893`*^9, 
   3.883479963237467*^9, 3.8836264908276*^9, 3.883725556109846*^9, 
   3.884076210462657*^9, 3.884076287487362*^9, 3.884092464831915*^9, 
   3.884145502705865*^9, 3.885527798415813*^9, 3.89269928148324*^9},
 CellLabel->
  "Out[573]=",ExpressionUUID->"745a277a-e77d-40c2-9e11-dbf0cc4ed3c5"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.8786346521127987`*^9, 3.878634719571394*^9, 3.878639337475761*^9, {
   3.8787020932365303`*^9, 3.878702119620586*^9}, 3.878702509260347*^9, 
   3.8787027672917*^9, 3.878702798020089*^9, 3.878705239234426*^9, 
   3.8787057491442127`*^9, 3.878714180377776*^9, 3.878714519676284*^9, 
   3.878722495886973*^9, 3.879493365715333*^9, 3.8794934346397142`*^9, 
   3.879493476998921*^9, 3.87949356777075*^9, {3.8794936280220737`*^9, 
   3.879493636621419*^9}, 3.879494200925256*^9, 3.879504485484573*^9, 
   3.880606267088572*^9, 3.880606433951305*^9, 3.8806869992650433`*^9, 
   3.880687148713472*^9, 3.8806873222253723`*^9, 3.881818600271743*^9, 
   3.881989570370805*^9, 3.881990395628147*^9, 3.8819916849913893`*^9, 
   3.883479963237467*^9, 3.8836264908276*^9, 3.883725556109846*^9, 
   3.884076210462657*^9, 3.884076287487362*^9, 3.884092464831915*^9, 
   3.884145502705865*^9, 3.885527798415813*^9, 3.8926992814868183`*^9},
 CellLabel->
  "Out[574]=",ExpressionUUID->"aae2be97-e905-4e21-a29a-8d6f8d17612a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "the", " ", "variance", " ", "in", " ", "malthusian", " ", "fitenss", " ", 
   RowBox[{"is", ":", "\[IndentingNewLine]", 
    SubscriptBox["\[DoubleStruckCapitalV]", "m"]}]}], "=", 
  RowBox[{
   RowBox[{"\[DoubleStruckCapitalV]", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Beta]"}], "-", 
     "\[Alpha]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "2"], 
     RowBox[{"\[DoubleStruckCapitalV]", "[", "\[Beta]", "]"}]}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "2"], 
     OverscriptBox[
      RowBox[{
       RowBox[{"\[Kappa]", "''"}], "[", 
       RowBox[{"0", ",", "t"}], "]"}], 
      RowBox[{"#", "{"}]]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "while", " ", "the", " ", "change", " ", "in", " ", "mean", " ", "fitness", 
   " ", "without", " ", "mutation", " ", 
   RowBox[{"(", 
    RowBox[{"\[Mu]", "=", 
     RowBox[{"\[Lambda]", "=", "0"}]}], ")"}], " ", 
   RowBox[{"is", ":", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     OverscriptBox["m", "_"]}]}]}], "=", 
  RowBox[{
   SubscriptBox["\[DoubleStruckCapitalV]", "m"], "+", 
   RowBox[{
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
      RowBox[{
       SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Delta]", "+", 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "-", 
         RowBox[{"\[Theta]", " ", 
          RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}]}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"contrary", " ", "to", " ", "the", " ", "fisher", " ", 
  RowBox[{"theorem", ":", 
   RowBox[{
    RowBox[{"needs", " ", "explanation"}], "..."}]}]}]}], "Text",
 CellChangeTimes->{{3.8740571164719067`*^9, 3.8740571421074047`*^9}, {
   3.8740610850122213`*^9, 3.874061139228766*^9}, {3.8740612961325397`*^9, 
   3.8740613234120617`*^9}, {3.8740614291986012`*^9, 3.87406144102735*^9}, 
   3.8786312136879473`*^9, {3.883630204701497*^9, 
   3.883630207794344*^9}},ExpressionUUID->"0d82b6d6-1fcc-4b66-b1b4-\
9849ecf1903c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "2"], 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"z", ",", "z"}]], 
      RowBox[{"\[Kappa]", "[", 
       RowBox[{"z", ",", "t"}], "]"}]}]}], "/.", 
    RowBox[{"z", "->", "0"}]}], "//.", "ansatz"}], "//", 
  "fs"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}], 
           RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]], "/.", "rates"}], 
         ",", "t"}], "]"}], "/.", "rates"}], "/.", 
      RowBox[{"\[Mu]", "->", "0"}]}], "/.", 
     RowBox[{"\[Lambda]", "->", "0"}]}], "//", "po"}], ",", "rules"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"%", ",", 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "]"}], "==", 
   RowBox[{"%%", "+", 
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Theta]", " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"\[Delta]", "+", 
       RowBox[{
        RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "-", 
          RowBox[{"\[Theta]", " ", 
           RowBox[{"\[Sigma]", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]}]}], "//",
   "fs"}]}], "Input",
 CellChangeTimes->{{3.8740571251067643`*^9, 3.8740572116264305`*^9}, {
  3.874061175152522*^9, 3.8740611899492617`*^9}, {3.8740612350150394`*^9, 
  3.8740612698070307`*^9}, {3.874061340705205*^9, 3.8740614143079443`*^9}, {
  3.878635331004498*^9, 3.8786353464957743`*^9}},
 CellLabel->
  "In[575]:=",ExpressionUUID->"eba26dec-ff38-4cd6-90e3-6d24d2b837ae"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "2"], " ", 
   RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "Vs", " ", 
      SubscriptBox["\[Beta]", "max"]}], "+", 
     RowBox[{"\[Theta]", " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", "Vs", " ", 
      RowBox[{
       SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
  SuperscriptBox["Vs", "2"]]], "Output",
 CellChangeTimes->{
  3.8740571478895264`*^9, 3.874057180149682*^9, 3.8740572123563194`*^9, {
   3.874061180294732*^9, 3.8740611909575443`*^9}, {3.8740612365993056`*^9, 
   3.8740612706248236`*^9}, {3.8740613434278145`*^9, 3.8740613818143196`*^9}, 
   3.874061422965807*^9, 3.874061848490079*^9, 3.8740620971419215`*^9, 
   3.875603896808056*^9, 3.875846278464015*^9, 3.878359342188673*^9, 
   3.8786306870857067`*^9, 3.878634719613044*^9, 3.87863476495518*^9, 
   3.8786348283861637`*^9, 3.878635347192892*^9, 3.878635432689258*^9, 
   3.878639340761216*^9, 3.8787021265640182`*^9, 3.878702511083796*^9, 
   3.878702767330268*^9, 3.878702798056568*^9, 3.878705239274753*^9, 
   3.878705749176466*^9, 3.8787141804259872`*^9, 3.878714519717495*^9, 
   3.878722495937545*^9, 3.8794933657572403`*^9, 3.8794934347142057`*^9, 
   3.8794935678087473`*^9, 3.879493638310341*^9, 3.8794942009569798`*^9, 
   3.8795044855096493`*^9, 3.880606267139003*^9, 3.880606434017721*^9, 
   3.880686999324257*^9, 3.8806871487768106`*^9, 3.8806873222734756`*^9, 
   3.881818600302204*^9, 3.881989570406845*^9, 3.8819903956524963`*^9, 
   3.8819916850177402`*^9, 3.883479963271607*^9, 3.883626490868293*^9, 
   3.883725556149192*^9, 3.884076210525012*^9, 3.884076287519978*^9, 
   3.884092464861175*^9, 3.8841455027475452`*^9, 3.885527798448072*^9, 
   3.8926992815164137`*^9},
 CellLabel->
  "Out[575]=",ExpressionUUID->"d6aec8a8-5e28-4ead-a4a6-02e151a2c73e"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["Vs", "2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "2"], " ", 
     RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Vs", " ", 
        SubscriptBox["\[Beta]", "max"]}], "+", 
       RowBox[{"\[Theta]", " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
       RowBox[{"2", " ", "Vs", " ", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Theta]"}], " ", 
        RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
       RowBox[{"Vs", " ", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", "Vs"}], "-", 
       RowBox[{
        RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "Vs"}], "+", 
          RowBox[{
           RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Theta]"}], " ", 
              RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
             RowBox[{"Vs", " ", 
              RowBox[{
               SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8740571478895264`*^9, 3.874057180149682*^9, 3.8740572123563194`*^9, {
   3.874061180294732*^9, 3.8740611909575443`*^9}, {3.8740612365993056`*^9, 
   3.8740612706248236`*^9}, {3.8740613434278145`*^9, 3.8740613818143196`*^9}, 
   3.874061422965807*^9, 3.874061848490079*^9, 3.8740620971419215`*^9, 
   3.875603896808056*^9, 3.875846278464015*^9, 3.878359342188673*^9, 
   3.8786306870857067`*^9, 3.878634719613044*^9, 3.87863476495518*^9, 
   3.8786348283861637`*^9, 3.878635347192892*^9, 3.878635432689258*^9, 
   3.878639340761216*^9, 3.8787021265640182`*^9, 3.878702511083796*^9, 
   3.878702767330268*^9, 3.878702798056568*^9, 3.878705239274753*^9, 
   3.878705749176466*^9, 3.8787141804259872`*^9, 3.878714519717495*^9, 
   3.878722495937545*^9, 3.8794933657572403`*^9, 3.8794934347142057`*^9, 
   3.8794935678087473`*^9, 3.879493638310341*^9, 3.8794942009569798`*^9, 
   3.8795044855096493`*^9, 3.880606267139003*^9, 3.880606434017721*^9, 
   3.880686999324257*^9, 3.8806871487768106`*^9, 3.8806873222734756`*^9, 
   3.881818600302204*^9, 3.881989570406845*^9, 3.8819903956524963`*^9, 
   3.8819916850177402`*^9, 3.883479963271607*^9, 3.883626490868293*^9, 
   3.883725556149192*^9, 3.884076210525012*^9, 3.884076287519978*^9, 
   3.884092464861175*^9, 3.8841455027475452`*^9, 3.885527798448072*^9, 
   3.89269928179494*^9},
 CellLabel->
  "Out[576]=",ExpressionUUID->"9840421e-daf2-4244-860f-68963d11c42b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["Vs", "2"]}], ")"}], " ", 
     SuperscriptBox["\[Theta]", "2"], " ", 
     RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}], "Vs"], "+", 
   RowBox[{"Vs", " ", 
    RowBox[{"(", 
     RowBox[{"b", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d"}], "+", "\[Delta]"}], ")"}], " ", 
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], "\[Equal]", 
  RowBox[{"\[Theta]", " ", 
   RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", 
        RowBox[{"Vs", " ", "\[Delta]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "Vs"}], ")"}], " ", 
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8740571478895264`*^9, 3.874057180149682*^9, 3.8740572123563194`*^9, {
   3.874061180294732*^9, 3.8740611909575443`*^9}, {3.8740612365993056`*^9, 
   3.8740612706248236`*^9}, {3.8740613434278145`*^9, 3.8740613818143196`*^9}, 
   3.874061422965807*^9, 3.874061848490079*^9, 3.8740620971419215`*^9, 
   3.875603896808056*^9, 3.875846278464015*^9, 3.878359342188673*^9, 
   3.8786306870857067`*^9, 3.878634719613044*^9, 3.87863476495518*^9, 
   3.8786348283861637`*^9, 3.878635347192892*^9, 3.878635432689258*^9, 
   3.878639340761216*^9, 3.8787021265640182`*^9, 3.878702511083796*^9, 
   3.878702767330268*^9, 3.878702798056568*^9, 3.878705239274753*^9, 
   3.878705749176466*^9, 3.8787141804259872`*^9, 3.878714519717495*^9, 
   3.878722495937545*^9, 3.8794933657572403`*^9, 3.8794934347142057`*^9, 
   3.8794935678087473`*^9, 3.879493638310341*^9, 3.8794942009569798`*^9, 
   3.8795044855096493`*^9, 3.880606267139003*^9, 3.880606434017721*^9, 
   3.880686999324257*^9, 3.8806871487768106`*^9, 3.8806873222734756`*^9, 
   3.881818600302204*^9, 3.881989570406845*^9, 3.8819903956524963`*^9, 
   3.8819916850177402`*^9, 3.883479963271607*^9, 3.883626490868293*^9, 
   3.883725556149192*^9, 3.884076210525012*^9, 3.884076287519978*^9, 
   3.884092464861175*^9, 3.8841455027475452`*^9, 3.885527798448072*^9, 
   3.8926992821748343`*^9},
 CellLabel->
  "Out[577]=",ExpressionUUID->"2349f6a0-e74d-4460-bc2d-7bab2f0a2468"]
}, Open  ]],

Cell[TextData[{
 "The difference between the change in fitness and the variance in fitness is \
exactly the reponse of the change in environment. So we are consistent with \
what\[CloseCurlyQuote]s expected (cf. Gandon&Day2009)\nLast line below shows \
that the difference between the dynamics of fitness and the variance in \
fitness is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalDelta]", "ec"], TraditionalForm]],ExpressionUUID->
  "916d3ea2-7541-4d4f-a40c-2d181f023f71"],
 "=",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["dS", "dt"], 
    RowBox[{"E", "(", "\[Beta]", ")"}]}], TraditionalForm]],ExpressionUUID->
  "fea978b1-d1c8-42d8-92f0-30175067bb3b"],
 " just like in eq 10c of Gandon&Day 2009"
}], "Text",
 CellChangeTimes->{{3.878638848009754*^9, 3.878638902722068*^9}, {
  3.87863893793808*^9, 3.878638961554287*^9}, {3.878702519793586*^9, 
  3.8787025969952517`*^9}},ExpressionUUID->"9cd6fcf6-e9c1-4d1d-bf52-\
8712702c7387"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}], 
              RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]], "/.", "rates"}], 
            ",", "t"}], "]"}], "/.", "rates"}], "/.", 
         RowBox[{"\[Mu]", "->", "0"}]}], "/.", 
        RowBox[{"\[Lambda]", "->", "0"}]}], "//", "po"}], ",", "rules"}], 
     "]"}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "2"], 
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"z", ",", "z"}]], 
         RowBox[{"\[Kappa]", "[", 
          RowBox[{"z", ",", "t"}], "]"}]}]}], "/.", 
       RowBox[{"z", "->", "0"}]}], "//.", "ansatz"}], "//", "fs"}], ")"}]}], "//",
   "fs"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"Vs", "->", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "==", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], ",", "t"}], "]"}], "/.",
        "rates"}], ")"}], " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], 
         RowBox[{"\[Kappa]", "[", 
          RowBox[{"z", ",", "t"}], "]"}]}], "/.", 
        RowBox[{"z", "->", "0"}]}], "//.", "ansatz"}], ")"}]}]}], "/.", 
   RowBox[{"Vs", "->", "1"}]}], "//", "fs"}]}], "Input",
 CellChangeTimes->{{3.878635109888888*^9, 3.878635131376237*^9}, {
  3.878635348942759*^9, 3.8786353640553923`*^9}, {3.878635450423979*^9, 
  3.878635468044836*^9}, {3.87870216211771*^9, 3.878702164406076*^9}, {
  3.8787022051666327`*^9, 3.8787022135192223`*^9}, {3.8787022612241364`*^9, 
  3.878702374188942*^9}},
 CellLabel->
  "In[578]:=",ExpressionUUID->"95bfac2a-1350-44b7-87a2-0e19383d2420"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[Theta]"}], " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
     RowBox[{"Vs", " ", 
      RowBox[{
       SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b", " ", "Vs"}], "-", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "Vs"}], "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Theta]"}], " ", 
            RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
           RowBox[{"Vs", " ", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}], 
  SuperscriptBox["Vs", "2"]]], "Output",
 CellChangeTimes->{{3.8786351276643457`*^9, 3.878635131731802*^9}, {
   3.878635352393173*^9, 3.878635364447094*^9}, {3.878635434026772*^9, 
   3.878635468516062*^9}, 3.8786393512820387`*^9, 3.878702141895651*^9, {
   3.8787022638100433`*^9, 3.878702292512178*^9}, {3.878702339743215*^9, 
   3.8787023749884777`*^9}, 3.878702513215008*^9, 3.878702767972115*^9, 
   3.878702798760583*^9, 3.8787052399361773`*^9, 3.8787057498512373`*^9, 
   3.878714181129858*^9, 3.878714520420377*^9, 3.878722496643433*^9, 
   3.8794933664095097`*^9, 3.8794934349830027`*^9, 3.879493568479086*^9, 
   3.879493640374111*^9, 3.8794942015799294`*^9, 3.879504486368031*^9, 
   3.8806062682630367`*^9, 3.880606435708143*^9, 3.880687000273712*^9, 
   3.880687149493833*^9, 3.8806873230173187`*^9, 3.8818186009774437`*^9, 
   3.881989571224424*^9, 3.881990396309683*^9, 3.881991685722652*^9, 
   3.883479964019546*^9, 3.883626491541265*^9, 3.883725556864991*^9, 
   3.8840762111708527`*^9, 3.88407628822751*^9, 3.884092465658845*^9, 
   3.884145503697246*^9, 3.88552779927114*^9, 3.892699282230556*^9},
 CellLabel->
  "Out[578]=",ExpressionUUID->"e182fefd-6e5b-4091-abc6-3d9b32d8f661"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Theta]"}], " ", 
     RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"b", "-", 
    RowBox[{
     RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"d", "+", 
       RowBox[{
        RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Theta]"}], " ", 
           RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8786351276643457`*^9, 3.878635131731802*^9}, {
   3.878635352393173*^9, 3.878635364447094*^9}, {3.878635434026772*^9, 
   3.878635468516062*^9}, 3.8786393512820387`*^9, 3.878702141895651*^9, {
   3.8787022638100433`*^9, 3.878702292512178*^9}, {3.878702339743215*^9, 
   3.8787023749884777`*^9}, 3.878702513215008*^9, 3.878702767972115*^9, 
   3.878702798760583*^9, 3.8787052399361773`*^9, 3.8787057498512373`*^9, 
   3.878714181129858*^9, 3.878714520420377*^9, 3.878722496643433*^9, 
   3.8794933664095097`*^9, 3.8794934349830027`*^9, 3.879493568479086*^9, 
   3.879493640374111*^9, 3.8794942015799294`*^9, 3.879504486368031*^9, 
   3.8806062682630367`*^9, 3.880606435708143*^9, 3.880687000273712*^9, 
   3.880687149493833*^9, 3.8806873230173187`*^9, 3.8818186009774437`*^9, 
   3.881989571224424*^9, 3.881990396309683*^9, 3.881991685722652*^9, 
   3.883479964019546*^9, 3.883626491541265*^9, 3.883725556864991*^9, 
   3.8840762111708527`*^9, 3.88407628822751*^9, 3.884092465658845*^9, 
   3.884145503697246*^9, 3.88552779927114*^9, 3.892699282234486*^9},
 CellLabel->
  "Out[579]=",ExpressionUUID->"ccaadb2b-f471-4673-83f5-94035609ff43"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8786351276643457`*^9, 3.878635131731802*^9}, {
   3.878635352393173*^9, 3.878635364447094*^9}, {3.878635434026772*^9, 
   3.878635468516062*^9}, 3.8786393512820387`*^9, 3.878702141895651*^9, {
   3.8787022638100433`*^9, 3.878702292512178*^9}, {3.878702339743215*^9, 
   3.8787023749884777`*^9}, 3.878702513215008*^9, 3.878702767972115*^9, 
   3.878702798760583*^9, 3.8787052399361773`*^9, 3.8787057498512373`*^9, 
   3.878714181129858*^9, 3.878714520420377*^9, 3.878722496643433*^9, 
   3.8794933664095097`*^9, 3.8794934349830027`*^9, 3.879493568479086*^9, 
   3.879493640374111*^9, 3.8794942015799294`*^9, 3.879504486368031*^9, 
   3.8806062682630367`*^9, 3.880606435708143*^9, 3.880687000273712*^9, 
   3.880687149493833*^9, 3.8806873230173187`*^9, 3.8818186009774437`*^9, 
   3.881989571224424*^9, 3.881990396309683*^9, 3.881991685722652*^9, 
   3.883479964019546*^9, 3.883626491541265*^9, 3.883725556864991*^9, 
   3.8840762111708527`*^9, 3.88407628822751*^9, 3.884092465658845*^9, 
   3.884145503697246*^9, 3.88552779927114*^9, 3.892699282237913*^9},
 CellLabel->
  "Out[580]=",ExpressionUUID->"652264c0-bf77-4792-84c8-553590a9f8ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}], 
            RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]], "/.", "rates"}], 
          ",", "t"}], "]"}], "/.", "rates"}], "//", "po"}], ",", "rules"}], 
     "]"}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}], 
              RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]], "/.", "rates"}], 
            ",", "t"}], "]"}], "/.", "rates"}], "/.", 
         RowBox[{"\[Mu]", "->", "0"}]}], "/.", 
        RowBox[{"\[Lambda]", "->", "0"}]}], "//", "po"}], ",", "rules"}], 
     "]"}], ")"}]}], "//", "fs"}], "\[IndentingNewLine]", 
 RowBox[{"(", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}], 
          RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]], "/.", "rates"}], ",",
         "t"}], "]"}], "/.", "rates"}], "//", "po"}], ",", "rules"}], "]"}], 
  ")"}]}], "Input",
 CellChangeTimes->{{3.8836313207143917`*^9, 3.8836313428157043`*^9}, {
  3.883631497047893*^9, 3.883631497209525*^9}},
 CellLabel->
  "In[581]:=",ExpressionUUID->"d92a004f-b3b0-416f-9f81-7324716b8816"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[Theta]", " ", 
    SuperscriptBox["\[Mu]", "2"], " ", 
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}]}], "Vs"]}]], "Output",
 CellChangeTimes->{{3.883631322063375*^9, 3.883631343216608*^9}, 
   3.883631498040156*^9, 3.883725557215864*^9, 3.884076211545766*^9, 
   3.884076288597784*^9, 3.88409246601823*^9, 3.884145504091817*^9, 
   3.885527799626049*^9, 3.892699282636278*^9},
 CellLabel->
  "Out[581]=",ExpressionUUID->"1904ed0f-b78d-4d5d-9b2c-aedf313a30d4"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "Vs"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b", "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "d"}], "+", 
           RowBox[{
            RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Theta]", " ", 
                RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"], "-", 
              RowBox[{
               SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
          ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Theta]", " ", 
         RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
        RowBox[{"Vs", " ", 
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Vs", " ", "\[Theta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
          RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "Vs", " ", 
             SubscriptBox["\[Beta]", "max"]}], "+", 
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
            RowBox[{"2", " ", "Vs", " ", 
             RowBox[{
              SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
        ")"}]}], "Vs"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.883631322063375*^9, 3.883631343216608*^9}, 
   3.883631498040156*^9, 3.883725557215864*^9, 3.884076211545766*^9, 
   3.884076288597784*^9, 3.88409246601823*^9, 3.884145504091817*^9, 
   3.885527799626049*^9, 3.892699282639923*^9},
 CellLabel->
  "Out[582]=",ExpressionUUID->"a41e981e-bcd5-4cfb-b705-bde4bea1fe39"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "t"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], 
         RowBox[{"\[Kappa]", "[", 
          RowBox[{"z", ",", "t"}], "]"}]}]}], "/.", 
       RowBox[{"z", "->", "0"}]}], "//.", "ansatz"}], "/.", "rates"}], "/.", 
    RowBox[{"Vs", "->", "1"}]}], "//", "fs"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", " ", 
    RowBox[{
     SubscriptBox["\[Beta]", "max"], "->", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "+", 
      "\[CapitalBeta]"}]}]}], "//", "fs"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"\[CapitalBeta]", "->", 
   RowBox[{
    SubscriptBox["\[Beta]", "max"], "-", 
    RowBox[{
     SubscriptBox["\[Beta]", "m"], "[", "t", 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"\[ScriptCapitalI]", "'"}], "[", "t", "]"}], 
             RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}]], "/.", "rates"}], 
           ",", "t"}], "]"}], "/.", "rates"}], "/.", 
        RowBox[{"\[Mu]", "->", "0"}]}], "//", "po"}], ",", "rules"}], "]"}], 
    ")"}], "/.", 
   RowBox[{"Vs", "->", "1"}]}], "//", "fs"}]}], "Input",
 CellChangeTimes->{{3.8786358255391197`*^9, 3.878635826226997*^9}, {
   3.8787065973914957`*^9, 3.878706616286165*^9}, {3.8787066698251143`*^9, 
   3.8787068415469513`*^9}, {3.878706992986424*^9, 3.878707009890765*^9}, 
   3.878707171454055*^9, {3.8787073361798363`*^9, 3.878707343164322*^9}, {
   3.878707392248797*^9, 3.8787074023646717`*^9}, {3.8787074343681393`*^9, 
   3.878707447099155*^9}, {3.8787074879767723`*^9, 3.878707488910141*^9}, {
   3.8787075286733294`*^9, 3.878707530389192*^9}, {3.878707563218639*^9, 
   3.8787075847364073`*^9}, 3.8787076200531073`*^9, 3.878707795515592*^9},
 CellLabel->
  "In[583]:=",ExpressionUUID->"1ce463ac-3051-43c5-a064-baebd7528721"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[Theta]"}], " ", 
   SuperscriptBox["\[Mu]", "2"]}], "+", 
  RowBox[{
   RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Theta]", " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Beta]", "max"], "-", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8786358273661747`*^9, 3.8787027680062857`*^9, 3.878702798795014*^9, 
   3.878705239975909*^9, 3.878705749897471*^9, {3.8787066017849607`*^9, 
   3.878706616555995*^9}, {3.878706663312858*^9, 3.878706673177197*^9}, {
   3.8787067540412207`*^9, 3.87870684215058*^9}, {3.878706993651367*^9, 
   3.878707010595655*^9}, 3.878707172200429*^9, 3.878707336800256*^9, 
   3.878707403180084*^9, {3.878707439010295*^9, 3.878707447599598*^9}, 
   3.878707489372693*^9, 3.8787075307867403`*^9, {3.878707565561611*^9, 
   3.8787075851172123`*^9}, 3.878707620448262*^9, 3.8787141811901903`*^9, 
   3.878714520484556*^9, 3.878722496712728*^9, 3.87949336647373*^9, 
   3.8794934350233927`*^9, 3.879493568543222*^9, 3.879493642637919*^9, 
   3.879494201623939*^9, 3.879504486443482*^9, 3.880606268497423*^9, 
   3.8806064357911997`*^9, 3.880687000355641*^9, 3.880687149546146*^9, 
   3.880687323074523*^9, 3.881818601033469*^9, 3.881989571322401*^9, 
   3.881990396401071*^9, 3.881991685776616*^9, 3.8834799640709553`*^9, 
   3.883626491581324*^9, 3.8837255572534847`*^9, 3.884076211639001*^9, 
   3.884076288647669*^9, 3.884092466120865*^9, 3.884145504134857*^9, 
   3.88552779966055*^9, 3.892699282713086*^9},
 CellLabel->
  "Out[585]=",ExpressionUUID->"947bd281-ba8b-42dc-ae38-fa9034e9e84d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "2"], " ", 
   RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SubscriptBox["\[Beta]", "max"]}], "+", 
     RowBox[{"\[Theta]", " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[Theta]"}], " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"b", "-", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d", "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Theta]"}], " ", 
            RowBox[{"\[Sigma]", "[", "t", "]"}]}], "+", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8786358273661747`*^9, 3.8787027680062857`*^9, 3.878702798795014*^9, 
   3.878705239975909*^9, 3.878705749897471*^9, {3.8787066017849607`*^9, 
   3.878706616555995*^9}, {3.878706663312858*^9, 3.878706673177197*^9}, {
   3.8787067540412207`*^9, 3.87870684215058*^9}, {3.878706993651367*^9, 
   3.878707010595655*^9}, 3.878707172200429*^9, 3.878707336800256*^9, 
   3.878707403180084*^9, {3.878707439010295*^9, 3.878707447599598*^9}, 
   3.878707489372693*^9, 3.8787075307867403`*^9, {3.878707565561611*^9, 
   3.8787075851172123`*^9}, 3.878707620448262*^9, 3.8787141811901903`*^9, 
   3.878714520484556*^9, 3.878722496712728*^9, 3.87949336647373*^9, 
   3.8794934350233927`*^9, 3.879493568543222*^9, 3.879493642637919*^9, 
   3.879494201623939*^9, 3.879504486443482*^9, 3.880606268497423*^9, 
   3.8806064357911997`*^9, 3.880687000355641*^9, 3.880687149546146*^9, 
   3.880687323074523*^9, 3.881818601033469*^9, 3.881989571322401*^9, 
   3.881990396401071*^9, 3.881991685776616*^9, 3.8834799640709553`*^9, 
   3.883626491581324*^9, 3.8837255572534847`*^9, 3.884076211639001*^9, 
   3.884076288647669*^9, 3.884092466120865*^9, 3.884145504134857*^9, 
   3.88552779966055*^9, 3.892699282792577*^9},
 CellLabel->
  "Out[586]=",ExpressionUUID->"05e715e9-fd64-4254-b9a0-7cadead71472"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equilibria", "Subsubsection",
 CellChangeTimes->{{3.874062118707328*^9, 
  3.8740621223688946`*^9}},ExpressionUUID->"ea96da5c-c94e-4c84-9815-\
2ed85b7e5755"],

Cell["4 equilibria AND WE ADD U f", "Text",
 CellChangeTimes->{{3.8740621794704103`*^9, 3.8740622438300314`*^9}, {
  3.874062463434085*^9, 3.8740624776742163`*^9}, {3.874064765827854*^9, 
  3.8740647660123825`*^9}, {3.879493706921384*^9, 
  3.8794937127844257`*^9}},ExpressionUUID->"74f39645-f6cc-4276-8295-\
10689213bacb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"ODEansatz", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "==", 
    RowBox[{"0", 
     RowBox[{"ODEansatz", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}], "//", 
  "mx"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equils", "=", 
   RowBox[{"fs", "[", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"%", ",", "vars"}], "]"}], ",", "rules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"equils", "//", "mx"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"equils", " ", "/.", 
     RowBox[{"\[Alpha]", "->", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", "+", 
        RowBox[{"U", " ", "f"}]}], ")"}]}]}], "/.", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Theta]", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"]}], "+", 
       RowBox[{"4", " ", "Vs", " ", 
        RowBox[{"(", 
         RowBox[{"d", "+", "\[Alpha]", "+", " ", 
          RowBox[{"U", " ", "f"}]}], ")"}], " ", 
        SubscriptBox["\[Beta]", "max"]}]}]], "->", "\[Gamma]"}]}], "/.", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"d", "+", 
      RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}], "->", "\[Nu]"}]}], "//",
   "mx"}]}], "Input",
 CellChangeTimes->{{3.874062126491506*^9, 3.8740621763274717`*^9}, {
  3.874062247502665*^9, 3.874062380980254*^9}, {3.874062429725669*^9, 
  3.8740624375589695`*^9}, {3.8740647607150307`*^9, 3.8740647611320405`*^9}, {
  3.879493351206481*^9, 3.8794933514301577`*^9}, {3.879493654746862*^9, 
  3.879493691402277*^9}},
 CellLabel->
  "In[587]:=",ExpressionUUID->"45f1f54c-21b3-4f43-8f91-d050526c493d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
          RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Beta]", "max"], "-", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], "Vs"], 
        "\[Equal]", "0"}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Mu]", "2"], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}], "Vs"]}], "\[Equal]", 
        "0"}]},
      {
       RowBox[{
        RowBox[{"b", "+", 
         RowBox[{
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d"}], "+", 
            RowBox[{
             RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"\[Theta]", " ", 
                 RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"], "-", 
               RowBox[{
                SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}]}]}], "\[Equal]", "0"}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Vs", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "\[Alpha]"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Theta]", " ", 
                 RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
                RowBox[{"Vs", " ", 
                 RowBox[{
                  SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], 
               ")"}]}]}], ")"}]}], "Vs"]}], "\[Equal]", "0"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8786347198365803`*^9, 3.8786389700548477`*^9, 3.878639386369816*^9, {
   3.878639546452577*^9, 3.878639550622675*^9}, 3.878702605325181*^9, 
   3.878702768032773*^9, 3.87870279882727*^9, 3.878705124285076*^9, 
   3.878705165418228*^9, 3.878705240005233*^9, 3.878705749926897*^9, 
   3.8787141812926283`*^9, 3.878714520583877*^9, 3.878722496819064*^9, 
   3.879493366573205*^9, 3.8794934354258213`*^9, 3.879493568642495*^9, {
   3.879493646055051*^9, 3.8794936922540913`*^9}, 3.879494201724369*^9, 
   3.879504486544552*^9, 3.880606268626657*^9, 3.8806064359382677`*^9, 
   3.880687000473873*^9, 3.880687149703874*^9, 3.8806873232355337`*^9, 
   3.8818186011309233`*^9, 3.881989571435506*^9, 3.88199039650183*^9, 
   3.881991685870598*^9, 3.883479964193274*^9, 3.883626491751183*^9, 
   3.883725557360009*^9, 3.8840762117471457`*^9, 3.884076288748209*^9, 
   3.8840924662331944`*^9, 3.884145504239732*^9, 3.885527799754081*^9, 
   3.892699282815824*^9},
 CellLabel->
  "Out[587]//MatrixForm=",ExpressionUUID->"1317b75e-d74b-432f-b6f5-\
a422e850151f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Beta]", "max"]}], 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SqrtBox["d"], " ", 
          SqrtBox["Vs"], " ", "\[Mu]"}], 
         SqrtBox["b"]]}]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Rule]", 
       FractionBox["b", "d"]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "\[Rule]", "0"}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Beta]", "max"]}], 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{
         SqrtBox["d"], " ", 
         SqrtBox["Vs"], " ", "\[Mu]"}], 
        SqrtBox["b"]]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Rule]", 
       FractionBox["b", "d"]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "\[Rule]", "0"}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Beta]", "max"]}], 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", " ", "\[Mu]"}], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Theta]", "2"], " ", 
               SuperscriptBox["\[Mu]", "2"]}], "+", 
              RowBox[{"4", " ", "Vs", " ", 
               RowBox[{"(", 
                RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
               SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}]}]]}]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "max"]}], "+", 
         RowBox[{"\[Theta]", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", " ", "\[Mu]"}], "-", 
            SqrtBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Theta]", "2"], " ", 
               SuperscriptBox["\[Mu]", "2"]}], "+", 
              RowBox[{"4", " ", "Vs", " ", 
               RowBox[{"(", 
                RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
               SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}]}], 
        RowBox[{"2", " ", "Vs", " ", 
         SubsuperscriptBox["\[Beta]", "max", "2"]}]]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "\[Rule]", 
       RowBox[{
        FractionBox["b", 
         RowBox[{"d", "+", "\[Alpha]"}]], "-", 
        FractionBox["d", 
         SubscriptBox["\[Beta]", "max"]], "+", 
        FractionBox[
         RowBox[{"d", " ", "\[Theta]", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Theta]"}], " ", "\[Mu]"}], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Theta]", "2"], " ", 
               SuperscriptBox["\[Mu]", "2"]}], "+", 
              RowBox[{"4", " ", "Vs", " ", 
               RowBox[{"(", 
                RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
               SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}], 
         RowBox[{"2", " ", "Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
          SubsuperscriptBox["\[Beta]", "max", "2"]}]]}]}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Beta]", "max"]}], 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{"\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Theta]"}], " ", "\[Mu]"}], "+", 
           SqrtBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Theta]", "2"], " ", 
              SuperscriptBox["\[Mu]", "2"]}], "+", 
             RowBox[{"4", " ", "Vs", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
              SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "\[Alpha]"}], ")"}]}]]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "max"]}], "+", 
         RowBox[{"\[Theta]", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", " ", "\[Mu]"}], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Theta]", "2"], " ", 
               SuperscriptBox["\[Mu]", "2"]}], "+", 
              RowBox[{"4", " ", "Vs", " ", 
               RowBox[{"(", 
                RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
               SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}]}], 
        RowBox[{"2", " ", "Vs", " ", 
         SubsuperscriptBox["\[Beta]", "max", "2"]}]]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "\[Rule]", 
       RowBox[{
        FractionBox["b", 
         RowBox[{"d", "+", "\[Alpha]"}]], "-", 
        FractionBox["d", 
         SubscriptBox["\[Beta]", "max"]], "-", 
        FractionBox[
         RowBox[{"d", " ", "\[Theta]", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", " ", "\[Mu]"}], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Theta]", "2"], " ", 
               SuperscriptBox["\[Mu]", "2"]}], "+", 
              RowBox[{"4", " ", "Vs", " ", 
               RowBox[{"(", 
                RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
               SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}], 
         RowBox[{"2", " ", "Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", "\[Alpha]"}], ")"}], " ", 
          SubsuperscriptBox["\[Beta]", "max", "2"]}]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8786347198365803`*^9, 3.8786389700548477`*^9, 3.878639386369816*^9, {
   3.878639546452577*^9, 3.878639550622675*^9}, 3.878702605325181*^9, 
   3.878702768032773*^9, 3.87870279882727*^9, 3.878705124285076*^9, 
   3.878705165418228*^9, 3.878705240005233*^9, 3.878705749926897*^9, 
   3.8787141812926283`*^9, 3.878714520583877*^9, 3.878722496819064*^9, 
   3.879493366573205*^9, 3.8794934354258213`*^9, 3.879493568642495*^9, {
   3.879493646055051*^9, 3.8794936922540913`*^9}, 3.879494201724369*^9, 
   3.879504486544552*^9, 3.880606268626657*^9, 3.8806064359382677`*^9, 
   3.880687000473873*^9, 3.880687149703874*^9, 3.8806873232355337`*^9, 
   3.8818186011309233`*^9, 3.881989571435506*^9, 3.88199039650183*^9, 
   3.881991685870598*^9, 3.883479964193274*^9, 3.883626491751183*^9, 
   3.883725557360009*^9, 3.8840762117471457`*^9, 3.884076288748209*^9, 
   3.8840924662331944`*^9, 3.884145504239732*^9, 3.885527799754081*^9, 
   3.892699283696937*^9},
 CellLabel->
  "Out[589]//MatrixForm=",ExpressionUUID->"3cfac9e2-ea35-446a-88e3-\
7fb0ec9c07bd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Beta]", "max"]}], 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SqrtBox["d"], " ", 
          SqrtBox["Vs"], " ", "\[Mu]"}], 
         SqrtBox["b"]]}]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Rule]", 
       FractionBox["b", "d"]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "\[Rule]", "0"}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Beta]", "max"]}], 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{
         SqrtBox["d"], " ", 
         SqrtBox["Vs"], " ", "\[Mu]"}], 
        SqrtBox["b"]]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Rule]", 
       FractionBox["b", "d"]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "\[Rule]", "0"}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Beta]", "max"]}], 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]", "+", 
            RowBox[{"\[Theta]", " ", "\[Mu]"}]}], ")"}]}], 
         RowBox[{"2", " ", "\[Nu]"}]]}]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"\[Theta]", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[Gamma]"}], "+", 
            RowBox[{"\[Theta]", " ", "\[Mu]"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "Vs", " ", "\[Nu]", " ", 
          SubscriptBox["\[Beta]", "max"]}]}], 
        RowBox[{"2", " ", "Vs", " ", 
         SubsuperscriptBox["\[Beta]", "max", "2"]}]]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "\[Rule]", 
       RowBox[{
        FractionBox["b", "\[Nu]"], "+", 
        FractionBox[
         RowBox[{"d", " ", "\[Theta]", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]", "-", 
            RowBox[{"\[Theta]", " ", "\[Mu]"}]}], ")"}]}], 
         RowBox[{"2", " ", "Vs", " ", "\[Nu]", " ", 
          SubsuperscriptBox["\[Beta]", "max", "2"]}]], "-", 
        FractionBox["d", 
         SubscriptBox["\[Beta]", "max"]]}]}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Beta]", "max"]}], 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{"\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Gamma]", "-", 
           RowBox[{"\[Theta]", " ", "\[Mu]"}]}], ")"}]}], 
        RowBox[{"2", " ", "\[Nu]"}]]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"\[Theta]", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]", "+", 
            RowBox[{"\[Theta]", " ", "\[Mu]"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "Vs", " ", "\[Nu]", " ", 
          SubscriptBox["\[Beta]", "max"]}]}], 
        RowBox[{"2", " ", "Vs", " ", 
         SubsuperscriptBox["\[Beta]", "max", "2"]}]]}], 
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "\[Rule]", 
       RowBox[{
        FractionBox["b", "\[Nu]"], "-", 
        FractionBox[
         RowBox[{"d", " ", "\[Theta]", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]", "+", 
            RowBox[{"\[Theta]", " ", "\[Mu]"}]}], ")"}]}], 
         RowBox[{"2", " ", "Vs", " ", "\[Nu]", " ", 
          SubsuperscriptBox["\[Beta]", "max", "2"]}]], "-", 
        FractionBox["d", 
         SubscriptBox["\[Beta]", "max"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8786347198365803`*^9, 3.8786389700548477`*^9, 3.878639386369816*^9, {
   3.878639546452577*^9, 3.878639550622675*^9}, 3.878702605325181*^9, 
   3.878702768032773*^9, 3.87870279882727*^9, 3.878705124285076*^9, 
   3.878705165418228*^9, 3.878705240005233*^9, 3.878705749926897*^9, 
   3.8787141812926283`*^9, 3.878714520583877*^9, 3.878722496819064*^9, 
   3.879493366573205*^9, 3.8794934354258213`*^9, 3.879493568642495*^9, {
   3.879493646055051*^9, 3.8794936922540913`*^9}, 3.879494201724369*^9, 
   3.879504486544552*^9, 3.880606268626657*^9, 3.8806064359382677`*^9, 
   3.880687000473873*^9, 3.880687149703874*^9, 3.8806873232355337`*^9, 
   3.8818186011309233`*^9, 3.881989571435506*^9, 3.88199039650183*^9, 
   3.881991685870598*^9, 3.883479964193274*^9, 3.883626491751183*^9, 
   3.883725557360009*^9, 3.8840762117471457`*^9, 3.884076288748209*^9, 
   3.8840924662331944`*^9, 3.884145504239732*^9, 3.885527799754081*^9, 
   3.892699283701871*^9},
 CellLabel->
  "Out[590]//MatrixForm=",ExpressionUUID->"a1e6f919-b7bb-4897-a322-\
d39a43f66dcb"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", " ", "all", " ", "cases", " ", 
   SubsuperscriptBox["\[Beta]", "m", "*"]}], "=", 
  SubscriptBox["\[Beta]", "max"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "we", " ", "can", " ", "simplify", " ", "the", " ", "endemic", " ", 
   "equilibrium", " ", "by", " ", "introducing", " ", "\[Gamma]"}], 
  "\[Congruent]", 
  SqrtBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "2"], " ", 
     SuperscriptBox["\[Mu]", "2"]}], "+", 
    RowBox[{"4", " ", "Vs", " ", 
     RowBox[{"(", 
      RowBox[{"d", "+", "\[Alpha]", "+", " ", 
       RowBox[{"U", " ", "f"}]}], ")"}], " ", 
     SubscriptBox["\[Beta]", "max"]}]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "one", " ", "equilibrium", " ", "is", " ", "disease", " ", "free", " ", 
    RowBox[{"(", 
     RowBox[{"\[ScriptCapitalI]", "=", "0"}], ")"}]}], ":", 
   SubscriptBox["\[Sigma]", "*"]}], "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SqrtBox["d"], " ", 
      SqrtBox["Vs"], " ", "\[Mu]"}], 
     SqrtBox["b"]], " ", "and", " ", 
    SubscriptBox["\[ScriptCapitalS]", "*"]}], "=", 
   FractionBox["b", "d"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"one", " ", "equilibrium", " ", "is", " ", 
     RowBox[{"endemic", ":", "\[IndentingNewLine]", 
      SubscriptBox["\[Sigma]", "*"]}]}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"\[Gamma]", "-", 
         RowBox[{"\[Theta]", " ", "\[Mu]"}]}], ")"}]}], 
      RowBox[{"2", " ", "\[Nu]"}]], ">", "0"}]}], "  ", ",", "  ", 
   RowBox[{
    SubscriptBox["\[ScriptCapitalS]", "*"], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"\[Theta]", " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "+", 
          RowBox[{"\[Theta]", " ", "\[Mu]"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "Vs", " ", "\[Nu]", " ", 
        SubscriptBox["\[Beta]", "max"]}]}], 
      RowBox[{"2", " ", "Vs", " ", 
       SubsuperscriptBox["\[Beta]", "max", "2"]}]], ">", "0"}]}], "  ", ",", 
   RowBox[{
    SubscriptBox["\[ScriptCapitalI]", "*"], "=", 
    RowBox[{
     FractionBox["b", "\[Nu]"], "-", 
     FractionBox[
      RowBox[{"d", " ", "\[Theta]", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"\[Gamma]", "+", 
         RowBox[{"\[Theta]", " ", "\[Mu]"}]}], ")"}]}], 
      RowBox[{"2", " ", "Vs", " ", "\[Nu]", " ", 
       SubsuperscriptBox["\[Beta]", "max", "2"]}]], "-", 
     RowBox[{
      FractionBox["d", 
       SubscriptBox["\[Beta]", "max"]], 
      RowBox[{"(", 
       RowBox[{"check", " ", "conditions", " ", "for", " ", "positiveness"}], 
       ")"}]}]}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"The", " ", "other", " ", "two", " ", "equilibria", " ", "are", " ", 
  "not", " ", "feasible", " ", 
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["\[Sigma]", "*"], "<", "0"}], ")"}]}]}], "Text",
 CellChangeTimes->{
  3.8740628695810895`*^9, {3.8740629332869205`*^9, 3.8740629388509007`*^9}, {
   3.8740647852072887`*^9, 3.8740649995507336`*^9}, {3.874065031991229*^9, 
   3.874065045274669*^9}, {3.8740651388816423`*^9, 3.87406526436514*^9}, {
   3.878631213721753*^9, 3.878631213724112*^9}, 3.878704277724427*^9, {
   3.879493723604683*^9, 3.879493778186905*^9}, {3.8794938476228867`*^9, 
   3.879493861174737*^9}},ExpressionUUID->"0e739d68-7989-4b5a-8fde-\
cb4aeb3fc1a1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numeric resolution of ODE system", "Section",
 CellChangeTimes->{
  3.875589093957862*^9, {3.87742395856024*^9, 
   3.8774240330286837`*^9}},ExpressionUUID->"88fdbf1a-a955-4925-a85f-\
71155dbc98ee"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], 
      RowBox[{"\[ScriptCapitalM]", "[", 
       RowBox[{"z", ",", "t"}], "]"}]}], "/.", 
     RowBox[{"z", "->", "0"}]}], ")"}], "/.", "ansatz"}], " ", "//", 
  "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], 
      RowBox[{"Log", "[", 
       RowBox[{"\[ScriptCapitalM]", "[", 
        RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "/.", 
     RowBox[{"z", "->", "0"}]}], ")"}], "/.", "ansatz"}], "//", 
  "fs"}]}], "Input",
 CellChangeTimes->{{3.8786309900507193`*^9, 3.878630991067184*^9}, {
  3.878641567896934*^9, 3.878641584849855*^9}},
 CellLabel->
  "In[591]:=",ExpressionUUID->"3279a121-7e0c-4cc2-965f-a8c245811034"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[Theta]", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], "+", 
    RowBox[{
     SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.878630982015526*^9, 3.8786309923367357`*^9}, 
   3.8786347219245234`*^9, 3.878641534037961*^9, {3.878641574724783*^9, 
   3.878641585453721*^9}, 3.878702771776278*^9, 3.8787028018077517`*^9, 
   3.878705243045597*^9, 3.878705752988201*^9, 3.878714184080532*^9, 
   3.878714243147665*^9, 3.87871452311325*^9, 3.878722499381462*^9, 
   3.8794933691404953`*^9, 3.879493443688875*^9, 3.8794935732260847`*^9, 
   3.8794938795608892`*^9, 3.879494202788472*^9, 3.879504487451322*^9, 
   3.880606269902124*^9, 3.8806064370480127`*^9, 3.880687001385234*^9, 
   3.8806871506222754`*^9, 3.88068732413463*^9, 3.881818601972268*^9, 
   3.881989572429044*^9, 3.881990397371686*^9, 3.881991686722663*^9, 
   3.8834799649988823`*^9, 3.8836264924997396`*^9, 3.8837255581822643`*^9, 
   3.884076212613186*^9, 3.884076289621078*^9, 3.884092467170548*^9, 
   3.8841455051958723`*^9, 3.8855278005786037`*^9, 3.8926992837422333`*^9},
 CellLabel->
  "Out[591]=",ExpressionUUID->"60aa7406-48e9-48d9-9772-0ed65c951f0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[Theta]", " ", 
     RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"]}], "+", 
  RowBox[{
   SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{{3.878630982015526*^9, 3.8786309923367357`*^9}, 
   3.8786347219245234`*^9, 3.878641534037961*^9, {3.878641574724783*^9, 
   3.878641585453721*^9}, 3.878702771776278*^9, 3.8787028018077517`*^9, 
   3.878705243045597*^9, 3.878705752988201*^9, 3.878714184080532*^9, 
   3.878714243147665*^9, 3.87871452311325*^9, 3.878722499381462*^9, 
   3.8794933691404953`*^9, 3.879493443688875*^9, 3.8794935732260847`*^9, 
   3.8794938795608892`*^9, 3.879494202788472*^9, 3.879504487451322*^9, 
   3.880606269902124*^9, 3.8806064370480127`*^9, 3.880687001385234*^9, 
   3.8806871506222754`*^9, 3.88068732413463*^9, 3.881818601972268*^9, 
   3.881989572429044*^9, 3.881990397371686*^9, 3.881991686722663*^9, 
   3.8834799649988823`*^9, 3.8836264924997396`*^9, 3.8837255581822643`*^9, 
   3.884076212613186*^9, 3.884076289621078*^9, 3.884092467170548*^9, 
   3.8841455051958723`*^9, 3.8855278005786037`*^9, 3.892699283746231*^9},
 CellLabel->
  "Out[592]=",ExpressionUUID->"fc84609d-b17e-4095-b67b-75fbebe94f2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"murules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Mu]", "->", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"U", 
        RowBox[{"(", 
         RowBox[{"1", " ", "-", "f"}], ")"}], "*", "\[Lambda]"}], "]"}]}], 
     ",", " ", 
     RowBox[{"\[Alpha]", "->", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", "+", 
        RowBox[{"U", " ", "f"}]}], ")"}]}]}], "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"feqs", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"equils", " ", "/.", 
            RowBox[{
             SqrtBox[
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Theta]", "2"], " ", 
                SuperscriptBox["\[Mu]", "2"]}], "+", 
               RowBox[{"4", " ", "Vs", " ", 
                RowBox[{"(", 
                 RowBox[{"d", "+", "\[Alpha]", "+", " ", 
                  RowBox[{"U", " ", "f"}]}], ")"}], " ", 
                SubscriptBox["\[Beta]", "max"]}]}]], "->", "\[Gamma]"}]}], "/.",
            " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}], "->", 
            "\[Nu]"}]}], " ", "}"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], "/.", 
       RowBox[{"\[Gamma]", "->", 
        SqrtBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Theta]", "2"], " ", 
           SuperscriptBox["\[Mu]", "2"]}], "+", 
          RowBox[{"4", " ", "Vs", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "\[Alpha]", "+", " ", 
             RowBox[{"U", " ", "f"}]}], ")"}], " ", 
           SubscriptBox["\[Beta]", "max"]}]}]]}]}], " ", "/.", 
      RowBox[{"\[Nu]", "->", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "+", "d", "+", 
         RowBox[{"U", " ", "f"}]}], ")"}]}]}], "/.", "murules"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"feqs", "=", 
  RowBox[{
   RowBox[{"equils", "[", 
    RowBox[{"[", "4", "]"}], "]"}], "/.", 
   "murules"}]}], "\[IndentingNewLine]", 
 RowBox[{"ODEansatzfull", "=", 
  RowBox[{"ODEansatz", "/.", "murules"}]}]}], "Input",
 CellChangeTimes->{{3.878714261829276*^9, 3.878714309183518*^9}, {
   3.878714851952132*^9, 3.87871485995926*^9}, {3.8787225941114407`*^9, 
   3.8787226001377697`*^9}, {3.8794947286586933`*^9, 3.879494735514559*^9}, 
   3.881988956978413*^9, {3.881990198886815*^9, 3.88199021611296*^9}, {
   3.8819902604892893`*^9, 3.8819903133680067`*^9}},
 CellLabel->
  "In[593]:=",ExpressionUUID->"caf59ef8-7b09-4365-abe0-57a23687b84f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Mu]", "\[Rule]", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}]]}], ",", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    RowBox[{
     RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.87871431087323*^9, 3.8787143285304947`*^9}, 
   3.87871452314615*^9, 3.878714860371765*^9, 3.878722499421503*^9, 
   3.878722600655567*^9, 3.879493369164935*^9, 3.879493443715579*^9, 
   3.879493573252685*^9, 3.879493881360506*^9, 3.8794942028203373`*^9, 
   3.8794947425602303`*^9, 3.879504487481824*^9, 3.880606269946664*^9, 
   3.880606437082944*^9, 3.880687001414933*^9, 3.880687112177765*^9, 
   3.8806871506613903`*^9, 3.880687324163916*^9, 3.881818601996771*^9, 
   3.881988976818173*^9, 3.88198957246248*^9, {3.881990200312078*^9, 
   3.881990217293785*^9}, {3.8819902623824787`*^9, 3.881990313802021*^9}, 
   3.8819903974037447`*^9, 3.8819916867477617`*^9, 3.883479965018635*^9, 
   3.883626492538*^9, 3.8837255582125397`*^9, 3.884076212674543*^9, 
   3.8840762896577473`*^9, 3.884092467194734*^9, 3.884145505217245*^9, 
   3.8855278005969276`*^9, 3.892699283774057*^9},
 CellLabel->
  "Out[593]=",ExpressionUUID->"c8aa04e1-e3ad-4a38-8a07-246cbeb6a37d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Beta]", "m"], "[", "t", "]"}], "\[Rule]", 
    SubscriptBox["\[Beta]", "max"]}], ",", 
   RowBox[{
    RowBox[{"\[Sigma]", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Theta]"}], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}]]}], 
        "+", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", 
           SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "+", 
          RowBox[{"4", " ", "Vs", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", 
             RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}], " ", 
           SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"d", "+", 
        RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}]}]]}], ",", 
   RowBox[{
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", "Vs", " ", 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}], " ", 
       SubscriptBox["\[Beta]", "max"]}], "+", 
      RowBox[{"\[Theta]", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Theta]", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}]]}], 
         "+", 
         SqrtBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", 
            SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "+", 
           RowBox[{"4", " ", "Vs", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}], " ", 
            SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}]}], 
     RowBox[{"2", " ", "Vs", " ", 
      SubsuperscriptBox["\[Beta]", "max", "2"]}]]}], ",", 
   RowBox[{
    RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["b", 
      RowBox[{"d", "+", 
       RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}]], "-", 
     FractionBox["d", 
      SubscriptBox["\[Beta]", "max"]], "-", 
     FractionBox[
      RowBox[{"d", " ", "\[Theta]", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Theta]", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}]]}], 
         "+", 
         SqrtBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", 
            SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "+", 
           RowBox[{"4", " ", "Vs", " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}], " ", 
            SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}], 
      RowBox[{"2", " ", "Vs", " ", 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "max", "2"]}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.87871431087323*^9, 3.8787143285304947`*^9}, 
   3.87871452314615*^9, 3.878714860371765*^9, 3.878722499421503*^9, 
   3.878722600655567*^9, 3.879493369164935*^9, 3.879493443715579*^9, 
   3.879493573252685*^9, 3.879493881360506*^9, 3.8794942028203373`*^9, 
   3.8794947425602303`*^9, 3.879504487481824*^9, 3.880606269946664*^9, 
   3.880606437082944*^9, 3.880687001414933*^9, 3.880687112177765*^9, 
   3.8806871506613903`*^9, 3.880687324163916*^9, 3.881818601996771*^9, 
   3.881988976818173*^9, 3.88198957246248*^9, {3.881990200312078*^9, 
   3.881990217293785*^9}, {3.8819902623824787`*^9, 3.881990313802021*^9}, 
   3.8819903974037447`*^9, 3.8819916867477617`*^9, 3.883479965018635*^9, 
   3.883626492538*^9, 3.8837255582125397`*^9, 3.884076212674543*^9, 
   3.8840762896577473`*^9, 3.884092467194734*^9, 3.884145505217245*^9, 
   3.8855278005969276`*^9, 3.892699283778693*^9},
 CellLabel->
  "Out[594]=",ExpressionUUID->"fc7e1c75-b5aa-4f0b-8c9d-857014916a0a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Beta]", "m"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Beta]", "max"], "-", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}], "Vs"]}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Sigma]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Sigma]", "[", "t", "]"}], "2"]}], "Vs"]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalS]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{"b", "+", 
     RowBox[{
      RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", 
        RowBox[{
         RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "Vs"], "-", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], 
       ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ScriptCapitalI]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Vs", " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", " ", 
             RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
            RowBox[{"Vs", " ", 
             RowBox[{
              SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}]}], 
        ")"}]}], "Vs"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.87871431087323*^9, 3.8787143285304947`*^9}, 
   3.87871452314615*^9, 3.878714860371765*^9, 3.878722499421503*^9, 
   3.878722600655567*^9, 3.879493369164935*^9, 3.879493443715579*^9, 
   3.879493573252685*^9, 3.879493881360506*^9, 3.8794942028203373`*^9, 
   3.8794947425602303`*^9, 3.879504487481824*^9, 3.880606269946664*^9, 
   3.880606437082944*^9, 3.880687001414933*^9, 3.880687112177765*^9, 
   3.8806871506613903`*^9, 3.880687324163916*^9, 3.881818601996771*^9, 
   3.881988976818173*^9, 3.88198957246248*^9, {3.881990200312078*^9, 
   3.881990217293785*^9}, {3.8819902623824787`*^9, 3.881990313802021*^9}, 
   3.8819903974037447`*^9, 3.8819916867477617`*^9, 3.883479965018635*^9, 
   3.883626492538*^9, 3.8837255582125397`*^9, 3.884076212674543*^9, 
   3.8840762896577473`*^9, 3.884092467194734*^9, 3.884145505217245*^9, 
   3.8855278005969276`*^9, 3.892699283783896*^9},
 CellLabel->
  "Out[595]=",ExpressionUUID->"3077f676-b4cd-4526-8e8e-a2488b97654b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ieq", "=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalI]", "[", "t", "]"}], "/.", 
   "feqs"}]}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"ieq", "==", "0"}], ",", "U"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8855277810666656`*^9, 3.885527808029785*^9}},
 CellLabel->
  "In[596]:=",ExpressionUUID->"3adbd5cd-611c-4238-a416-a9b68ec61f34"],

Cell[BoxData[
 RowBox[{
  FractionBox["b", 
   RowBox[{"d", "+", 
    RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}]], "-", 
  FractionBox["d", 
   SubscriptBox["\[Beta]", "max"]], "-", 
  FractionBox[
   RowBox[{"d", " ", "\[Theta]", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", "\[Lambda]"}]]}], 
      "+", 
      SqrtBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "f"}], ")"}], " ", "U", " ", 
         SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "+", 
        RowBox[{"4", " ", "Vs", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}], " ", 
         SubscriptBox["\[Beta]", "max"]}]}]]}], ")"}]}], 
   RowBox[{"2", " ", "Vs", " ", 
    RowBox[{"(", 
     RowBox[{"d", "+", 
      RowBox[{"f", " ", "U"}], "+", "\[Alpha]"}], ")"}], " ", 
    SubsuperscriptBox["\[Beta]", "max", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.885527800660594*^9, 3.885527808416975*^9}, 
   3.8926992838116627`*^9},
 CellLabel->
  "Out[596]=",ExpressionUUID->"63bfc4b8-7d42-488c-a89e-1411dc34b369"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "nongen", 
   "\"Solutions may not be valid for all values of parameters.\"", 2, 597, 
   122, 33860057889096928252, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.885527808511334*^9, 3.892699283888344*^9},
 CellLabel->
  "Lors de l\[CloseCurlyQuote]\[EAcute]valuation de \
In[596]:=",ExpressionUUID->"6def3195-d0f6-4a9d-b432-bd000397e055"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", "\[Rule]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["f", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "f"}], "+", 
           RowBox[{"2", " ", "d", " ", "f", " ", "\[Alpha]"}], "-", 
           FractionBox[
            RowBox[{"b", " ", 
             SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "Vs"], "+", 
           FractionBox[
            RowBox[{"b", " ", "f", " ", 
             SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "Vs"], "-", 
           RowBox[{"2", " ", "b", " ", "f", " ", 
            SubscriptBox["\[Beta]", "max"]}]}], ")"}]}], "-", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["d", "2"], " ", "f"}], "+", 
               RowBox[{"2", " ", "d", " ", "f", " ", "\[Alpha]"}], "-", 
               FractionBox[
                RowBox[{"b", " ", 
                 SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "Vs"], 
               "+", 
               FractionBox[
                RowBox[{"b", " ", "f", " ", 
                 SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "Vs"], 
               "-", 
               RowBox[{"2", " ", "b", " ", "f", " ", 
                SubscriptBox["\[Beta]", "max"]}]}], ")"}], "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["f", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["d", "4"], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d", "3"], " ", "\[Alpha]"}], "+", 
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               SuperscriptBox["\[Alpha]", "2"]}], "-", 
              RowBox[{"2", " ", "b", " ", 
               SuperscriptBox["d", "2"], " ", 
               SubscriptBox["\[Beta]", "max"]}], "-", 
              RowBox[{"2", " ", "b", " ", "d", " ", "\[Alpha]", " ", 
               SubscriptBox["\[Beta]", "max"]}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], " ", 
               SubsuperscriptBox["\[Beta]", "max", "2"]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"U", "\[Rule]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["f", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "f"}], "+", 
           RowBox[{"2", " ", "d", " ", "f", " ", "\[Alpha]"}], "-", 
           FractionBox[
            RowBox[{"b", " ", 
             SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "Vs"], "+", 
           FractionBox[
            RowBox[{"b", " ", "f", " ", 
             SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "Vs"], "-", 
           RowBox[{"2", " ", "b", " ", "f", " ", 
            SubscriptBox["\[Beta]", "max"]}]}], ")"}]}], "+", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["d", "2"], " ", "f"}], "+", 
               RowBox[{"2", " ", "d", " ", "f", " ", "\[Alpha]"}], "-", 
               FractionBox[
                RowBox[{"b", " ", 
                 SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "Vs"], 
               "+", 
               FractionBox[
                RowBox[{"b", " ", "f", " ", 
                 SuperscriptBox["\[Theta]", "2"], " ", "\[Lambda]"}], "Vs"], 
               "-", 
               RowBox[{"2", " ", "b", " ", "f", " ", 
                SubscriptBox["\[Beta]", "max"]}]}], ")"}], "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["f", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["d", "4"], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d", "3"], " ", "\[Alpha]"}], "+", 
              RowBox[{
               SuperscriptBox["d", "2"], " ", 
               SuperscriptBox["\[Alpha]", "2"]}], "-", 
              RowBox[{"2", " ", "b", " ", 
               SuperscriptBox["d", "2"], " ", 
               SubscriptBox["\[Beta]", "max"]}], "-", 
              RowBox[{"2", " ", "b", " ", "d", " ", "\[Alpha]", " ", 
               SubscriptBox["\[Beta]", "max"]}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], " ", 
               SubsuperscriptBox["\[Beta]", "max", "2"]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.885527800660594*^9, 3.885527808416975*^9}, 
   3.89269928389555*^9},
 CellLabel->
  "Out[597]=",ExpressionUUID->"44e4752d-132d-49fa-b3ff-567407d58842"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Lambda]", "=."}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff", "[", "z_", "]"}], "=", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["\[Beta]", "i"]}], "+", 
        SubscriptBox["\[Beta]", "max"]}], ")"}]}], 
     RowBox[{"Vs", "+", 
      RowBox[{"z", " ", "\[Lambda]"}]}]]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"z", " ", "\[Lambda]"}], "Vs"]}], ")"}], 
    RowBox[{
     RowBox[{"-", "n"}], "/", "2"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"ff", "[", "z", "]"}], ",", "z"}], "]"}], ",", "z"}], "]"}], "/.", 
  RowBox[{"z", "->", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"ff", "[", "z", "]"}], ",", "z"}], "]"}], "/.", 
  RowBox[{"z", "->", "0"}]}]}], "Input",
 CellChangeTimes->{{3.885529064498617*^9, 3.8855290985091763`*^9}, {
  3.88684405633298*^9, 3.886844067622086*^9}, {3.886844106229364*^9, 
  3.886844111386876*^9}},
 CellLabel->
  "In[598]:=",ExpressionUUID->"d73523ef-2707-4ea9-94dd-4359c6949296"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", "\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["\[Beta]", "i"]}], "+", 
       SubscriptBox["\[Beta]", "max"]}], ")"}]}], 
    RowBox[{"Vs", "+", 
     RowBox[{"z", " ", "\[Lambda]"}]}]]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"z", " ", "\[Lambda]"}], "Vs"]}], ")"}], 
   RowBox[{
    RowBox[{"-", "n"}], "/", "2"}]]}]], "Output",
 CellChangeTimes->{{3.8855290869888983`*^9, 3.885529100942415*^9}, 
   3.886844071727419*^9, 3.88684411169836*^9, 3.8926992839252253`*^9},
 CellLabel->
  "Out[599]=",ExpressionUUID->"e6dabe53-a41c-4c96-a1af-1925df39c039"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       FractionBox["n", "2"]}], ")"}], " ", "n", " ", 
     SuperscriptBox["\[Lambda]", "2"]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["Vs", "2"]}]]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Lambda]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[Beta]", "i"]}], "+", 
      SubscriptBox["\[Beta]", "max"]}], ")"}]}], "Vs"]}]], "Output",
 CellChangeTimes->{{3.8855290869888983`*^9, 3.885529100942415*^9}, 
   3.886844071727419*^9, 3.88684411169836*^9, 3.89269928392868*^9},
 CellLabel->
  "Out[600]=",ExpressionUUID->"ddbf639d-8dc5-4408-97e1-59996f69176b"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"n", " ", "\[Lambda]"}], 
   RowBox[{"2", " ", "Vs"}]]}]], "Output",
 CellChangeTimes->{{3.8855290869888983`*^9, 3.885529100942415*^9}, 
   3.886844071727419*^9, 3.88684411169836*^9, 3.892699283932107*^9},
 CellLabel->
  "Out[601]=",ExpressionUUID->"c2315339-5bae-4e93-99f1-cca4cb43d7c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", 
          FractionBox["n", "2"]}], ")"}], " ", "n", " ", 
        SuperscriptBox["\[Lambda]", "2"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Vs", "2"]}]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"+", 
          SubscriptBox["\[Beta]", "i"]}], "-", 
         SubscriptBox["\[Beta]", "max"]}], ")"}]}], "Vs"]}], " ", "==", " ", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", 
       SuperscriptBox["Vs", "2"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          FractionBox["n", "2"]}], ")"}], " ", "n", " ", 
        SuperscriptBox["\[Lambda]", "2"]}], "+", 
       RowBox[{"4", " ", "Vs", " ", "\[Lambda]", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Beta]", "max"], "-", 
          SubscriptBox["\[Beta]", "i"]}], ")"}]}]}], ")"}]}]}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Beta]", "max"], "-", 
      SubscriptBox["\[Beta]", "i"]}], ")"}], "->", 
    FractionBox[
     RowBox[{"g", "^", "2"}], 
     RowBox[{"2", " ", "Vs"}]]}]}], "//", "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", 
      SuperscriptBox["Vs", "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox["n", "2"]}], ")"}], " ", "n", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "+", 
      RowBox[{"4", " ", "Vs", " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Beta]", "max"], "-", 
         SubscriptBox["\[Beta]", "i"]}], ")"}]}]}], ")"}]}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Beta]", "max"], "-", 
      SubscriptBox["\[Beta]", "i"]}], ")"}], "->", 
    FractionBox[
     RowBox[{"g", "^", "2"}], 
     RowBox[{"2", " ", "Vs"}]]}]}], "//", 
  "fs"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.886844453908873*^9, 3.886844457595091*^9}, {
  3.886844772287664*^9, 3.886844998316017*^9}},
 CellLabel->
  "In[602]:=",ExpressionUUID->"f9c6e50e-c96d-4e6d-a866-2a5645101d0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["g", "2"], "Vs"], "+", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Beta]", "i"]}], "-", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Beta]", "max"]}]}], ")"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.886844784048828*^9, 3.886844815942819*^9}, 
   3.886844850100355*^9, {3.8868449257119503`*^9, 3.8868449477018538`*^9}, {
   3.8868449865870647`*^9, 3.886844998835943*^9}, 3.892699283982045*^9},
 CellLabel->
  "Out[602]=",ExpressionUUID->"57749dbc-9321-4b82-b3a1-a83aa8a11bfc"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox["g", "2"]}], "+", 
     RowBox[{"n", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "n"}], ")"}], " ", "\[Lambda]"}]}], ")"}]}], 
  RowBox[{"4", " ", 
   SuperscriptBox["Vs", "2"]}]]], "Output",
 CellChangeTimes->{{3.886844784048828*^9, 3.886844815942819*^9}, 
   3.886844850100355*^9, {3.8868449257119503`*^9, 3.8868449477018538`*^9}, {
   3.8868449865870647`*^9, 3.886844998835943*^9}, 3.8926992840030127`*^9},
 CellLabel->
  "Out[603]=",ExpressionUUID->"502d8031-39b8-4e81-830a-2ca5fe28564a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "t"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], 
          RowBox[{"Log", "[", 
           RowBox[{"\[ScriptCapitalM]", "[", 
            RowBox[{"z", ",", "t"}], "]"}], "]"}]}]}]}], "/.", 
       RowBox[{"z", "->", "0"}]}], ")"}], "/.", "ansatz"}], "/.", "rates"}], "/.", 
   RowBox[{
    SuperscriptBox["\[Mu]", "2"], "->", "0"}]}], "//", 
  "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], 
        RowBox[{"Log", "[", 
         RowBox[{"\[ScriptCapitalM]", "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}]}]}], "/.", 
      RowBox[{"z", "->", "0"}]}], ")"}], "/.", "ansatz"}], "/.", "rates"}], "//",
   "fs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%%", "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Var", "==", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[PartialD]", "z"], 
             RowBox[{
              SubscriptBox["\[PartialD]", "z"], 
              RowBox[{"Log", "[", 
               RowBox[{"\[ScriptCapitalM]", "[", 
                RowBox[{"z", ",", "t"}], "]"}], "]"}]}]}], "/.", 
            RowBox[{"z", "->", "0"}]}], ")"}]}], "/.", "ansatz"}], "/.", 
        "rates"}], "//", "fs"}], ",", "\[Theta]"}], "]"}]}], "//", "fs"}], "//",
   "First"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "==", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}], " "}], "Vs"]}], 
    RowBox[{"(", 
     RowBox[{"Var", " ", "+", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Beta]", "max"], "-", 
          RowBox[{
           SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], "Vs"]}]}], 
     ")"}]}]}], "//", "fs"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.892699243069067*^9, 3.892699243385655*^9}, {
  3.8927008351900997`*^9, 3.8927008532247143`*^9}, {3.892700884593453*^9, 
  3.892700897821563*^9}, {3.892700950950498*^9, 3.892700989687916*^9}, {
  3.892701155977819*^9, 3.892701237183805*^9}, {3.89270127059404*^9, 
  3.892701297195662*^9}, {3.892701370139285*^9, 3.892701422722027*^9}, {
  3.892701526698381*^9, 3.89270156164436*^9}},
 CellLabel->
  "In[660]:=",ExpressionUUID->"3ac09311-b3a4-4cd5-8e09-d782570f6717"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "t", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "Vs", " ", 
       SubscriptBox["\[Beta]", "max"]}], "+", 
      RowBox[{"\[Theta]", " ", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
      RowBox[{"3", " ", "Vs", " ", 
       RowBox[{
        SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
   SuperscriptBox["Vs", "3"]]}]], "Output",
 CellChangeTimes->{
  3.8926992495911293`*^9, 3.892699284032131*^9, {3.8927008385277042`*^9, 
   3.892700854071776*^9}, {3.892700885608797*^9, 3.892700898712858*^9}, {
   3.892700956140862*^9, 3.892700990182499*^9}, {3.8927012283983297`*^9, 
   3.892701237636519*^9}, 3.892701272389654*^9, {3.892701401574153*^9, 
   3.89270142320671*^9}, {3.892701548861823*^9, 3.892701562826898*^9}, 
   3.892701776441708*^9},
 CellLabel->
  "Out[660]=",ExpressionUUID->"22c351d9-949e-4a7a-b090-4aa26004d89b"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "Vs", " ", 
      SubscriptBox["\[Beta]", "max"]}], "+", 
     RowBox[{"\[Theta]", " ", 
      RowBox[{"\[Sigma]", "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", "Vs", " ", 
      RowBox[{
       SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}]}], ")"}]}], 
  SuperscriptBox["Vs", "2"]]], "Output",
 CellChangeTimes->{
  3.8926992495911293`*^9, 3.892699284032131*^9, {3.8927008385277042`*^9, 
   3.892700854071776*^9}, {3.892700885608797*^9, 3.892700898712858*^9}, {
   3.892700956140862*^9, 3.892700990182499*^9}, {3.8927012283983297`*^9, 
   3.892701237636519*^9}, 3.892701272389654*^9, {3.892701401574153*^9, 
   3.89270142320671*^9}, {3.892701548861823*^9, 3.892701562826898*^9}, 
   3.892701776445821*^9},
 CellLabel->
  "Out[661]=",ExpressionUUID->"1d4bc2e5-b591-4bb8-8baa-e5acaffedfef"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Var", " ", "Vs"}], "+", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Beta]", "max"], "-", 
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
   SuperscriptBox["Vs", "2"]]}]], "Output",
 CellChangeTimes->{
  3.8926992495911293`*^9, 3.892699284032131*^9, {3.8927008385277042`*^9, 
   3.892700854071776*^9}, {3.892700885608797*^9, 3.892700898712858*^9}, {
   3.892700956140862*^9, 3.892700990182499*^9}, {3.8927012283983297`*^9, 
   3.892701237636519*^9}, 3.892701272389654*^9, {3.892701401574153*^9, 
   3.89270142320671*^9}, {3.892701548861823*^9, 3.892701562826898*^9}, 
   3.892701776449971*^9},
 CellLabel->
  "Out[662]=",ExpressionUUID->"9268751b-9d0f-48e3-9831-c2dc7394086a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.8926992495911293`*^9, 3.892699284032131*^9, {3.8927008385277042`*^9, 
   3.892700854071776*^9}, {3.892700885608797*^9, 3.892700898712858*^9}, {
   3.892700956140862*^9, 3.892700990182499*^9}, {3.8927012283983297`*^9, 
   3.892701237636519*^9}, 3.892701272389654*^9, {3.892701401574153*^9, 
   3.89270142320671*^9}, {3.892701548861823*^9, 3.892701562826898*^9}, 
   3.892701776454536*^9},
 CellLabel->
  "Out[663]=",ExpressionUUID->"e3a7b570-3f99-4934-840f-bc6d10448873"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "t"], 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], 
            RowBox[{
             SubscriptBox["\[PartialD]", "z"], 
             RowBox[{"Log", "[", 
              RowBox[{"\[ScriptCapitalM]", "[", 
               RowBox[{"z", ",", "t"}], "]"}], "]"}]}]}]}], "/.", 
          RowBox[{"z", "->", "0"}]}], ")"}], "/.", "ansatz"}], "/.", 
       "rates"}], ")"}], "-", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[PartialD]", "t"], 
            RowBox[{
             SubscriptBox["\[PartialD]", "z"], 
             RowBox[{
              SubscriptBox["\[PartialD]", "z"], 
              RowBox[{"Log", "[", 
               RowBox[{"\[ScriptCapitalM]", "[", 
                RowBox[{"z", ",", "t"}], "]"}], "]"}]}]}]}], "/.", 
           RowBox[{"z", "->", "0"}]}], ")"}], "/.", "ansatz"}], "/.", 
        "rates"}], "/.", 
       RowBox[{
        SuperscriptBox["\[Mu]", "2"], "->", "0"}]}], ")"}]}], "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Var", "==", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[PartialD]", "z"], 
             RowBox[{
              SubscriptBox["\[PartialD]", "z"], 
              RowBox[{"Log", "[", 
               RowBox[{"\[ScriptCapitalM]", "[", 
                RowBox[{"z", ",", "t"}], "]"}], "]"}]}]}], "/.", 
            RowBox[{"z", "->", "0"}]}], ")"}]}], "/.", "ansatz"}], "/.", 
        "rates"}], "//", "fs"}], ",", "\[Theta]"}], "]"}]}], " ", "//", 
   "fs"}], "//", "First"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "==", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Mu]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["Var", 
       RowBox[{"\[Sigma]", "[", "t", "]"}]], "-", " ", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Beta]", "max"], "-", 
         RowBox[{
          SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], "Vs"]}], 
     ")"}]}]}], "//", "fs"}]}], "Input",
 CellChangeTimes->{{3.892701577810007*^9, 3.89270167904503*^9}, {
  3.892701718874984*^9, 3.8927017870184317`*^9}},
 CellLabel->
  "In[668]:=",ExpressionUUID->"cfed2de2-1361-47d5-bc81-e0e761b56f04"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["\[Mu]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Var", " ", "Vs"}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["\[Beta]", "max"]}], "+", 
        RowBox[{
         SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"Vs", " ", 
   RowBox[{"\[Sigma]", "[", "t", "]"}]}]]], "Output",
 CellChangeTimes->{{3.892701633243729*^9, 3.892701660810388*^9}, {
  3.8927017451550093`*^9, 3.8927017878804493`*^9}},
 CellLabel->
  "Out[668]=",ExpressionUUID->"fdf8e1b5-6044-4b4b-ac45-c559556b6568"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.892701633243729*^9, 3.892701660810388*^9}, {
  3.8927017451550093`*^9, 3.892701787885868*^9}},
 CellLabel->
  "Out[669]=",ExpressionUUID->"cefff432-733d-4a24-bb20-c42cec3beb2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["dynamique variance", "Subsubsection",
 CellChangeTimes->{{3.8927019117460203`*^9, 
  3.892701920254575*^9}},ExpressionUUID->"c2edc714-2f0f-45b6-b0de-\
b4cb24e72b0e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "t"], 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], 
            RowBox[{"Log", "[", 
             RowBox[{"\[ScriptCapitalM]", "[", 
              RowBox[{"z", ",", "t"}], "]"}], "]"}]}]}]}], "/.", 
         RowBox[{"z", "->", "0"}]}], ")"}], "/.", "ansatz"}], "/.", "rates"}],
      ")"}], " ", "==", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptCapitalS]", "[", "t", "]"}], " ", 
         RowBox[{"\[Sigma]", "[", "t", "]"}], " "}], "Vs"]}], 
      RowBox[{"(", 
       RowBox[{"Var", " ", "+", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", "t", "]"}], " ", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Beta]", "max"], "-", 
            RowBox[{
             SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], 
          "Vs"]}]}], ")"}]}], "+", " ", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[Mu]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"Var", " "}], 
         RowBox[{"\[Sigma]", "[", "t", "]"}]], "-", " ", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Beta]", "max"], "-", 
           RowBox[{
            SubscriptBox["\[Beta]", "m"], "[", "t", "]"}]}], ")"}], "Vs"]}], 
       ")"}]}]}]}], " ", "/.", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Var", "==", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], 
            RowBox[{
             SubscriptBox["\[PartialD]", "z"], 
             RowBox[{"Log", "[", 
              RowBox[{"\[ScriptCapitalM]", "[", 
               RowBox[{"z", ",", "t"}], "]"}], "]"}]}]}], "/.", 
           RowBox[{"z", "->", "0"}]}], ")"}]}], "/.", "ansatz"}], "/.", 
       "rates"}], "//", "fs"}], ",", "\[Theta]"}], "]"}]}], " ", "//", 
  "fs"}]], "Input",
 CellChangeTimes->{{3.892701814143221*^9, 3.8927019038913803`*^9}},
 CellLabel->
  "In[676]:=",ExpressionUUID->"62ca8d70-df03-41d2-a3de-7772eff2e155"],

Cell[BoxData[
 RowBox[{"{", "True", "}"}]], "Output",
 CellChangeTimes->{{3.892701832705429*^9, 3.8927019046993237`*^9}},
 CellLabel->
  "Out[676]=",ExpressionUUID->"f7a234af-57cf-45d5-b6e6-d6a09b539396"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{720, 711},
WindowMargins->{{2160, Automatic}, {Automatic, 75}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>0.9 Inherited,
FrontEndVersion->"12.3 pour Linux x86 (64-bit) (May 11, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"c9102f35-34e7-4156-83e7-08c488130570"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 778, 14, 228, "Input",ExpressionUUID->"536ea6ac-b5fa-40e3-be49-c9b6c7a5ed33"],
Cell[CellGroupData[{
Cell[1361, 38, 321, 6, 31, "Subsection",ExpressionUUID->"e6c306eb-91d2-48f1-96eb-7d19a49beeb7"],
Cell[1685, 46, 6284, 170, 518, "Text",ExpressionUUID->"6f97f211-e51e-4d6a-8212-2770fc533b87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8006, 221, 184, 3, 31, "Subsection",ExpressionUUID->"f49fa25a-a2f4-409e-b6b0-e77ea8b4f653"],
Cell[CellGroupData[{
Cell[8215, 228, 177, 3, 29, "Subsubsection",ExpressionUUID->"d48b8467-67b1-4902-9a04-3e7a93029334"],
Cell[8395, 233, 2604, 74, 169, "Text",ExpressionUUID->"8d503361-fe4c-4b04-ad17-d67f3fb80dcd"],
Cell[CellGroupData[{
Cell[11024, 311, 1579, 45, 75, "Input",ExpressionUUID->"db52e037-633c-4d8f-8b1c-2aa53d3f0716"],
Cell[12606, 358, 1708, 34, 36, "Output",ExpressionUUID->"fa94bf7e-6b41-40d1-820a-915e524189e4"],
Cell[14317, 394, 1232, 18, 36, "Output",ExpressionUUID->"cad3123a-4fe5-4519-9472-4bc1cad945ff"]
}, Open  ]],
Cell[15564, 415, 2094, 63, 126, "Text",ExpressionUUID->"6e767364-b88f-4d2b-80de-17af69a37b88"],
Cell[CellGroupData[{
Cell[17683, 482, 299, 8, 36, "Input",ExpressionUUID->"54917e69-a9a3-4c4c-ad69-90c3a68a6d02"],
Cell[17985, 492, 1282, 21, 36, "Output",ExpressionUUID->"e128fa5a-1d81-4455-9021-3537ea9d93d0"]
}, Open  ]],
Cell[19282, 516, 3530, 103, 320, "Text",ExpressionUUID->"1c313396-4457-451f-8d68-183b4e5dea34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22849, 624, 228, 4, 29, "Subsubsection",ExpressionUUID->"d0ea5377-63e4-4fee-970e-35f8a47d67e5"],
Cell[23080, 630, 4889, 132, 253, "Text",ExpressionUUID->"5b2097d6-ba07-438a-b538-69ec997190cb"],
Cell[CellGroupData[{
Cell[27994, 766, 720, 22, 52, "Input",ExpressionUUID->"3b171f0b-2c6c-436e-9e38-e4510d808306"],
Cell[28717, 790, 1462, 27, 36, "Output",ExpressionUUID->"d5efc3da-d9e6-4c47-b72c-44d5b8e9f01d"]
}, Open  ]],
Cell[30194, 820, 3801, 103, 247, "Text",ExpressionUUID->"ddfe2e3a-e2fb-4833-b8a1-3d290e32af46"],
Cell[CellGroupData[{
Cell[34020, 927, 878, 24, 72, "Input",ExpressionUUID->"715dfae2-de2c-4d8b-b340-0be761ea02d7"],
Cell[34901, 953, 1698, 33, 36, "Output",ExpressionUUID->"bb0e15d1-be8c-40a2-a72c-4c5215cc73b6"],
Cell[36602, 988, 1503, 28, 36, "Output",ExpressionUUID->"73bd4ac4-7aa5-4d4b-a251-0dec24aa0ad9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38154, 1022, 183, 3, 29, "Subsubsection",ExpressionUUID->"fd9ae574-5a78-4dbf-b729-34331b3d18b5"],
Cell[38340, 1027, 306, 7, 51, "Text",ExpressionUUID->"91899259-e70b-400d-bec0-b4eab6949882"],
Cell[CellGroupData[{
Cell[38671, 1038, 1518, 39, 184, "Input",ExpressionUUID->"73fdce5b-5d9d-40d2-b4df-73027ce10d95"],
Cell[40192, 1079, 1778, 35, 77, "Output",ExpressionUUID->"aa7da20f-e8ba-4142-9a79-7c301c0d715c"],
Cell[41973, 1116, 1865, 40, 38, "Output",ExpressionUUID->"bd4951cb-8323-4f35-88be-c6b62e546af6"],
Cell[43841, 1158, 1771, 35, 76, "Output",ExpressionUUID->"98655dc0-b08d-4f46-a52f-63bb2d674e8c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45661, 1199, 259, 4, 29, "Subsubsection",ExpressionUUID->"6fc2e172-134a-4c52-9fb0-f7b4ba1ec051"],
Cell[45923, 1205, 942, 23, 75, "Text",ExpressionUUID->"5cef803c-5010-474b-a148-f42ed6931ccc"],
Cell[46868, 1230, 1228, 28, 130, "Text",ExpressionUUID->"7dd6d6a3-f409-4e00-bd43-aa1923be202f"],
Cell[CellGroupData[{
Cell[48121, 1262, 1258, 34, 162, "Input",ExpressionUUID->"c6d8c6d3-7b2b-472c-bb5d-1df6aa227b48"],
Cell[49382, 1298, 1229, 18, 36, "Output",ExpressionUUID->"36e1887f-e910-4d5d-b246-5fab24a35bcd"]
}, Open  ]],
Cell[50626, 1319, 951, 24, 67, "Text",ExpressionUUID->"ce997b99-090d-4551-bbb5-6046ebedacc1"],
Cell[CellGroupData[{
Cell[51602, 1347, 963, 24, 144, "Input",ExpressionUUID->"c401161e-0aff-45cc-8505-07db468e71c6"],
Cell[52568, 1373, 748, 19, 53, "Output",ExpressionUUID->"7b9e5a63-576f-4137-950d-6a7855f88780"],
Cell[53319, 1394, 822, 20, 53, "Output",ExpressionUUID->"e577c1cf-1686-4537-9045-f14b74ffeae5"],
Cell[54144, 1416, 796, 20, 53, "Output",ExpressionUUID->"b2e5f0fb-93fb-4242-a06f-454f3b24fa47"],
Cell[54943, 1438, 902, 23, 47, "Output",ExpressionUUID->"8513d635-aae8-4568-8c96-064020407e2e"]
}, Open  ]],
Cell[55860, 1464, 1531, 39, 95, "Text",ExpressionUUID->"34eb4cfb-4963-4b7d-9cf2-fb68f28e8d56"],
Cell[CellGroupData[{
Cell[57416, 1507, 893, 26, 87, "Input",ExpressionUUID->"f2c5e82b-1cff-489c-aabe-86ec205d5720"],
Cell[58312, 1535, 1728, 34, 62, "Output",ExpressionUUID->"db6c7723-fd20-4f8a-bda5-5203e63008e7"],
Cell[60043, 1571, 1450, 26, 62, "Output",ExpressionUUID->"df205a76-a9e6-42c6-b922-9c2176593169"]
}, Open  ]],
Cell[61508, 1600, 4051, 114, 167, "Text",ExpressionUUID->"f1b40fcd-09ac-46d7-b968-e21eefc071ec"],
Cell[CellGroupData[{
Cell[65584, 1718, 2030, 60, 99, "Input",ExpressionUUID->"5bb48c56-6c04-4f80-b4f8-8a3c0974b403"],
Cell[67617, 1780, 1306, 19, 36, "Output",ExpressionUUID->"913c9b72-5a18-4c65-8c7c-3ce02da0c97e"],
Cell[68926, 1801, 1804, 36, 54, "Output",ExpressionUUID->"c15f0c3e-be84-42be-982a-ef745cb27e7a"]
}, Open  ]],
Cell[70745, 1840, 1866, 50, 70, "Text",ExpressionUUID->"b2337d32-6a12-4c75-a26e-d871940d7309"],
Cell[CellGroupData[{
Cell[72636, 1894, 995, 27, 139, "Input",ExpressionUUID->"1f6e3b6f-b878-4dd1-8939-30b57b091b3d"],
Cell[73634, 1923, 1706, 35, 55, "Output",ExpressionUUID->"db2a12b4-2555-4ef2-8de3-5f0bbf3f57aa"],
Cell[75343, 1960, 1963, 41, 55, "Output",ExpressionUUID->"7cadcad4-8615-4e31-9b0b-823b16a1a868"]
}, Open  ]],
Cell[77321, 2004, 2061, 59, 193, "Text",ExpressionUUID->"5d6601bc-890b-46fd-9ba4-7c40952a5ff0"],
Cell[CellGroupData[{
Cell[79407, 2067, 2298, 66, 178, "Input",ExpressionUUID->"54d69a67-7029-4474-bfaf-a79393ed32e2"],
Cell[81708, 2135, 2166, 46, 38, "Output",ExpressionUUID->"449eb925-2f60-487a-accd-d308a377ff91"],
Cell[83877, 2183, 2018, 40, 54, "Output",ExpressionUUID->"e7c50a00-2460-46c6-8d79-5976ff892d48"],
Cell[85898, 2225, 1487, 21, 36, "Output",ExpressionUUID->"98b6eacc-40e1-4aa5-9b89-2eef8e8cf79c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87434, 2252, 168, 3, 29, "Subsubsection",ExpressionUUID->"7f3e28f0-3598-4adb-8918-9661b54a1d84"],
Cell[87605, 2257, 2989, 91, 197, "Text",ExpressionUUID->"7c501d11-3e6d-4628-b4d1-40173e2bd85a"],
Cell[CellGroupData[{
Cell[90619, 2352, 696, 21, 91, "Input",ExpressionUUID->"2873ac7b-b804-4518-8dd3-cdf3ac8079cb"],
Cell[91318, 2375, 1442, 27, 36, "Output",ExpressionUUID->"cdb90680-2122-46aa-a76f-da05f183a262"],
Cell[92763, 2404, 1157, 18, 36, "Output",ExpressionUUID->"433a90eb-b933-4f29-9b1a-9499e1469f1c"]
}, Open  ]],
Cell[93935, 2425, 3881, 98, 416, "Text",ExpressionUUID->"686c335d-c494-4fc9-bda8-e99188393c32"],
Cell[CellGroupData[{
Cell[97841, 2527, 419, 11, 53, "Input",ExpressionUUID->"c5e8eafd-9767-43b5-9d47-adec388325c8"],
Cell[98263, 2540, 1198, 20, 50, "Output",ExpressionUUID->"9d19de6a-0672-4914-bee0-325afc91e540"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99522, 2567, 182, 3, 31, "Subsection",ExpressionUUID->"9264a52a-716e-4a80-85f2-4a29d39ef90d"],
Cell[99707, 2572, 444, 9, 52, "Text",ExpressionUUID->"9717f3ac-3d74-47d6-9ba7-af39f442a23c"],
Cell[CellGroupData[{
Cell[100176, 2585, 166, 3, 29, "Subsubsection",ExpressionUUID->"04289758-c634-4d4b-bf71-8b3563de3127"],
Cell[100345, 2590, 2167, 58, 56, "Input",ExpressionUUID->"9c0cb20f-7d9f-4cee-b277-f1962c525f37"],
Cell[102515, 2650, 1930, 51, 117, "Text",ExpressionUUID->"6105d851-6fe3-4501-910b-b76a9b891a18"],
Cell[CellGroupData[{
Cell[104470, 2705, 2547, 72, 152, "Input",ExpressionUUID->"434f2f11-e959-45c1-b7be-e9f30806a68e"],
Cell[107020, 2779, 1376, 22, 36, "Output",ExpressionUUID->"19ea3278-47dc-427c-b4d7-58b8719bd88e"],
Cell[108399, 2803, 1428, 24, 36, "Output",ExpressionUUID->"b82c2ae3-7914-4921-9e90-5f17ba4ca35e"],
Cell[109830, 2829, 1610, 29, 38, "Output",ExpressionUUID->"51d4a19b-8fa0-4650-9215-0f85757f9b9a"],
Cell[111443, 2860, 1314, 20, 36, "Output",ExpressionUUID->"ce6b3051-b8a4-4620-bd05-caacd14789e9"]
}, Open  ]],
Cell[112772, 2883, 1802, 51, 163, "Text",ExpressionUUID->"8e1e90fa-211a-4b03-8934-eb0dd19209dc"],
Cell[CellGroupData[{
Cell[114599, 2938, 1068, 33, 118, "Input",ExpressionUUID->"9da1fb99-9b47-4b85-9fad-827ad3edf5f8"],
Cell[115670, 2973, 1628, 34, 57, "Output",ExpressionUUID->"08d9de18-cd53-42bb-bf80-1cf21e933b77"],
Cell[117301, 3009, 1555, 30, 55, "Output",ExpressionUUID->"f1bd32c3-cefd-4caa-a392-d2fd499207ba"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118905, 3045, 184, 3, 29, "Subsubsection",ExpressionUUID->"7106f68b-bf17-4836-87cb-a72a63fb7df9"],
Cell[119092, 3050, 1708, 43, 117, "Text",ExpressionUUID->"b54f382e-6948-4e2c-8a8a-da3a8672593c"],
Cell[CellGroupData[{
Cell[120825, 3097, 2273, 64, 175, "Input",ExpressionUUID->"5e30a1bd-9ff3-4b41-a4a1-83c051df2e0c"],
Cell[123101, 3163, 2430, 63, 53, "Output",ExpressionUUID->"052bd708-9fda-43c2-bc14-878fd8e0ccb1"],
Cell[125534, 3228, 1767, 42, 36, "Output",ExpressionUUID->"6d81ac95-0ed6-47b0-b0cf-3d7d5801663b"],
Cell[127304, 3272, 1746, 42, 36, "Output",ExpressionUUID->"55ff6223-d9c8-442b-916c-31c18bcff4a0"]
}, Open  ]],
Cell[129065, 3317, 1546, 46, 54, "Text",ExpressionUUID->"8a5ca272-f12f-4250-b3cf-4600a6d2c504"],
Cell[CellGroupData[{
Cell[130636, 3367, 1428, 38, 156, "Input",ExpressionUUID->"5d55e6b7-f2d5-42b2-9542-e894e3b2b71f"],
Cell[132067, 3407, 2390, 58, 54, "Output",ExpressionUUID->"40d9a3b9-2a43-400a-8c50-635e5d48b42c"],
Cell[134460, 3467, 1291, 22, 26, "Message",ExpressionUUID->"9a4b7c7b-7405-418d-bf0e-9f74f602c328"],
Cell[135754, 3491, 1264, 23, 53, "Output",ExpressionUUID->"eec2072c-b4d0-4d4d-9914-cc49e7ff4aaa"],
Cell[137021, 3516, 2396, 60, 54, "Output",ExpressionUUID->"3cca5d3c-fe06-4866-a849-a0719c32829e"]
}, Open  ]],
Cell[139432, 3579, 255, 4, 30, "Text",ExpressionUUID->"cd82113d-094c-4f4f-a842-6b4a957957c1"],
Cell[139690, 3585, 777, 20, 52, "Input",ExpressionUUID->"46e02418-65a1-4405-898a-e719f60fcecb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140504, 3610, 241, 4, 29, "Subsubsection",ExpressionUUID->"f2755017-3190-481d-aa45-b4872dd0772e"],
Cell[140748, 3616, 3472, 107, 263, "Text",ExpressionUUID->"d8d8b9c7-f04d-4d03-a903-07973271ff6c"],
Cell[144223, 3725, 6294, 181, 348, "Text",ExpressionUUID->"fa5c246d-3628-4d59-8390-a554714346da"],
Cell[CellGroupData[{
Cell[150542, 3910, 2105, 60, 104, "Input",ExpressionUUID->"3059c2db-08ba-487d-9b39-f6f6379e55bf"],
Cell[152650, 3972, 2118, 43, 54, "Output",ExpressionUUID->"de87f8ff-f105-4c06-89fe-fb511087bf5d"],
Cell[154771, 4017, 2206, 45, 51, "Output",ExpressionUUID->"c01f5434-bb19-4fce-9a08-306e941b42da"],
Cell[156980, 4064, 2429, 50, 52, "Output",ExpressionUUID->"04e8563d-efe4-458f-8108-d64f5e7e98ec"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[159458, 4120, 208, 3, 29, "Subsubsection",ExpressionUUID->"a4f88e61-8359-45e5-a41e-87d1acb10aa5"],
Cell[CellGroupData[{
Cell[159691, 4127, 2564, 73, 165, "Input",ExpressionUUID->"56506afa-f659-4e1f-9ac2-48f11eae557e"],
Cell[162258, 4202, 2003, 41, 52, "Output",ExpressionUUID->"2d658c2d-50d2-4f9c-8ce9-f9266f4c6868"],
Cell[164264, 4245, 2685, 59, 54, "Output",ExpressionUUID->"17a90759-4966-4aea-b013-55b19e7f4325"],
Cell[166952, 4306, 1517, 26, 49, "Output",ExpressionUUID->"a07826ae-381c-4e34-b733-df889c7deb8b"]
}, Open  ]],
Cell[168484, 4335, 234, 4, 30, "Text",ExpressionUUID->"07613745-f280-4490-ad00-53cdad5741eb"],
Cell[CellGroupData[{
Cell[168743, 4343, 1414, 39, 141, "Input",ExpressionUUID->"8d00c582-1016-45f1-8b8b-845aaaf742b0"],
Cell[170160, 4384, 3094, 79, 79, "Output",ExpressionUUID->"70177d91-a0f9-4eee-a96a-f31d9d25afc5"],
Cell[173257, 4465, 7254, 190, 192, "Output",ExpressionUUID->"c04093f0-3abc-49ef-8b22-06edad8d4a86"],
Cell[180514, 4657, 2550, 61, 83, "Output",ExpressionUUID->"f0616d43-12eb-49eb-92b4-f4ac92f436da"],
Cell[183067, 4720, 2548, 61, 83, "Output",ExpressionUUID->"f692ef3e-d226-4911-8db9-4c77dc246c5b"]
}, Open  ]],
Cell[185630, 4784, 964, 24, 91, "Text",ExpressionUUID->"f80e0c04-f427-41a3-822c-5869d4ec17f1"],
Cell[CellGroupData[{
Cell[186619, 4812, 2054, 57, 144, "Input",ExpressionUUID->"193554d6-c6aa-4692-ab58-c49f8dc578b9"],
Cell[188676, 4871, 2172, 54, 54, "Output",ExpressionUUID->"fa371533-3cfb-44e6-ba78-7287ed2fa5ba"],
Cell[190851, 4927, 5700, 148, 116, "Output",ExpressionUUID->"78e689f1-2bc0-4a16-a75d-2d11a63e563a"]
}, Open  ]],
Cell[196566, 5078, 707, 15, 52, "Text",ExpressionUUID->"7297e812-ea47-4941-8bc6-5a9b32dbcbb3"],
Cell[CellGroupData[{
Cell[197298, 5097, 1238, 35, 127, "Input",ExpressionUUID->"09d2a5dc-f3b5-496d-b24e-a7e8b946cd58"],
Cell[198539, 5134, 1326, 21, 36, "Output",ExpressionUUID->"a520917b-c8e1-4a30-8e85-9bfc05528f7a"],
Cell[199868, 5157, 1322, 21, 36, "Output",ExpressionUUID->"5b9ceb63-c04b-4c7c-aa28-e4628e300201"]
}, Open  ]],
Cell[201205, 5181, 940, 17, 73, "Text",ExpressionUUID->"302646ce-8cd4-4d60-b76e-f6321e362e2a"],
Cell[CellGroupData[{
Cell[202170, 5202, 1232, 37, 88, "Input",ExpressionUUID->"af2c00f1-6feb-4406-a8d1-d27a707e241c"],
Cell[203405, 5241, 5352, 137, 118, "Output",ExpressionUUID->"7e7e25a4-a2ca-4914-a2b0-2bfa01e0fdc7"],
Cell[208760, 5380, 1877, 43, 53, "Output",ExpressionUUID->"1f84ca59-991e-4cfe-966b-757b43e734e5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[210686, 5429, 234, 4, 29, "Subsubsection",ExpressionUUID->"27db3e15-0556-454d-8f42-56f6b49e5f6a"],
Cell[210923, 5435, 5375, 140, 332, "Text",ExpressionUUID->"836dab57-3d13-4354-b8f6-c76ad8333972"],
Cell[CellGroupData[{
Cell[216323, 5579, 924, 26, 91, "Input",ExpressionUUID->"97db0e0c-d9bc-44fd-8736-d43a90d1d3d8"],
Cell[217250, 5607, 4080, 104, 126, "Output",ExpressionUUID->"613e3067-8ed9-4e24-b640-be97a080c68e"]
}, Open  ]],
Cell[221345, 5714, 2067, 54, 138, "Text",ExpressionUUID->"84f0ca4d-6aaf-4aad-a785-225fc72c8663"],
Cell[CellGroupData[{
Cell[223437, 5772, 1795, 53, 158, "Input",ExpressionUUID->"67e38814-e2b4-42c9-ae3b-985b4f0c9bf7"],
Cell[225235, 5827, 3765, 92, 121, "Output",ExpressionUUID->"01033ee4-b300-44c7-96cb-04424498effc"],
Cell[229003, 5921, 1620, 28, 49, "Output",ExpressionUUID->"c20e138b-6c0e-40c6-b489-f10f7e0e80a8"],
Cell[230626, 5951, 2020, 39, 54, "Output",ExpressionUUID->"afe0d4bf-2895-4304-bf7b-f826cab66376"],
Cell[232649, 5992, 1433, 21, 36, "Output",ExpressionUUID->"7afcf2a0-d8f7-4cef-a1f1-10550d79dc99"]
}, Open  ]],
Cell[234097, 6016, 739, 19, 52, "Text",ExpressionUUID->"dea1b268-c1df-4d34-b746-29102f820941"],
Cell[CellGroupData[{
Cell[234861, 6039, 391, 11, 36, "Input",ExpressionUUID->"5a31e0fd-b064-4e29-821b-72a45b2abf38"],
Cell[235255, 6052, 1205, 22, 36, "Output",ExpressionUUID->"2774dd8d-674b-44c4-96e5-c0c0017acdf5"]
}, Open  ]],
Cell[236475, 6077, 829, 21, 70, "Text",ExpressionUUID->"81ff8c69-628e-4dfd-93de-43e2f5cc5588"],
Cell[CellGroupData[{
Cell[237329, 6102, 1069, 29, 72, "Input",ExpressionUUID->"febd8d7f-8b77-43d6-893d-416dbd4f587a"],
Cell[238401, 6133, 1414, 28, 49, "Output",ExpressionUUID->"745a277a-e77d-40c2-9e11-dbf0cc4ed3c5"],
Cell[239818, 6163, 1060, 16, 36, "Output",ExpressionUUID->"aae2be97-e905-4e21-a29a-8d6f8d17612a"]
}, Open  ]],
Cell[240893, 6182, 2472, 66, 124, "Text",ExpressionUUID->"0d82b6d6-1fcc-4b66-b1b4-9849ecf1903c"],
Cell[CellGroupData[{
Cell[243390, 6252, 2125, 61, 124, "Input",ExpressionUUID->"eba26dec-ff38-4cd6-90e3-6d24d2b837ae"],
Cell[245518, 6315, 1956, 37, 54, "Output",ExpressionUUID->"d6aec8a8-5e28-4ead-a4a6-02e151a2c73e"],
Cell[247477, 6354, 2965, 68, 73, "Output",ExpressionUUID->"9840421e-daf2-4244-860f-68963d11c42b"],
Cell[250445, 6424, 2799, 63, 75, "Output",ExpressionUUID->"2349f6a0-e74d-4460-bc2d-7bab2f0a2468"]
}, Open  ]],
Cell[253259, 6490, 957, 22, 95, "Text",ExpressionUUID->"9cd6fcf6-e9c1-4d1d-bf52-8712702c7387"],
Cell[CellGroupData[{
Cell[254241, 6516, 2152, 62, 142, "Input",ExpressionUUID->"95bfac2a-1350-44b7-87a2-0e19383d2420"],
Cell[256396, 6580, 2098, 47, 52, "Output",ExpressionUUID->"e182fefd-6e5b-4091-abc6-3d9b32d8f661"],
Cell[258497, 6629, 1908, 41, 36, "Output",ExpressionUUID->"ccaadb2b-f471-4673-83f5-94035609ff43"],
Cell[260408, 6672, 1192, 17, 36, "Output",ExpressionUUID->"652264c0-bf77-4792-84c8-553590a9f8ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261637, 6694, 1750, 52, 173, "Input",ExpressionUUID->"d92a004f-b3b0-416f-9f81-7324716b8816"],
Cell[263390, 6748, 520, 11, 53, "Output",ExpressionUUID->"1904ed0f-b78d-4d5d-9b2c-aedf313a30d4"],
Cell[263913, 6761, 2078, 56, 103, "Output",ExpressionUUID->"a41e981e-bcd5-4cfb-b705-bde4bea1fe39"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266028, 6822, 2214, 59, 146, "Input",ExpressionUUID->"1ce463ac-3051-43c5-a064-baebd7528721"],
Cell[268245, 6883, 1855, 38, 36, "Output",ExpressionUUID->"947bd281-ba8b-42dc-ae38-fa9034e9e84d"],
Cell[270103, 6923, 2516, 58, 36, "Output",ExpressionUUID->"05e715e9-fd64-4254-b9a0-7cadead71472"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[272668, 6987, 163, 3, 29, "Subsubsection",ExpressionUUID->"ea96da5c-c94e-4c84-9815-2ed85b7e5755"],
Cell[272834, 6992, 323, 5, 30, "Text",ExpressionUUID->"74f39645-f6cc-4276-8295-10689213bacb"],
Cell[CellGroupData[{
Cell[273182, 7001, 1746, 50, 129, "Input",ExpressionUUID->"45f1f54c-21b3-4f43-8f91-d050526c493d"],
Cell[274931, 7053, 3682, 94, 126, "Output",ExpressionUUID->"1317b75e-d74b-432f-b6f5-a422e850151f"],
Cell[278616, 7149, 8157, 213, 151, "Output",ExpressionUUID->"3cfac9e2-ea35-446a-88e3-7fb0ec9c07bd"],
Cell[286776, 7364, 5589, 144, 137, "Output",ExpressionUUID->"a1e6f919-b7bb-4897-a322-d39a43f66dcb"]
}, Open  ]],
Cell[292380, 7511, 3452, 91, 273, "Text",ExpressionUUID->"0e739d68-7989-4b5a-8fde-cb4aeb3fc1a1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[295881, 7608, 204, 4, 62, "Section",ExpressionUUID->"88fdbf1a-a955-4925-a85f-71155dbc98ee"],
Cell[CellGroupData[{
Cell[296110, 7616, 830, 25, 70, "Input",ExpressionUUID->"3279a121-7e0c-4cc2-965f-a8c245811034"],
Cell[296943, 7643, 1338, 25, 49, "Output",ExpressionUUID->"60aa7406-48e9-48d9-9772-0ed65c951f0f"],
Cell[298284, 7670, 1233, 22, 49, "Output",ExpressionUUID->"fc84609d-b17e-4095-b67b-75fbebe94f2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[299554, 7697, 2694, 73, 156, "Input",ExpressionUUID->"caf59ef8-7b09-4365-abe0-57a23687b84f"],
Cell[302251, 7772, 1300, 25, 38, "Output",ExpressionUUID->"c8aa04e1-e3ad-4a38-8a07-246cbeb6a37d"],
Cell[303554, 7799, 4811, 126, 162, "Output",ExpressionUUID->"fc7e1c75-b5aa-4f0b-8c9d-857014916a0a"],
Cell[308368, 7927, 3463, 89, 121, "Output",ExpressionUUID->"3077f676-b4cd-4526-8e8e-a2488b97654b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311868, 8021, 389, 10, 71, "Input",ExpressionUUID->"3adbd5cd-611c-4238-a416-a9b68ec61f34"],
Cell[312260, 8033, 1357, 40, 64, "Output",ExpressionUUID->"63bfc4b8-7d42-488c-a89e-1411dc34b369"],
Cell[313620, 8075, 405, 9, 26, "Message",ExpressionUUID->"6def3195-d0f6-4a9d-b432-bd000397e055"],
Cell[314028, 8086, 5425, 136, 261, "Output",ExpressionUUID->"44e4752d-132d-49fa-b3ff-567407d58842"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319490, 8227, 1310, 39, 144, "Input",ExpressionUUID->"d73523ef-2707-4ea9-94dd-4359c6949296"],
Cell[320803, 8268, 784, 23, 54, "Output",ExpressionUUID->"e6dabe53-a41c-4c96-a1af-1925df39c039"],
Cell[321590, 8293, 738, 22, 58, "Output",ExpressionUUID->"ddbf639d-8dc5-4408-97e1-59996f69176b"],
Cell[322331, 8317, 343, 8, 49, "Output",ExpressionUUID->"c2315339-5bae-4e93-99f1-cca4cb43d7c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322711, 8330, 2393, 76, 114, "Input",ExpressionUUID->"f9c6e50e-c96d-4e6d-a866-2a5645101d0c"],
Cell[325107, 8408, 620, 16, 56, "Output",ExpressionUUID->"57749dbc-9321-4b82-b3a1-a83aa8a11bfc"],
Cell[325730, 8426, 631, 16, 55, "Output",ExpressionUUID->"502d8031-39b8-4e81-830a-2ca5fe28564a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326398, 8447, 2825, 81, 176, "Input",ExpressionUUID->"3ac09311-b3a4-4cd5-8e09-d782570f6717"],
Cell[329226, 8530, 1054, 25, 54, "Output",ExpressionUUID->"22c351d9-949e-4a7a-b090-4aa26004d89b"],
Cell[330283, 8557, 931, 22, 52, "Output",ExpressionUUID->"1d4bc2e5-b591-4bb8-8baa-e5acaffedfef"],
Cell[331217, 8581, 1027, 25, 52, "Output",ExpressionUUID->"9268751b-9d0f-48e3-9831-c2dc7394086a"],
Cell[332247, 8608, 526, 9, 36, "Output",ExpressionUUID->"e3a7b570-3f99-4934-840f-bc6d10448873"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332810, 8622, 2558, 76, 159, "Input",ExpressionUUID->"cfed2de2-1361-47d5-bc81-e0e761b56f04"],
Cell[335371, 8700, 700, 20, 55, "Output",ExpressionUUID->"fdf8e1b5-6044-4b4b-ac45-c559556b6568"],
Cell[336074, 8722, 231, 4, 36, "Output",ExpressionUUID->"cefff432-733d-4a24-bb20-c42cec3beb2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[336342, 8731, 171, 3, 29, "Subsubsection",ExpressionUUID->"c2edc714-2f0f-45b6-b0de-b4cb24e72b0e"],
Cell[CellGroupData[{
Cell[336538, 8738, 2376, 72, 123, "Input",ExpressionUUID->"62ca8d70-df03-41d2-a3de-7772eff2e155"],
Cell[338917, 8812, 204, 4, 36, "Output",ExpressionUUID->"f7a234af-57cf-45d5-b6e6-d6a09b539396"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

